<html>
<head>
  <title>6) Работа с файлами и потоками данных / XAML, разметка, расширения разметки</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/274061; Windows/6.3.9600;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="927"/>
<h1>6) Работа с файлами и потоками данных / XAML, разметка, расширения разметки</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><b>Работа с файлами и потоками данных</b><div>Классы Directory, File, DirectoryInfo и FileInfo предназначены для работы с каталогами и файлами. Первые два класса выполняют операции при помощи статических методов, вторые два – при помощи экземплярных методов. </div><div>var dir = new DirectoryInfo(@&quot;C:\Temp&quot;);</div><div>Класс DirectoryInfo обладает двумя наборами методов для получения до- черних подкаталогов, файлов или объектов FileSystemInfo. Методы вида GetЭлементы() выполняются немедленно и возвращают массив. FileInfo[] f = dir.GetFiles(&quot;*.txt&quot;, SearchOption.AllDirectories);//из всех подкаталогов Класс FileInfo описывает файл на диске и позволяет производить операции с этим файлом. Как правило, код, работающий с данными файла, вначале вызывает метод Open(). Параметр FileMode определяет режим запроса на открытие файла. Для него используются значения из перечисления </div><div>Append – открывает файл, если он существует, и ищет конец файла. Если файл не существует, то он создаётся. </div><div>Create – указывает на создание нового файла. Если файл существует, он будет перезаписан;</div><div>CreateNew – указывает на создание нового файла. Если файл существует,<br/>
генерирует исключение IOException; </div><div>Open – операционная система должна открыть существующий файл; </div><div>OpenOrCreate – операционная система должна открыть существующий файл или создать новый, если файл не существует;<br/>
Второй параметр метода Open() – FileAccess -доступ к файлу.<br/>
Read – файл будет открыт только для чтения;<br/>
ReadWrite – файл будет открыт и для чтения, и для записи;<br/>
Write – файл открывается только для записи, то есть добавления данных.<br/>
Поток данных – это абстрактное представление данных в виде последовательности байтов. Поток либо ассоциируется с неким физическим хранилищем (файлами на диске, памятью, сетью), либо декорирует (обрамляет) другой поток, преобразуя данные тем или иным образом.<br/>
Адаптеры потоков служат оболочкой потока, преобразуя информацию определённого формата в набор байтов (сами адаптеры потоками не являются).<br/>
1. Абстрактный класс System.IO.Stream. Это базовый класс для других классов, представляющих потоки.<br/>
2. Классы для работы с потоками, связанными с хранилищами. FileStream – класс для работы с файлами, как с потоками (пространство имён System.IO).<br/>
3. Декораторы потоков. DeflateStream и GZipStream – классы для потоков со сжатием данных (пространство имён System.IO.Compression).<br/>
4. Адаптеры потоков. BinaryReader и BinaryWriter – классы для ввода и вывода примитивных типов в двоичном формате. StreamReader и StreamWriter – классы для ввода и вывода информации в строковом представлении. XmlReader и XmlWriter – абстрактные классы для ввода/вывода XML.</div><div><hr/><b>XAML, разметка, расширения разметки</b></div><div>Расширяемый язык разметки приложений (eXtensible Application Markup Language, XAML) – это язык для представления дерева объектов .NET, основанный на XML. Данные XAML превращаются в дерево объектов при помощи анализатора XAML (XAML parser). Основное назначение XAML – описание пользовательских интерфейсов в приложениях WPF и Silverlight.</div><div>Рассмотрим основные правила XAML. Документ XAML записан в формате XML. Это означает, что имена элементов XAML чувствительны к регистру, нужна правильная вложенность элементов, а некоторые символы требуют особого обозначения. Объектные элементы XAML описывают объект некоторого типа платформы .NET и задают значения открытых свойств и полей объекта. Имя элемента указывает на тип объекта.<br/>
&lt;Button Width=&quot;100&quot;&gt;&lt;!-- определение объекта в XAML --&gt;<br/>
I am a Button<br/>
&lt;/Button&gt;<br/>
Для установки значений свойств объекта в XAML можно использовать атрибуты XML, элементы свойств и содержимое элемента. При использовании атрибутов указывается имя свойства и значение свойства в виде строки:<br/>
&lt;Button Background=&quot;Red&quot; /&gt;&lt;!-- задаём у кнопки красный фон --&gt;<br/>
Элемент свойства вложен в объектный элемент и имеет вид &lt;имя-типа.имя-свойства&gt;. Содержимое элемента свойства рассматривается как значение свойства (при необходимости применяются конвертеры). Обычно элементы свойств используются для значений, являющихся объектами.<br/>
&lt;Button&gt;<br/>
&lt;Button.Width&gt;100&lt;/Button.Width&gt;<br/>
&lt;Button.Background&gt;Red&lt;/Button.Background&gt;<br/>
&lt;/Button&gt;<br/>
Если тип реализует интерфейсы IList или IDictionary, при описании объекта этого типа в XAML дочерние элементы автоматически добавляются в соответствующую коллекцию. Например, свойство Items класса ListBox имеет тип ItemCollection, а этот класс реализует интерфейс IList<br/>
&lt;ListBox&gt;<br/>
&lt;ListBoxItem Content=&quot;Item 1&quot; /&gt;<br/>
&lt;ListBoxItem Content=&quot;Item 2&quot; /&gt;<br/>
&lt;/ListBox&gt;<br/>
Расширение разметки (markup extension) — специализированный синтаксис, устанавливающий свойство нестандартным образом.<br/>
Подмножество ключевых слов XAML (таких как х:Array, x:Null, x:Static, х:Type) — это именно расширения разметки.<br/>
&lt;Элемент УстанавливаемоеСвойство = &quot;{РасширениеРазметки}&quot;/&gt;<br/>
&lt;StackPanel&gt;<br/>
&lt;Button Content=&quot;{local:ShowTime}&quot; /&gt;<br/>
&lt;Button Content=&quot;{local:ShowTime Header=Time}&quot; /&gt;<br/>
&lt;/StackPanel&gt;</div><div><br/></div><div>Рассмотрим некоторые директивы анализатора XAML, применяемые в WPF. Анализатор генерирует код, выполняющий по документу XAML создание и настройку объектов. Действия с объектами (в частности, обработчики событий) обычно описываются в отдельном классе. Чтобы связать этот класс с документом XAML используется директива-атрибут x:Class. Этот атрибут применяется только к корневому элементу и содержит имя класса, являющегося наследником класса корневого элемента:<br/>
&lt;!-- у корневого элемента Window задан атрибут x:Class --&gt;<br/>
&lt;Window x:Class=&quot;WpfApplication.MainWindow&quot;<br/>
Чтобы сослаться на объект в коде, этот объект должен иметь имя. Для указания имени объекта используется директива-атрибут x:Name:<br/>
&lt;Button x:Name=&quot;btn&quot; Content=&quot;Click me!&quot; /&gt;<br/>
Существует возможность встроить фрагмент кода в XAML-файл. Для этого используется директива-элемент x:Code. Такой элемент должен быть непосредственно вложен в корневой элемент, у которого имеется атрибут<br/>
x:Class.<br/>
Директива-атрибут x:Key применяется при описании дочерних элементов объекта-словаря, и позволяет указать ключ словаря для элемента:<br/>
&lt;Window.Resources&gt;<br/>
&lt;SolidColorBrush x:Key=&quot;borderBrush&quot; Color=&quot;Red&quot; /&gt;<br/>
&lt;SolidColorBrush x:Key=&quot;textBrush&quot; Color=&quot;Black&quot; /&gt;<br/>
&lt;/Window.Resources&gt;</div></div>
</div></body></html> 