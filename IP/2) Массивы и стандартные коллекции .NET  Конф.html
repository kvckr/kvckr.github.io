<html>
<head>
  <title>2) Массивы и стандартные коллекции .NET / Конфигурация .NET приложений</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/274061; Windows/6.3.9600;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="919"/>
<h1>2) Массивы и стандартные коллекции .NET / Конфигурация .NET приложений</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>Массивы и класс System.Array</b></span></font></div></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">System.</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">Array</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">является базовым классом для любого массива. Любой массив реализует интерфейсы</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">IStructuralEquatable</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">,</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">IStructuralComparable</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">,</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">IList</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">IList</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">, причём первые три интерфейса реализованы явно (методы</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">Add()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">Remove()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">генерируют исключение в случае коллекции фиксированной длины, которой является массив).</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><p align="center" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:0.00mm; margin-bottom:2.11mm;"></p><hr style="text-indent: 10mm;"/><div style="font-size: 19px;"><font color="#010101" face="Times New Roman"><b>Типы для работы с коллекциями-списками</b></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">List</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">из пространства имён</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">System.Collections.Generic</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– основной класс для представления наборов, которые допускают динамическое добавление элементов. </span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">Для хранения данных набора используется внутренний массив. Класс</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">List</span></font><font color="#010101" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">реализует интерфейсы</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">IList</span></font><font color="#010101" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&lt;T&gt;</span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">,</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">IList</span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">,</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">IReadOnlyList</span></font><font color="#010101" style="text-indent: 10mm;"><span style="font-family: Consolas; font-size: 12pt;">&lt;T&gt;</span><font face="Times New Roman"><span style="font-size: 19px;">.</span></font></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">List</span></font><font color="#010101" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">имеет три конструктора. Первый из них – обычный конструктор без параметров. Второй конструктор позволяет создать набор на основе коллекции – производится копирование элементов коллекции в список. Третий конструктор принимает в качестве аргумента начальную ёмкость набора.</span> <span style="font-size:14pt"><i>Ёмкость набора</i></span> <span style="font-size:14pt">(capacity) – это количество элементов набора, которое он способен содержать без увеличения размера внутреннего массива.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">На примере</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">List</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">рассмотрим особенность, присущую использованию коллекций в языке C#. Если коллекция хранит структуры, то C# не позволяет изменить части структуры при помощи индексатора коллекции (так как индексатор является функцией, возвращающей</span> <span style="font-size:14pt"><i>копию</i></span> <span style="font-size:14pt">элемента коллекции).</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">LinkedList</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">служит для представления двусвязного списка. Такой список позволяет осуществлять вставку и удаление элемента без сдвига остальных элементов. Однако доступ к элементу по индексу требует прохода по списку.</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">LinkedList</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">реализует интерфейсы</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ICollection</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ICollection</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">. Каждый элемент двусвязного списка представлен объектом</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">LinkedListNode</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">При добавлении элемента можно указать, чтобы он помещался в начало списка, или в конец списка, или относительно существующего в списке элемента. (addfirst,addlast,addafter)</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">LinkedList</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">содержит свойства для числа элементов, для указания на первый и последний элемент. Имеются методы для поиска элементов.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Классы</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">Queue</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">Stack</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">реализуют структуры данных «очередь» и «стек» на основе массива</span><span style="font-size:14pt">. Конструкторы этих классов, как и конструкторы класса</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">List</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">, позволяют создать объект на основе другой коллекции, а также указать значение для ёмкости (но ёмкость не доступна в виде отдельного свойства).</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><hr/><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><b><span style="font-size:14pt">Типы для работы с коллекциями-множествами</span></b></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">В библиотеке базовых классов платформы .NET имеются два класса для представления множеств (то есть коллекций, которые не содержат повторяющихся элементов) –</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HashSet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedSet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">. Оба класса реализуют интерфейс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ISet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HashSet</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">описывает множество, в котором вхождение элемента проверяется на основе хэш-кода. Конструкторы класса</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HashSet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">позволяют создать множество на основе коллекции, а также указать объект, реализующий интерфейс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">IEqualityComparer</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">для проверки равенства элементов множества. Кроме реализации интерфейса</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ISet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">, класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HashSet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">содержит экземплярный метод</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">RemoveWhere()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">для удаления элементов, удовлетворяющих заданному предикату. Статический метод</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">CreateSetComparer()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">возвращает экземпляр класса, реализующего</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">IEqualityComparer</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HashSet</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedSet</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– это множество, поддерживающее набор элементов в отсортированном порядке.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Набор методов</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedSet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">схож с набором методов класса</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HashSet</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;T&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">. Экземплярный метод</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">Reverse()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">возвращает набор элементов в противоположном порядке, а метод</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">GetViewBetween()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">возвращает фрагмент («окно») исходного множества между двумя элементами.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><hr/><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><b><span style="font-size:14pt">Типы для работы с коллекциями-словарями</span></b></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Под термином</span> <span style="font-size:14pt"><i>словарь</i></span> <span style="font-size:14pt">будем понимать коллекцию, которая хранит пары «ключ-значение» с возможностью доступа к элементам по ключу.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Универсальный класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">Dictionary</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– классический словарь с возможностью указать тип для ключа и тип для значения. </span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">Dictionary</span></font><font color="#010101" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font> <font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">реализует обе версии интерфейса</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">IDictionary</span></font> <font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">(обычную и универсальную).</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">OrderedDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– слаботипизированный класс, запоминающий порядок добавления элементов в словарь. В некотором смысле, данный класс является комбинацией классов</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">Hashtable</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ArrayList</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">. Для доступа к элементам в</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">OrderedDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">можно применять как ключ, так и целочисленный индекс.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ListDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">использует для хранения элементов словаря не хэш-таблицу, а односвязный список. Это делает данный класс неэффективным при работе с большими наборами данных.</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ListDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">рекомендуется использовать, если количество хранимых элементов не превышает десяти. Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HybridDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– это форма словаря, использующая список для хранения при малом количестве элементов, и переключающаяся на применение хэш-функции, когда количество элементов превышает определённый порог. Оба класса</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">ListDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">HybridDictionary</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">являются слаботипизированными и находятся в пространстве имён</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">System.Collections.Specialized</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Платформа .NET предоставляет три класса-словаря, организованных так, что их элементы всегда отсортированы по ключу:</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedDictionary</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">,</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedList</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedList</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">. Данные классы используют разные внутренние структуры для хранения элементов словаря. Класс</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedDictionary</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">быстрее классов</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedList</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedList</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">при выполнении вставки элементов. Но классы</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedList</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedList</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">могут предоставить возможность, которой нет у</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">SortedDictionary</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">&lt;TKey, TValue&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– доступ к элементу не только по ключу, но и с использованием целочисленного индекса.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><hr/><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><b><span style="font-size:14pt">Файлы конфигурации</span></b></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Конфигурирование применяется для решения двух основных задач. Во-первых, параметры конфигурации позволяют настроить поведение CLR при выполнении кода приложения. Во-вторых, конфигурация может хранить пользовательские данные приложения.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Платформа .NET предлагает унифицированный подход к конфигурированию, основанный на использовании</span> <span style="font-size:14pt"><i>конфигурационных XML-файлов</i></span> <span style="font-size:14pt">.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Платформа .NET предлагает унифицированный подход к конфигурированию, основанный на использовании</span> <span style="font-size:14pt"><i>конфигурационных XML-файлов</i></span> <span style="font-size:14pt">. Существует один глобальный файл конфигурации с параметрами, относящимися к платформе в целом. Этот файл называется</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">machine.config</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и располагается в каталоге установки платформы .NET. Любая сборка может иметь локальный конфигурационный файл. Он должен носить имя файла сборки с добавлением расширения</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">.config</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">и располагаться в одном каталоге со сборкой (то есть файл конфигурации для</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">main.exe</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">должен называться</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">main.exe.config</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><sup>1</sup></span><span style="font-size:14pt">). Параметры, описанные в локальных конфигурационных файлах, «накладываются» на параметры из файла</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">machine.config</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Проанализируем общую схему любого файла конфигурации. Корневым XML-элементом файла является элемент</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">configuration</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">. Он может включать следующие дочерние элементы:</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">configSections</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– описывает разделы конфигурации (в том числе пользовательские);</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">appSettings</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– пользовательские параметры конфигурации;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">connectionStrings</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– строки подключения к источникам данных;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">startup</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– параметры запуска CLR (поддерживаемые версии);</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">runtime</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– параметры времени выполнения (регулируют способ загрузки сборок и работу сборщика мусора);</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">system.diagnostics</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– совокупность диагностических параметров, которые задают способ отладки, перенаправляют сообщения отладки и т. д.;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">system.net</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– настройка параметров работы с сетью;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">system.serviceModel</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– настройка элементов технологии WCF;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">system.web</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– параметры конфигурации приложений ASP.NET.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">Рассмотрим способы описания в файле конфигурации пользовательских данных. В простейшем случае для этого используется раздел</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">appSettings</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">, который может содержать следующие элементы:</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">add</span></font> <font color="#FF0000" face="Consolas"><span style="font-size:12pt">key</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">=&quot;name&quot;</span></font> <font color="#FF0000" face="Consolas"><span style="font-size:12pt">value</span></font><font color="#0000FF" face="Consolas"><span style="font-size:12pt">=&quot;the value&quot;/&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– добавляет новый ключ и значение в коллекцию пользовательских конфигурационных данных;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas"><span style="font-size:12pt">remove</span></font> <font color="#FF0000" face="Consolas"><span style="font-size:12pt">key</span></font> <font color="#0000FF" face="Consolas"><span style="font-size:12pt">=&quot;name&quot;/&gt;</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– удаляет существующий ключ и значение из коллекции конфигурационных данных;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#0000FF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">clear</span></font><font color="#0000FF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">/&gt;</span></font> <font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">– очищает коллекцию конфигурационных данных.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">Разработчик может создать собственный раздел конфигурационного файла. Такой раздел должен быть зарегистрирован в секции</span></font> <font color="#0000FF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&lt;</span></font><font color="#A31515" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">configSections</span></font><font color="#0000FF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">&gt;</span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">. При регистрации раздела задаётся его</span> <span style="font-size:14pt"><i>обработчик</i></span> <span style="font-size:14pt">– класс, который будет отвечать за превращение содержимого раздела в данные. В зависимости от типа хранимых данных можно воспользоваться одним из существующих обработчиков либо построить собственный обработчик.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><span style="font-size: 12pt; color: rgb(1, 1, 1); font-family: &apos;Times New Roman&apos;; text-indent: 10mm;"> </span><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">Для программного доступа к конфигурационным данным текущего приложения используется статический класс</span></font> <font color="#2B91AF" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">ConfigurationManager</span></font> <font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">из пространства имён</span></font> <font color="#010101" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">System.Configuration</span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt"><sup>1</sup></span> <span style="font-size:14pt">(сборка</span></font> <font color="#010101" face="Consolas" style="text-indent: 10mm;"><span style="font-size:12pt">System.Configuration.dll</span></font><font color="#010101" face="Times New Roman" size="4" style="text-indent: 10mm;"><span style="font-size:14pt">). Класс имеет следующие элементы:</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">1.</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">AppSettings</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– коллекция-словарь пользовательских параметров;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">2.</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">ConnectionStrings</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– словарь строк подключения к источникам данных;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">3.</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">GetSection()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– извлекает указанный раздел конфигурации;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">4.</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">OpenExeConfiguration()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– открывает файл конфигурации указанной сборки в виде объекта</span></font> <font color="#2B91AF" face="Consolas"><span style="font-size:12pt">Configuration</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">5.</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">OpenMachineConfiguration()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– открывает файл</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">machine.config</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">;</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">6.</span></font> <font color="#010101" face="Consolas"><span style="font-size:12pt">RefreshSection()</span></font> <font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">– перечитывает указанный раздел конфигурации.</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:10mm; margin-top:0.00mm; margin-bottom:0.00mm;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">При работе в Visual Studio можно создать так называемые</span> <span style="font-size:14pt"><i>пользовательские настройки</i></span> <span style="font-size:14pt">. Для этого используется окно свойств проекта (</span></font><font color="#010101" face="Consolas"><span style="font-size:12pt">Project | Properties | Settings</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt">). Для каждого параметра указывается имя, тип и область видимости – глобальная или локальная (для конкретного пользователя).</span></font></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div></body></html> 