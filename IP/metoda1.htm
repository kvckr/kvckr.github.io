<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="metoda1.files/filelist.xml">
<link rel=Edit-Time-Data href="metoda1.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Пользователь Windows</o:Author>
  <o:Template>Шаблон лекций</o:Template>
  <o:LastAuthor>Олег</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>77</o:TotalTime>
  <o:LastPrinted>2013-10-11T19:35:00Z</o:LastPrinted>
  <o:Created>2015-01-08T18:43:00Z</o:Created>
  <o:LastSaved>2015-01-08T18:43:00Z</o:LastSaved>
  <o:Pages>153</o:Pages>
  <o:Words>40721</o:Words>
  <o:Characters>232114</o:Characters>
  <o:Lines>1934</o:Lines>
  <o:Paragraphs>544</o:Paragraphs>
  <o:CharactersWithSpaces>272291</o:CharactersWithSpaces>
  <o:Version>15.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:RelyOnVML/>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=dataStoreItem href="metoda1.files/item0001.xml"
target="metoda1.files/props002.xml">
<link rel=themeData href="metoda1.files/themedata.thmx">
<link rel=colorSchemeMapping href="metoda1.files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="RU" VendorID="64" DLLVersion="131078" NLCheck="1">0</w:ActiveWritingStyle>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131078"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:AutoHyphenation/>
  <w:HyphenationZone>17</w:HyphenationZone>
  <w:PunctuationKerning/>
  <w:DrawingGridHorizontalSpacing>7 пт</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>19,05 пт</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>RU</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="371">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="59" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 5 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-alt:\BC14\D0D5;
	mso-font-charset:129;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;
	mso-font-alt:\65B0\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;
	mso-font-alt:"\FF2D\FF33 \30B4\30B7\30C3\30AF";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\B3CB\C6C0;
	mso-font-charset:129;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\9ED1\4F53;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;
	mso-font-alt:\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;
	mso-font-alt:\660E\671D;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\AD74\B9BC;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 3 5 7 5 2 3 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:8192 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:262144 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:12583555 0 0 0 13 0;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1107305727 0 0 415 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073750139 0 0 415 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073786111 1 0 415 0;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073743103 0 0 415 0;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-520092929 1073806591 9 0 415 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520081665 -1073717157 41 0 66047 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Заголовок 1 Знак";
	mso-style-next:Обычный;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	mso-font-kerning:0pt;}
h2
	{mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-parent:"Заголовок 1";
	mso-style-link:"Заголовок 2 Знак";
	mso-style-next:Обычный;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:black;
	mso-themecolor:text1;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-priority:39;
	mso-style-next:Обычный;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	tab-stops:right dotted 481.4pt;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-priority:99;
	mso-style-link:"Текст сноски Знак";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-priority:99;
	mso-style-link:"Верхний колонтитул Знак";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	tab-stops:center 233.85pt right 467.75pt;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-priority:99;
	mso-style-link:"Нижний колонтитул Знак";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
span.MsoFootnoteReference
	{mso-style-noshow:yes;
	mso-style-priority:99;
	vertical-align:super;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	mso-themecolor:hyperlink;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:purple;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
code
	{mso-style-noshow:yes;
	mso-style-priority:99;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
tt
	{mso-style-noshow:yes;
	mso-style-priority:99;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Текст выноски Знак";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;}
span.MsoPlaceholderText
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	color:gray;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{mso-style-noshow:yes;
	mso-style-priority:39;
	mso-style-qformat:yes;
	mso-style-parent:"Заголовок 1";
	mso-style-next:Обычный;
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria",serif;
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#365F91;
	mso-themecolor:accent1;
	mso-themeshade:191;
	text-transform:uppercase;
	mso-bidi-font-weight:bold;}
span.1
	{mso-style-name:"Заголовок 1 Знак";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Заголовок 1";
	mso-ansi-font-size:16.0pt;
	font-family:"Arial",sans-serif;
	mso-ascii-font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
p.a, li.a, div.a
	{mso-style-name:Листинг;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Листинг Знак";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Consolas;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-ansi-language:EN-US;
	mso-no-proof:yes;}
p.aCxSpFirst, li.aCxSpFirst, div.aCxSpFirst
	{mso-style-name:ЛистингCxSpFirst;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Листинг Знак";
	mso-style-type:export-only;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Consolas;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-ansi-language:EN-US;
	mso-no-proof:yes;}
p.aCxSpMiddle, li.aCxSpMiddle, div.aCxSpMiddle
	{mso-style-name:ЛистингCxSpMiddle;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Листинг Знак";
	mso-style-type:export-only;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Consolas;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-ansi-language:EN-US;
	mso-no-proof:yes;}
p.aCxSpLast, li.aCxSpLast, div.aCxSpLast
	{mso-style-name:ЛистингCxSpLast;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Листинг Знак";
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Consolas;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-ansi-language:EN-US;
	mso-no-proof:yes;}
span.a0
	{mso-style-name:"Текст выноски Знак";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Текст выноски";
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:"Tahoma",sans-serif;
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
span.a1
	{mso-style-name:"Листинг Знак";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Листинг;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	mso-ansi-language:EN-US;
	mso-no-proof:yes;}
span.a2
	{mso-style-name:Акцент;
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.a3
	{mso-style-name:Код;
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	mso-ansi-language:RU;
	mso-no-proof:yes;}
span.a4
	{mso-style-name:"Нижний колонтитул Знак";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Нижний колонтитул";
	mso-ansi-font-size:12.0pt;}
span.a5
	{mso-style-name:"Текст сноски Знак";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Текст сноски";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:10.0pt;}
p.a6, li.a6, div.a6
	{mso-style-name:Рисунок;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
span.2
	{mso-style-name:"Заголовок 2 Знак";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Заголовок 2";
	mso-bidi-font-size:13.0pt;
	font-family:"Arial",sans-serif;
	mso-ascii-font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:black;
	mso-themecolor:text1;
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.a7, li.a7, div.a7
	{mso-style-name:Содержание;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"Заголовок 1";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:16.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
p.a8, li.a8, div.a8
	{mso-style-name:"Название конспекта";
	mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:22.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	text-transform:uppercase;}
p.a9, li.a9, div.a9
	{mso-style-name:Автор;
	mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
span.aa
	{mso-style-name:Комментарий;
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:green;
	mso-ansi-language:RU;
	mso-no-proof:no;}
span.ab
	{mso-style-name:Класс;
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:#2B91AF;
	mso-ansi-language:EN-US;
	mso-no-proof:yes;}
span.ac
	{mso-style-name:Ключевое;
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:blue;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
span.ad
	{mso-style-name:"Строковый литерал";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:#A31515;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
p.ae, li.ae, div.ae
	{mso-style-name:Таблица;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:right;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.af, li.af, div.af
	{mso-style-name:"Заголовок таблицы";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
span.af0
	{mso-style-name:"Комментарий для документации";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:gray;
	mso-ansi-language:RU;
	mso-no-proof:no;}
span.af1
	{mso-style-name:"Ключевое\(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Ключевое;
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:blue;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
span.af2
	{mso-style-name:"Класс\(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Класс;
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:#2B91AF;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
span.af3
	{mso-style-name:"Код\(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	mso-ansi-language:RU;
	mso-no-proof:yes;}
span.af4
	{mso-style-name:"Код италик";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	mso-ansi-language:RU;
	font-style:italic;
	mso-bidi-font-style:normal;
	mso-no-proof:no;}
p.af5, li.af5, div.af5
	{mso-style-name:"Жирный акцент";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Жирный акцент Знак";
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
span.af6
	{mso-style-name:"Жирный акцент Знак";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Жирный акцент";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
span.af7
	{mso-style-name:"Код италик \(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"Код италик";
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	mso-ansi-language:RU;
	font-style:italic;
	mso-bidi-font-style:normal;
	mso-no-proof:no;}
span.af8
	{mso-style-name:"Комментарий для документации \(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"Комментарий для документации";
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:gray;
	mso-ansi-language:RU;
	mso-no-proof:no;}
span.af9
	{mso-style-name:"Комментарий \(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Комментарий;
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:green;
	mso-ansi-language:RU;
	mso-no-proof:no;}
p.afa, li.afa, div.afa
	{mso-style-name:"Имена столбцов";
	mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.afb, li.afb, div.afb
	{mso-style-name:"Текст в таблице";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";}
span.afc
	{mso-style-name:"Строковый литерал \(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"Строковый литерал";
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:#A31515;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
span.XML
	{mso-style-name:"Атрибут XML";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:Код;
	mso-ansi-font-size:12.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:red;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
span.XML0
	{mso-style-name:"Атрибут XML \(т\)";
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"Атрибут XML";
	mso-ansi-font-size:11.0pt;
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	color:red;
	mso-ansi-language:EN-US;
	mso-no-proof:no;}
span.afd
	{mso-style-name:"Верхний колонтитул Знак";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Верхний колонтитул";}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;
	color:teal;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:14.0pt;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
.MsoPapDefault
	{mso-style-type:export-only;
	text-align:justify;
	text-indent:1.0cm;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("metoda1.files/header.htm") fs;
	mso-footnote-continuation-separator:url("metoda1.files/header.htm") fcs;
	mso-endnote-separator:url("metoda1.files/header.htm") es;
	mso-endnote-continuation-separator:url("metoda1.files/header.htm") ecs;
	mso-facing-pages:yes;
	mso-footnote-numbering-restart:each-page;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:2.0cm 2.0cm 76.55pt 2.0cm;
	mso-header-margin:1.0cm;
	mso-footer-margin:48.2pt;
	mso-title-page:yes;
	mso-even-footer:url("metoda1.files/header.htm") ef1;
	mso-footer:url("metoda1.files/header.htm") f1;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;
	mso-footnote-numbering-restart:each-page;}
 /* List Definitions */
 @list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:337820452;}
@list l0:level1
	{mso-level-tab-stop:74.6pt;
	mso-level-number-position:left;
	margin-left:74.6pt;
	text-indent:-18.0pt;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:-1959765614;}
@list l1:level1
	{mso-level-tab-stop:60.45pt;
	mso-level-number-position:left;
	margin-left:60.45pt;
	text-indent:-18.0pt;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:531248534;}
@list l2:level1
	{mso-level-tab-stop:46.3pt;
	mso-level-number-position:left;
	margin-left:46.3pt;
	text-indent:-18.0pt;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:-1102788012;}
@list l3:level1
	{mso-level-tab-stop:32.15pt;
	mso-level-number-position:left;
	margin-left:32.15pt;
	text-indent:-18.0pt;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:995003836;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:74.6pt;
	mso-level-number-position:left;
	margin-left:74.6pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:-1957537380;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:60.45pt;
	mso-level-number-position:left;
	margin-left:60.45pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:2075404034;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:46.3pt;
	mso-level-number-position:left;
	margin-left:46.3pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:-1823326138;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:32.15pt;
	mso-level-number-position:left;
	margin-left:32.15pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-1395879604;}
@list l8:level1
	{mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:1316007050;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l10
	{mso-list-id:1171330386;
	mso-list-type:hybrid;
	mso-list-template-ids:-93924086 -1257490404 68747267 68747269 68747265 68747267 68747269 68747265 68747267 68747269;}
@list l10:level1
	{mso-level-start-at:19;
	mso-level-number-format:bullet;
	mso-level-text:–;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:46.35pt;
	text-indent:-18.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;}
@list l10:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:82.35pt;
	text-indent:-18.0pt;
	font-family:"Courier New";}
@list l10:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:118.35pt;
	text-indent:-18.0pt;
	font-family:Wingdings;}
@list l10:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:154.35pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l10:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:190.35pt;
	text-indent:-18.0pt;
	font-family:"Courier New";}
@list l10:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:226.35pt;
	text-indent:-18.0pt;
	font-family:Wingdings;}
@list l10:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:262.35pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l10:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:298.35pt;
	text-indent:-18.0pt;
	font-family:"Courier New";}
@list l10:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:334.35pt;
	text-indent:-18.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Обычная таблица";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
table.MsoTableGrid
	{mso-style-name:"Сетка таблицы";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-priority:59;
	mso-style-unhide:no;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	text-align:justify;
	text-indent:1.0cm;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
table.afe
	{mso-style-name:"Основная таблица";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-priority:99;
	mso-style-unhide:no;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-tstyle-vert-align:middle;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
table.afeFirstRow
	{mso-style-name:"Основная таблица";
	mso-table-condition:first-row;
	mso-style-priority:99;
	mso-style-unhide:no;
	text-align:center;
	word-break:normal;
	mso-ansi-font-weight:bold;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=RU link=blue vlink=purple style='tab-interval:1.0cm'>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'>Министерство
образования Республики Беларусь</p>

<p class=MsoNormal align=center style='text-align:center'>Учреждение
образования</p>

<p class=MsoNormal align=center style='text-align:center'>«Белорусский
государственный университет</p>

<p class=MsoNormal align=center style='text-align:center'>информатики и
радиоэлектроники»</p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'>Кафедра информатики</p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=a9>А.А. Волосевич</p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=a8>Базовые технологии платформы .<span lang=EN-US style='mso-ansi-language:
EN-US'>NET</span></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'>Курс лекций</p>

<p class=MsoNormal align=center style='text-align:center'>для студентов специальности</p>

<p class=MsoNormal align=center style='text-align:center'>1-40 01 03
Информатика и технологии программирования</p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=center style='text-align:center'>Минск 201<span
lang=EN-US style='mso-ansi-language:EN-US'>3</span><br clear=all
style='mso-special-character:line-break;page-break-before:always'>
</p>

<p class=a7>Содержание</p>

<p class=MsoToc1><!--[if supportFields]><span style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'> </span>TOC \o &quot;1-1&quot; \h \z \u <span
style='mso-element:field-separator'></span><![endif]--><a href="#_Toc348862488"><span
style='mso-no-proof:yes'>1. Работа с числами</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862488 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>4<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400380038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862489"><span style='mso-no-proof:yes'>2.
Представление даты и времени</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862489 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>6<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400380039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862490"><span style='mso-no-proof:yes'>3.
Работа со строками и текстом</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862490 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862491"><span style='mso-no-proof:yes'>4.
Преобразование информации</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862491 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862492"><span style='mso-no-proof:yes'>5.
Сравнение для выяснения равенства</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862492 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>16<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862493"><span style='mso-no-proof:yes'>6.
Сравнение для выяснения порядка</span><span style='color:windowtext;display:
none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862493 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>19<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862494"><span style='mso-no-proof:yes'>7.
Жизненный цикл объектов</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862494 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>21<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862495"><span style='mso-no-proof:yes'>8.
Перечислители и итераторы</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862495 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>26<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862496"><span style='mso-no-proof:yes'>9.
Стандартные интерфейсы коллекций</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862496 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>33<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862497"><span style='mso-no-proof:yes'>10.
Массивы и класс </span><span lang=EN-US style='mso-ansi-language:EN-US;
mso-no-proof:yes'>System</span><span style='mso-no-proof:yes'>.</span><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'>Array</span><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862497 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>37<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862498"><span style='mso-no-proof:yes'>11.
Типы для работы с коллекциями-списками</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862498 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>40<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862499"><span style='mso-no-proof:yes'>12.
Типы для работы с коллекциями-множествами</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862499 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>44<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003400390039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862500"><span style='mso-no-proof:yes'>13.
Типы для работы с коллекциями-словарями</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862500 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>45<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862501"><span style='mso-no-proof:yes'>14.
Типы для создания пользовательских коллекций</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862501 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>47<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862502"><span style='mso-no-proof:yes'>15.
Технология LINQ to </span><span lang=EN-US style='mso-ansi-language:EN-US;
mso-no-proof:yes'>O</span><span style='mso-no-proof:yes'>bjects</span><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862502 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>50<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862503"><span style='mso-no-proof:yes'>16.
Работа с объектами файловой системы</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862503 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>61<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862504"><span style='mso-no-proof:yes'>17.
Ввод и вывод информации</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862504 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>67<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862505"><span style='mso-no-proof:yes'>18.
Основы XML и </span><span lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:
yes'>JSON</span><span style='color:windowtext;display:none;mso-hide:screen;
mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862505 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>72<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862506"><span lang=EN-US style='mso-ansi-language:
EN-US;mso-no-proof:yes'>19. </span><span style='mso-no-proof:yes'>Технология</span><span
lang=EN-US style='mso-ansi-language:EN-US;mso-no-proof:yes'> LINQ to XML</span><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862506 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>77<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862507"><span style='mso-no-proof:yes'>20.
Дополнительные возможности обработки XML</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862507 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>83<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862508"><span style='mso-no-proof:yes'>21.
Сериализация времени выполнения</span><span style='color:windowtext;display:
none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862508 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>87<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862509"><span style='mso-no-proof:yes'>22.
Сериализация контрактов данных</span><span style='color:windowtext;display:
none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862509 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>91<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500300039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862510"><span style='mso-no-proof:yes'>23.
Состав и взаимодействие сборок</span><span style='color:windowtext;display:
none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862510 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>93<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862511"><span style='mso-no-proof:yes'>24.
Метаданные и получение информации о типах</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862511 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>98<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862512"><span lang=EN-US style='mso-ansi-language:
EN-US;mso-no-proof:yes'>25. </span><span style='mso-no-proof:yes'>Позднее</span><span
style='mso-ansi-language:EN-US;mso-no-proof:yes'> </span><span
style='mso-no-proof:yes'>связывание</span><span style='mso-ansi-language:EN-US;
mso-no-proof:yes'> </span><span style='mso-no-proof:yes'>и</span><span
style='mso-ansi-language:EN-US;mso-no-proof:yes'> </span><span
style='mso-no-proof:yes'>кодогенерация</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862512 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>102<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862513"><span style='mso-no-proof:yes'>26.
Атрибуты</span><span style='color:windowtext;display:none;mso-hide:screen;
mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862513 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>107<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862514"><span style='mso-no-proof:yes'>27.
Динамическое связывание</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862514 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>110<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862515"><span lang=EN-US style='mso-ansi-language:
EN-US;mso-no-proof:yes'>28. </span><span style='mso-no-proof:yes'>Файлы</span><span
style='mso-ansi-language:EN-US;mso-no-proof:yes'> </span><span
style='mso-no-proof:yes'>конфигурации</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862515 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>115<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862516"><span style='mso-no-proof:yes'>29.
Диагностика и мониторинг</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862516 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>119<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862517"><span style='mso-no-proof:yes'>30.
Процессы и домены</span><span style='color:windowtext;display:none;mso-hide:
screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862517 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>122<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862518"><span style='mso-no-proof:yes'>31. Основы
многопоточного программирования</span><span style='color:windowtext;display:
none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862518 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>124<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862519"><span style='mso-no-proof:yes'>32.
Синхронизация потоков</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862519 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>129<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500310039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862520"><span style='mso-no-proof:yes'>33.
Выполнение асинхронных операций при помощи задач</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862520 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>140<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500320030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862521"><span style='mso-no-proof:yes'>34.
Платформа параллельных вычислений</span><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862521 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>146<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500320031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862522"><span style='mso-no-proof:yes'>35.
Асинхронный вызов методов</span><span style='color:windowtext;display:none;
mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862522 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>150<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500320032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1><a href="#_Toc348862523"><span style='mso-no-proof:yes'>Литература</span><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'><span style='mso-element:field-begin'></span>
PAGEREF _Toc348862523 \h <span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;mso-no-proof:yes;
text-decoration:none;text-underline:none'>153<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300340038003800360032003500320033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;mso-no-proof:yes;text-decoration:none;text-underline:
none'><span style='mso-element:field-end'></span></span><![endif]--></a><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoNormal><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
<o:p>&nbsp;</o:p></p>

<h1><a name="_Toc348862488">1. Работа с числами</a></h1>

<p class=MsoNormal>Платформа .NET содержит базовый набор типов для
представления чисел. В пространстве имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System</span></span> определены целочисленные
типы <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SByte</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Int</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>16</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Int</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>32</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Int</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>64</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Byte</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>UInt</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>16</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>UInt</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>32</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>UInt</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>64</span></span>,
типы для чисел с плавающей запятой <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Single</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Double</span></span>, тип
повышенной точности <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Decimal</span></span>. Для каждого из типов язык C# предлагает
псевдоним в виде ключевого слова (например, <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span> для <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Int</span></span><span
class=ab><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>32</span></span>).</p>

<p class=MsoNormal>Целочисленные типы поддерживают арифметические и битовые
операции, операции сравнения и методы преобразования (в частности, из строки в
число). В каждом типе определены константы <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MinValue</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MaxValue</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>uint</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>x</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>uint</span></span><span
lang=EN-US>.TryParse(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.ReadLine(), </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>out</span></span><span lang=EN-US> x))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (x &gt; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>byte</span></span><span lang=EN-US>.MaxValue) x
&amp;= 255;</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Внутренний формат типов <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>float</span></span> и <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>double</span></span><span
lang=EN-US> </span>отвечает стандарту IEEE 754. Эти типы содержат константы <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>MinValue</span></span>, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>MaxValue</span></span>, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Epsilon</span></span>
(наименьшее положительное число), <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>NaN</span></span> («не число»), <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>NegativeInfinity</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>PositiveInfinity</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// вычислим сумму геометрической прогрессии со
знаменателем 0.1<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>double</span></span><span
lang=EN-US> sum = 0.0, xn = 1.0;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>while</span></span><span
lang=EN-US> (xn &gt; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>double</span></span><span
lang=EN-US>.Epsilon)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>sum</span><span
style='mso-ansi-language:RU'> += </span><span lang=EN-US>xn</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>xn</span><span
style='mso-ansi-language:RU'> *= 0.1;<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Тип <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>decimal</span></span> использует 96 бит для хранения основания, 1
бит – для знака, 8 бит хранят позицию запятой в основании справа (число от 0 до
28). Этот тип содержит константы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>MinValue</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>MaxValue</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>MinusOne</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Zero</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>One</span></span>. В <span lang=EN-US style='mso-ansi-language:
EN-US'>Common</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>Intermediate</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Language</span> нет элементарных инструкций для
манипулирования типом <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>decimal</span></span>, операции с ним транслируются в вызовы
методов.</p>

<p class=MsoNormal>Пространство имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Numerics</span></span> содержит
структуры <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Complex</span></span>.
Структура <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span>
определяет целое число неограниченной длины. Экземпляр структуры может быть
создан на основе строки, массива байтов, или путём приведения одного из обычных
целых типов. Структура <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BigInteger</span></span> выполняет перегрузку арифметических и
битовых операций и содержит несколько статических методов, соответствующих
математическим функциям (например, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Sign()</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Abs()</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DivRem()</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Pow()</span></span>, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Log()</span></span>).</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>подсчёт</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>факториала</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> 10000<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span><span
lang=EN-US> factorial = 1;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> i = 2; i &lt;= 10000; i++)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>factorial</span><span
style='mso-ansi-language:RU'> *= </span><span lang=EN-US>i</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Структура <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Complex</span></span> служит для представления
комплексного числа и обладает набором стандартных элементов (перегрузка
арифметических операций, некоторые математические функции, свойства для
действительной и мнимой части, модуля и аргумента).</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Complex</span></span><span
lang=EN-US> z1 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Complex</span></span>(3, 5);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Complex</span></span><span
lang=EN-US> z2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Complex</span></span>(-2, 10);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Complex</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>z</span><span
style='mso-ansi-language:RU'>3 = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Complex</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Sin</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>z</span><span
style='mso-ansi-language:RU'>1/</span><span lang=EN-US>z</span><span
style='mso-ansi-language:RU'>2);<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// синус от частного двух чисел<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>z</span><span
style='mso-ansi-language:RU'>3.</span><span lang=EN-US>Magnitude</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// напечатаем модуль числа<o:p></o:p></span></span></p>

<p class=MsoNormal>В статическом классе <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Math</span></span> содержится
набор методов, соответствующих основным математическим функциям (табл. 1).</p>

<p class=ae>Таблица 1</p>

<p class=af>Элементы класса <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Math</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td width="78%" style='width:78.6%;border:solid windowtext 1.0pt;border-left:
  none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Abs()</span></span><span
  class=af3><span style='mso-ansi-font-size:12.0pt;font-family:"Times New Roman",serif'><o:p></o:p></span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Модуль (функция перегружена для аргумента <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>sbyte</span></span>, <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>short</span></span>,
  <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span>, <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>long</span></span>, <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>float</span></span>, <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>double</span></span>,
  <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>decimal</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Acos()</span></span>, <span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Asin()</span></span>, <span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Atan()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Арккосинус, арксинус, арктангенс в радианах для аргумента <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>double</span></span>. Если указан
  недопустимый аргумент, возвращается <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>double</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>.NaN</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Atan2()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Арктангенс, вычисленный по отношению двух аргументов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>BigMul()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Произведение двух аргументов типа <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>int</span></span>, имеющее тип <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>long</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Ceiling()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Наименьшее целое, которое больше или равно указанному аргументу
  (функция перегружена для аргумента <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>double</span></span>
  и <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>decimal</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Cos()</span></span>, <span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Sin()</span></span>, <span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Tan()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Косинус, синус, тангенс</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Cosh()</span></span>, <span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Sinh()</span></span>, <span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Tanh()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Гиперболические косинус, синус и тангенс</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>DivRem()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Вычисляет частное и остаток при делении двух чисел типа <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span> или <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>long</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>E</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Константа <span class=a2>e</span><span lang=EN-US
  style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Exp()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Экспонента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Floor()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Наибольшее целое, которое меньше или равно указанному аргументу
  (функция перегружена для аргумента <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>double</span></span>
  и <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>decimal</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IEEERemainder()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Остаток от деления, вычисленный по правилам стандарта IEEE 754</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Log()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Логарифм, вычисленный по заданному основанию (или натуральный
  логарифм, если указан один аргумент)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Log10()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Десятичный логарифм</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Max()</span></span>, <span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Min()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Наибольшее и наименьшее из двух чисел (функция перегружена для
  всех числовых типов, кроме <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>char</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>PI</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Константа &#960;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Pow()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возводит число в указанную степень</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Round()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Округление до ближайшего целого. Можно задать дополнительный
  аргумент, определяющий поведение в случае, если аргумент лежит ровно
  посредине между двумя целыми числами</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Sign()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Знак числа (-1, 0 или 1) (функция перегружена для аргумента <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>sbyte</span></span>, <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>short</span></span>, <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span>,
  <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>long</span></span>, <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>float</span></span>, <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>double</span></span>, <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>decimal</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Sqrt()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Квадратный корень</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:21;mso-yfti-lastrow:yes'>
  <td width="21%" style='width:21.4%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Truncate()</span></span></p>
  </td>
  <td width="78%" style='width:78.6%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Округление до ближайшего целого числа в направлении нуля</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span> генерирует псевдослучайную
последовательность значений <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>byte</span></span>, <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span> или <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>double</span></span>.
Конструктор класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Random</span></span> перегружен и может принимать целочисленное
начальное значение (<span class=a2>зерно</span>) для инициализации последовательности
псевдослучайных чисел. Применение одинакового зерна гарантирует генерирование
одной и той же последовательности, что иногда необходимо в целях отладки. Если
зерно явно не указано, используется значение, вычисленное по текущему времени.
Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Next()</span></span>
генерирует случайное целое число, при этом можно задать допустимый интервал.
Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>NextDouble()</span></span>
возвращает случайное вещественное число из интервала [0, 1), а метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>NextBytes()</span></span>
заполняет массив байтов случайными значениями.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Random</span></span><span
lang=EN-US> r = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span>(1000);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> x = r.Next() + r.Next(100) + r.Next(-10, 10);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>double</span></span><span
lang=EN-US> y = r.NextDouble();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[] buffer = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[10];</span></p>

<p class=aCxSpLast><span lang=EN-US>r</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>NextBytes</span><span style='mso-ansi-language:
RU'>(</span><span lang=EN-US>buffer</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Отметим, что в задачах криптографии следует использовать
более сильный генератор случайных чисел, чем <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span>. Например, в пространстве
имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Security.Cryptography</span></span>
имеется генератор <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>RandomNumberGenerator</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> rand = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>RandomNumberGenerator</span></span>.Create();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[] bytes = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[32];</span></p>

<p class=aCxSpLast><span lang=EN-US>rand</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>GetBytes</span><span style='mso-ansi-language:
RU'>(</span><span lang=EN-US>bytes</span><span style='mso-ansi-language:RU'>);<span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
заполняем массив случайными байтами</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<h1><a name="_Toc348862489">2. Представление даты и времени</a></h1>

<p class=MsoNormal>В пространстве имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System</span></span> определены три
неизменяемые структуры для работы с датой и временем: <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span>.</p>

<p class=MsoNormal>Структура <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span><span lang=EN-US> </span>хранит
интервал времени в виде отсчётов по 100 наносекунд. Для создания экземпляра
структуры можно использовать один из её конструкторов, статические методы вида <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.From</span></span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ЕдиницыВремени</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span> или разность
двух переменных типа <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>ts</span><span
style='mso-ansi-language:RU'>1 = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TimeSpan</span></span><span style='mso-ansi-language:RU'>(50);<span
style='mso-spacerun:yes'>         </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
количество отсчётов по 100 нс</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> ts2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span>(1, 20, 50);<span
style='mso-spacerun:yes'>  </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>часы</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>, </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>минуты</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>секунды</span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>ts</span><span
style='mso-ansi-language:RU'>3 = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>FromHours</span><span
style='mso-ansi-language:RU'>(3.5);<o:p></o:p></span></p>

<p class=MsoNormal>Структура <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span> перегружает операции
сравнения и аддитивные операции. Свойства структуры <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span>
позволяют обратиться либо к отдельному временному компоненту интервала
(свойства <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Days</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Hours</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Minutes</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Seconds</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Milliseconds</span></span>),
либо выразить весь интервал через указанную единицу времени (<span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TotalDays</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TotalHours</span></span> и т.п.).</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span><span
lang=EN-US> ts = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span>.FromDays(10) - <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TimeSpan</span></span>.FromSeconds(1);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(ts.Days);<span style='mso-spacerun:yes'>            
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// 9</span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(ts.Seconds);<span style='mso-spacerun:yes'>         
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// 59</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(ts.TotalDays);<span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// 9.99998842592593</span></span></p>

<p class=MsoNormal>Структуры<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTimeOffset</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'> </span>предназначены<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>хранения<span style='mso-ansi-language:
EN-US'> </span>даты<span style='mso-ansi-language:EN-US'> </span>и<span
style='mso-ansi-language:EN-US'> </span>времени<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Интервал дат – от 1 января 1 года до
31 декабря 9999 года, точность времени – 100 наносекунд. <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span>
дополнительно хранит <span class=a2>смещение всемирного координированного
времени</span> (UTC offset), что даёт возможность правильно сравнивать даты
разных часовых поясов.</p>

<p class=MsoNormal>Структура <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span> имеет конструкторы,
позволяющие указать для создаваемого экземпляра год, месяц, день, часы, минуты,
секунды, миллисекунды. Дополнительно можно задать аргумент из перечисления <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeKind</span></span>,
который показывает, какое именно время содержит экземпляр (<span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Unspecified</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Local</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Utc</span></span>). Также можно задать
используемый датой календарь – это влияет на алгоритм вычисления некоторых
свойств даты. Конструкторы структуры <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span> дополнительно
разрешают указать смещение UTC как значение <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span> (целое количество минут)<a
style='mso-footnote-id:ftn1' href="#_ftn1" name="_ftnref1" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[1]</span></span><![endif]></span></span></a>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> dt1 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>(2012, 12, 21);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> dt2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>(2012, 12, 21, 12, 0, 0, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTimeKind</span></span>.Local);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> dt3 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>(2012, 12, 21, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>PersianCalendar</span></span>());</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> dto = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span>(dt1, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TimeSpan</span></span>.FromHours(-6));</span></p>

<p class=MsoNormal>Определено неявное преобразование <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span> к <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span>.
Такие свойства структуры <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTimeOffset</span></span> как <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>UtcDateTime</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LocalDateTime</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span> дают возможность
получить значение времени UTC в виде <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.</p>

<p class=MsoNormal>Используя структуры <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span>,
текущее время и дату можно узнать при помощи свойств <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Now</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Today</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>UtcNow</span></span>. Обе структуры содержат
свойства для чтения отдельных временных компонентов, а также методы для
увеличения временных компонент на указанную (возможно, отрицательную) величину.
Структуры <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span>
также перегружают операции сравнения и аддитивные операции.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>dt</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Today</span><span
style='mso-ansi-language:RU'>;<span style='mso-spacerun:yes'>           
</span><span style='mso-spacerun:yes'>  </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
текущая дата (без времени)</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>dt</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Month</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>  </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>// узнаем текущий месяц</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>dt</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>DayOfWeek</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>// и день недели</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> changed_dt = dt.AddDays(-3.5);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeOffset</span></span><span
lang=EN-US> dto = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.Now;<span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>  </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>неявное</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>преобразование</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(dto.Offset);<span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>  </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>узнаем</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> UTC offset</span></span></p>

<h1><a name="_Toc348862490">3. Работа со строками и текстом</a></h1>

<p class=MsoNormal>Для представления отдельных символов в платформе .NET
применяется структура <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Char</span></span>,
которая использует Unicode-кодировку UTF-16. Язык C# предлагает для типа <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Char</span></span>
псевдоним <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span>.</p>

<p class=MsoNormal>В структуре <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Char</span></span> имеется экземплярный метод
сравнения <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CompareTo()</span></span>.
Большинство статических методов структуры <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Char</span></span> нужны для выяснения
принадлежности символа к одной из Unicode-категорий (таблица символов и
категорий доступна по адресу <a
href="file:///C:\Users\Олег\Desktop\2013\www.blackbeltcoder.com\Resources\CharClass.aspx">blackbeltcoder.com/Resources/CharClass.aspx</a>).
Многие методы перегружены: они могут принимать в качестве аргумента либо
отдельный символ, либо строку и номер символа в ней.</p>

<p class=ae>Таблица 2</p>

<p class=af>Статические методы структуры <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Char</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя метода</p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ConvertFromUtf32()<o:p></o:p></span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразует целочисленный суррогатный UTF-код в строку</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ConvertToUtf32()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразует пару суррогатных символов<a style='mso-footnote-id:
  ftn2' href="#_ftn2" name="_ftnref2" title=""><span
  class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
  class=MsoFootnoteReference><span style='font-size:12.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
  mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[2]</span></span><![endif]></span></span></a>
  в UTF-код</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetNumericValue()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает численное значение символа, если он является цифрой,
  и –1.0 в противном случае</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetUnicodeCategory()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод возвращает элементы перечисления <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>UnicodeCategory</span></span>, описывающего категорию
  символа</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsControl()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является управляющим</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsDigit()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является десятичной цифрой</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Is</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>High</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Surrogate()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Определяет, является ли символ старшим символом-заместителем суррогатной
  пары</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsLetter()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является буквой</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsLetterOrDigit()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является буквой или цифрой</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsLower()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ – это буква в нижнем регистре</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Is</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>Low</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Surrogate()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Определяет, является ли символ младшим символом-заместителем суррогатной
  пары</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsNumber()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является десятичной или шестнадцатеричной цифрой</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsPunctuation()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является знаком препинания</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsSeparator()<o:p></o:p></span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является разделителем</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsSurrogate()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является суррогатным</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsSurrogate</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>Pair</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span style='mso-fareast-font-family:"Times New Roman";
  mso-fareast-theme-font:major-fareast'>Определяет, образуют ли два заданных </span>символа<span
  style='mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:major-fareast'>
  суррогатную пару</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsS</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>ymbol</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span style='mso-fareast-font-family:"Times New Roman";
  mso-fareast-theme-font:major-fareast'>Показывает, относится ли символ к
  категории символьных знаков</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsUpper()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ – это буква в верхнем регистре</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsWhiteSpace()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если символ является пробельным (например, пробел, символ конца строки,
  символ перевода каретки)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Parse()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразует строку в символ. Строка должна состоять из одного
  символа, иначе генерируется исключение</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:21'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToLower()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Приводит символ к нижнему регистру</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:22'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToLower</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>Invariant</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Приводит символ к нижнему регистру, <span style='mso-fareast-font-family:
  "Times New Roman";mso-fareast-theme-font:major-fareast'>используя правила</span>
  инвариантной культуры</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:23'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToUpper()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Приводит символ к верхнему регистру</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:24'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToUpper</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>Invariant</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Приводит символ к верхнему регистру, <span style='mso-fareast-font-family:
  "Times New Roman";mso-fareast-theme-font:major-fareast'>используя правила</span>
  инвариантной культуры</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:25;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TryParse()</span></span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Пытается преобразовать строку в символ</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Основным типом платформы .NET для работы со строками
является класс <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>String</span></span>
(псевдоним в C# – <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span>). Этот класс представляет неизменяемый объект.
Инициализация строки обычно выполняется при помощи строкового литерала. Однако
класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>String</span></span>
содержит конструкторы для создания строки из массива символов или символа,
повторенного заданное число раз.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> literal = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;This is a simple
string&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> charArray = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'C'</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'h'</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'a'</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'r'</span></span><span
lang=EN-US>});</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> charRepeated = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'X'</span></span><span
lang=EN-US>, 3);</span></p>

<p class=MsoNormal>Для строк определены операции <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>==</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>!=</span></span>. При этом выполняется
посимвольное сравнение строк – используется семантика типов значений.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string </span></span><span
lang=EN-US>charArray = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'C'</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'h'</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'a'</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>'r'</span></span><span
lang=EN-US>});</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string </span></span><span
lang=EN-US>charString = </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Char&quot;</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(charArray == charString); <span
style='mso-spacerun:yes'>   </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// True</span></span></p>

<p class=MsoNormal>Любая строка содержит индексатор для чтения отдельного
символа. Кроме этого, символы строки можно перебрать при помощи цикла <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span><span
lang=EN-US> ch </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;This is a simple
string&quot;</span></span><span lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>ch</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>В языке C# соединение строк можно выполнить при помощи
операции <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>+</span></span>,
что транслируется в вызов метода <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>String</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.Concat()</span></span> (литералы соединяются
на этапе компиляции).</p>

<p class=MsoNormal>Статические элементы класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>String</span></span><span lang=EN-US> </span>приведены
в табл. 3.</p>

<p class=ae>Таблица 3</p>

<p class=af>Статические элементы класса <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>String</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Empty<o:p></o:p></span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство только для чтения, которое возвращает пустую строку</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Compare()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Сравнение двух строк. Реализации метода позволяют сравнивать как
  строки, так и подстроки. При этом можно учитывать регистр и алфавит
  конкретного языка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CompareOrdinal()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Сравнение двух строк. Реализации метода позволяют сравнивать как
  строки, так и подстроки. Сравниваются коды символов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Concat()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Конкатенация произвольного числа строк</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Concat&lt;T&gt;()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод выполняет проход по указанной коллекции, преобразует каждый
  элемент в строку и соединяет полученные строки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Copy()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт копию строки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Format()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Выполняет форматирование строки в соответствии с заданными
  спецификациями формата</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Join()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Соединение элементов массива строк или коллекции строк в единую
  строку. Между элементами можно вставить разделители</p>
  </td>
 </tr>
</table>

</div>

<p class=ae>Окончание табл. 3</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Join&lt;T&gt;()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод выполняет проход по указанной коллекции, преобразует каждый
  элемент в строку и соединяет полученные строки. Между элементами можно вставить
  разделители</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsNullOrEmpty()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Проверяет, является ли аргумент пустой строкой или <span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>null</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsNullOrWhiteSpace()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Проверяет, является ли аргумент пустой строкой, <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>null</span></span> или состоит только из пробельных
  символов</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Сводка экземплярных методов класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>String</span></span>
приведена в табл. 4. Ни один из этих методов не меняет строку, у которой
вызывается. Конечно, некоторые методы создают и возвращают в качестве
результата новые строки.</p>

<p class=ae>Таблица 4</p>

<p class=af>Экземплярные методы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>String</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя метода</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CompareTo()<o:p></o:p></span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Сравнивает строки для выяснения порядка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Insert()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Вставляет подстроку в заданную позицию</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Remove()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Удаляет подстроку в заданной позиции</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Replace()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Заменяет подстроку в заданной позиции на новую подстроку</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;page-break-inside:avoid'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Split()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Разбивает строку на массив слов. Допускает указание разделителя
  слов (по умолчанию – пробел), а также опции для удаления пустых слов из
  итогового массива</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Substring()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Выделяет подстроку в заданной позиции</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CopyTo()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Копирует указанный фрагмент строки в массив символов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Contains()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Определяет вхождение заданной подстроки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IndexOf()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IndexOfAny()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastIndexOf()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastIndexOfAny()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Определяются индексы первого и последнего вхождения заданной
  подстроки или любого символа из заданного набора</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>StartsWith()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>EndsWith()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращается <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>
  или <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>false</span></span>, в
  зависимости от того, начинается или заканчивается строка заданной подстрокой.
  При этом можно учитывать регистр и алфавит конкретного языка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>PadLeft()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>PadRight()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Выполняют «набивку» нужным числом пробелов в начале или в конце
  строки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Trim()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrimStart()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrimEnd()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Удаляются пробелы в начале и в конце строки или только с одного
  её конца</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToCharArray()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразование строки в массив символов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToLower()</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>ToUpper()</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'>,</span></p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToLowerInvariant()</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'>,</span></p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToUpperInvariant()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Изменение<span style='mso-ansi-language:EN-US'> </span>регистра<span
  style='mso-ansi-language:EN-US'> </span>символов<span style='mso-ansi-language:
  EN-US'> </span>строки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>один</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>из</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>способов</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>перевернуть</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>строку</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> source = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;This is a simple
string&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span><span
lang=EN-US>[] charArray = source.ToCharArray();</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
lang=EN-US>.Reverse(charArray);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> destination = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>(charArray);</span></p>

<p class=MsoNormal>Так как класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>String</span></span> представляет неизменяемый
объект, многократное использование методов для модификации строки (например, в
цикле) снижает производительность. В пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Text</span></span> размещён класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringBuilder</span></span>
для работы с редактируемой строкой. Класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StringBuilder</span></span> применяет для
хранения символов внутренний массив, который изменяется при редактировании
строки (новые экземпляры объекта не создаются). Набор методов класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringBuilder</span></span>
поддерживает основные операции редактирования строк (<span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Append()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Insert()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Remove()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Replace()</span></span>), а также получение
«нормальной» строки из внутреннего массива.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создаём объект на основе строки и указываем
ёмкость массива<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringBuilder</span></span><span
lang=EN-US> sb = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StringBuilder</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;start&quot;</span></span><span
lang=EN-US>, 300);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> i = 1; i &lt; 100; i++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>sb.Append(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;abc&quot;</span></span><span
lang=EN-US>);<span style='mso-spacerun:yes'>        </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>много</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>раз</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>добавляем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>к</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>строке</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>текст</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> s = sb.ToString();<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>получаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>обычную</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>строку</span></span></p>

<p class=MsoNormal>Платформа .NET предлагает поддержку работы с регулярными
выражениями. <span class=a2>Регулярное выражение</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>regular</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>expression</span>) – это
строка-шаблон, которому может удовлетворять определённое множество слов.
Регулярные выражения используются для проверки корректности информации
(например, правильного формата адресов электронной почты), поиска и замены
текста по определённому образцу.</p>

<p class=MsoNormal>Коротко опишем синтаксис построения регулярных выражений<a
style='mso-footnote-id:ftn3' href="#_ftn3" name="_ftnref3" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[3]</span></span><![endif]></span></span></a>.
В простейшем случае регулярное выражение – это последовательность букв или
цифр. Тогда оно определяет именно то, что представляет. Но, как правило,
регулярное выражение содержит некоторые особые спецсимволы. Первый набор таких
спецсимволов позволяет определить символьные множества (табл. 5).</p>

<p class=ae>Таблица 5</p>

<p class=af>Символьные множества в регулярных выражениях</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Выражение</p>
  </td>
  <td width=390 style='width:292.85pt;border:solid windowtext 1.0pt;border-left:
  none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Значение</p>
  </td>
  <td width=168 style='width:125.8pt;border:solid windowtext 1.0pt;border-left:
  none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Обратное по смыслу выражение</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>[abcdef]</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Один символ из списка</p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>[^abcdef]</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>[a-f]</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Один символ из диапазона</p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>[^a-f]</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\d</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Десятичная цифра (аналог <span class=afc><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>[0-9]</span></span>)</p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\D</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\w</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Словообразующий символ (зависит от текущей языковой культуры;
  например, для английского языка это <span class=afc><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
  mso-ansi-language:RU'>[</span></span><span class=afc><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>a</span></span><span
  class=afc><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:RU'>-</span></span><span class=afc><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>zA</span></span><span class=afc><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
  mso-ansi-language:RU'>-</span></span><span class=afc><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Z</span></span><span
  class=afc><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:RU'>_0-9]</span></span>)</p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\W</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\s</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Пробельный символ (пробел, табуляция, новая строка, перевод
  каретки)</p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\S</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\p{…}</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Любой символ из указанной Unicode-категории. Например, <span
  class=afc><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:RU'>\</span></span><span class=afc><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>p</span></span><span class=afc><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
  mso-ansi-language:RU'>{</span></span><span class=afc><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>P</span></span><span
  class=afc><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:RU'>}</span></span> – символы пунктуации</p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\P{…}</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>.</span></span></p>
  </td>
  <td width=390 style='width:292.85pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Любой символ, кроме <span class=afc><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\n</span></span></p>
  </td>
  <td width=168 style='width:125.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=afc><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>\n</span></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>В регулярном выражении можно использовать особые символы для
начала строки <span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>^</span></span>, конца строки <span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>$</span></span>, границы
слова <span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>\</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>b</span></span>, символа табуляции <span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>\</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>t</span></span>
и перевода строки <span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>\</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>n</span></span>.</p>

<p class=MsoNormal>Отдельные атомарные регулярные выражения допустимо обрамлять
в <span class=a2>группы</span>, при помощи пары скобок <span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>()</span></span>. Если
необходимо, группы или выражения можно объединять, используя символ <span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>|</span></span>.</p>

<p class=MsoNormal>К каждому символу или группе можно присоединить
квантификаторы повторения:</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>?</span></span><span style='mso-tab-count:1'>      </span><span
style='mso-tab-count:2'>               </span>повтор 0 или 1 раз;</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>+</span></span><span style='mso-tab-count:1'>      </span><span
style='mso-tab-count:2'>               </span>повтор от 1 до бесконечности;</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>*</span></span><span style='mso-tab-count:1'>      </span><span
style='mso-tab-count:2'>               </span>повтор от 0 до бесконечности;</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>{</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>n</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>}</span></span><span
style='mso-tab-count:1'>  </span><span style='mso-tab-count:2'>               </span>повтор
n раз ровно;</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>{</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>n</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>, </span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>m</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>}</span></span><span
style='mso-tab-count:1'>    </span><span style='mso-tab-count:1'>        </span>повтор
от n до m раз;</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>{</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>n</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>,}</span></span><span
style='mso-tab-count:1'> </span><span style='mso-tab-count:2'>               </span>повтор
от n раз до бесконечности;</p>

<p class=MsoNormal>Рассмотрим некоторые простые примеры регулярных выражений:</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>^\</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>s</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>*$</span></span><span
style='mso-tab-count:2'>              </span>пустая строка</p>

<p class=MsoNormal><span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>\</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>btext</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>\</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>b</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'><span
style='mso-tab-count:1'> </span></span></span><span style='mso-tab-count:1'>        </span>отдельное
слово <span lang=EN-US style='mso-ansi-language:EN-US'>text</span></p>

<p class=MsoNormal><span class=ad><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>\b[bcf]at\b</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'><span style='mso-tab-count:1'>   </span></span>слова<span lang=EN-US
style='mso-ansi-language:EN-US'> bat, cat, fat<o:p></o:p></span></p>

<p class=MsoNormal>В .NET имеется пространство имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Text.RegularExpressions</span></span>,
содержащее набор типов для работы с регулярными выражениями. Основной тип для
работы с регулярными выражениями – это класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Regex</span></span>. Объект класса представляет
одно регулярное выражение, которое указывается при вызове конструктора.
Существует перегруженная версия конструктора, позволяющая указать различные
опции для создаваемого регулярного выражения.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Regex</span></span><span
lang=EN-US> re1 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Regex</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>@&quot;\b[bcf]at\b&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Regex</span></span><span
lang=EN-US> re2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Regex</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>@&quot;\b[bcf]at\b&quot;</span></span><span lang=EN-US>, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>RegexOptions</span></span>.IgnoreCase);</span></p>

<p class=MsoNormal>Для поиска информации согласно текущему регулярному
выражению можно использовать метод <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Regex</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.IsMatch()</span></span>. Более продуктивным
является применение функции <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Match()</span></span>, которая возвращает объект класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Match</span></span>.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Regex</span></span><span
lang=EN-US> re = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Regex</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>@&quot;\b[bcf]at\b&quot;</span></span><span lang=EN-US>, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>RegexOptions</span></span>.Compiled);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Match</span></span><span
lang=EN-US> match = re.Match(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;bad
fat cat&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>while</span></span><span
lang=EN-US> (match.Success)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(match.Index);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(match.Value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>match = match.NextMatch();</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для замены на основе регулярных выражений используется метод
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Regex</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Replace()</span></span>. Его
аргументы – обрабатываемая строка и строка на замену.</p>

<h1><a name="_Toc348862491">4. Преобразование информации</a></h1>

<p class=MsoNormal>Платформа .NET и языки программирования, построенные на её
основе, предлагают богатый набор средств для решения задачи преобразования
информации в данные различных типов.</p>

<p class=MsoNormal>Язык C# поддерживает операции явного и неявного
преобразования типов, причём эти операции могут быть перегружены в
пользовательских типах. При этом желательно, чтобы перегружаемые операции
преобразования имели простую семантику и работали на сходных множествах
значений.</p>

<p class=MsoNormal>Для выполнения взаимных преобразований данных <span
class=a2>базовых типов</span> (числовые типы, <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span>, <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span>)
предназначен статический класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Convert</span></span>. Этот класс содержит
набор методов вида <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>To</span></span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ИмяТипа</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>, где <span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ИмяТипа</span></span>
является именем CLR для базовых типов. Каждый такой метод перегружен и
принимает аргумент любого базового типа. Выполнение метода может быть успешным
или генерировать исключения <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>InvalidCastException</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FormatException</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>OverflowException</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US> x = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Convert</span></span>.ToByte(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;123&quot;</span></span><span lang=EN-US>);<span
style='mso-spacerun:yes'>           </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// x = 123</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> y = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Convert</span></span>.ToBoolean(10.5);<span
style='mso-spacerun:yes'>         </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// y = true</span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> z = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Convert</span></span>.ToInt32(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.Now);<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// InvalidCastException</span></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Convert</span></span> также содержит методы для взаимных
преобразований массива байтов в строку (или массив символов) в формате Base-64:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// конвертируем массив в Base64 и выполним
обратное преобразование<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[] data = {10, 20, 30, 40, 50};</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Convert</span></span>.ToBase64String(data));</span></p>

<p class=aCxSpLast><span lang=EN-US>data = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Convert</span></span>.FromBase64String(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;ChQeKDI=&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Отметим<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>что<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>унификации<span style='mso-ansi-language:EN-US'> </span>операций<span
style='mso-ansi-language:EN-US'> </span>преобразования<span style='mso-ansi-language:
EN-US'> </span>все<span style='mso-ansi-language:EN-US'> </span>базовые<span
style='mso-ansi-language:EN-US'> </span>типы<span style='mso-ansi-language:
EN-US'> </span>явным<span style='mso-ansi-language:EN-US'> </span>образом<span
style='mso-ansi-language:EN-US'> </span>реализуют<span style='mso-ansi-language:
EN-US'> </span>интерфейс<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IConvertible</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Это<span style='mso-ansi-language:
EN-US'> </span>интерфейс<span style='mso-ansi-language:EN-US'> </span>содержит<span
style='mso-ansi-language:EN-US'> </span>набор<span style='mso-ansi-language:
EN-US'> </span>методов<span style='mso-ansi-language:EN-US'> </span>вида<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>To</span></span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ИмяТипа</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>()</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>, </span>где<span style='mso-ansi-language:EN-US'> </span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ИмяТипа</span></span><span
style='mso-ansi-language:EN-US'> <span lang=EN-US>– </span></span>имя<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>CLR </span></span>для<span
style='mso-ansi-language:EN-US'> </span>базовых<span style='mso-ansi-language:
EN-US'> </span>типов<span lang=EN-US style='mso-ansi-language:EN-US'>. </span>Каждый
такой метод принимает аргумент типа <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IFormatProvider</span></span>. Базовые типы при
реализации <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IConvertible</span></span>
просто вызывают соответствующие методы класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Convert</span></span>.</p>

<p class=MsoNormal>Статический класс <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BitConverter</span></span>
содержит набор методов для преобразования переменной числового или булевого
типа в массив байтов, а также методы обратного преобразования. Подобные
преобразования полезны при низкоуровневой работе с потоками данных.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
style='mso-ansi-language:RU'>[] </span><span lang=EN-US>data</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BitConverter</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>GetBytes</span><span
style='mso-ansi-language:RU'>(10567);<o:p></o:p></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> x = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BitConverter</span></span>.ToInt32(data, 0);</span></p>

<p class=MsoNormal>Важными видами преобразований являются получение строкового
представления объекта и получение объекта из строки. Для получения строкового
представления объекта можно использовать виртуальный метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ToString()</span></span>, определённый в классе
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Object</span></span>.
Однако часто требуется дать возможность выбора формата представления и учесть
региональные стандарты. Для этой цели предназначен интерфейс <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IFormattable</span></span>,
который реализуют числовые типы, структура <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>, класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Enum</span></span> и
некоторые другие типы.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IFormattable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> ToString(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> format, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IFormatProvider</span></span> formatProvider);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Первый параметр метода <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IFormattable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.ToString()</span></span> – это строка,
сообщающая способ форматирования объекта. Многие типы различают несколько строк
форматирования. Например, структура <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span> поддерживает строку <span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>d</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>
для дат в кратком формате, <span class=ad><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span class=ad><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>D</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>
для дат в полном формате, <span class=ad><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span class=ad><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>T</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>
– для времени и т. д. Числа поддерживают строку <span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>X</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>
для шестнадцатеричного вывода, <span class=ad><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span class=ad><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>C</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>
– для валют, <span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>E</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span> – для
научного формата. Числовые типы также различают шаблоны форматирования, чтобы
отобразить нужное количество цифр и знаков в дробной части (полную информацию о
строках форматирования смотрите в MSDN).</p>

<p class=MsoNormal>Второй параметр метода <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IFormattable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.ToString()</span></span> – это <span class=a2>поставщик
формата</span>. Это<span style='mso-ansi-language:EN-US'> </span>объект<span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>реализующий<span
style='mso-ansi-language:EN-US'> </span>интерфейс<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IFormatProvider</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>.<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IFormatProvider</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US>
GetFormat(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span> formatType);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Поставщик формата знает, как обеспечить учёт региональных
стандартов, влияющих на форматирование чисел, дат и времени. Метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetFormat()</span></span>
возвращает нужный объект для форматирования по его типу. Например, объект
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>NumberFormatInfo</span></span><span
lang=EN-US> </span>описывает группу свойств <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>NegativeSign</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CurrencyDecimalSeparator</span></span>, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CurrencySymbol</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>NumberGroupSeparator</span></span>
и т. п. У объекта класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTimeFormatInfo</span></span><span lang=EN-US> </span>имеются свойства
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Calendar</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DayNames</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateSeparator</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>LongDatePattern</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ShortTimePattern</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeSeparator</span></span>
и т. п.</p>

<p class=MsoNormal>Платформа .NET содержит несколько поставщиков формата, в
частности, класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CultureInfo</span></span><a style='mso-footnote-id:ftn4'
href="#_ftn4" name="_ftnref4" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[4]</span></span><![endif]></span></span></a>
. Конструктор этого класса принимает числовой или строковый идентификатор
культуры. Свойство <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CultureInfo</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.InvariantCulture</span></span> описывает
инвариантную культуру, не связанную с региональными стандартами.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// дата, которую будем форматировать<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>dt</span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span><span style='mso-ansi-language:RU'>(2012, 12,
21);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создаём поставщик формата для русской
культуры<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>список</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>кодов</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>: msdn.microsoft.com/en-us/goglobal/bb896001<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> culture = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CultureInfo</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;ru-Ru&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// s1
= &quot;21 </span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>декабря</span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> 2012 </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>г</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>.&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s1 = dt.ToString(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;D&quot;</span></span><span
lang=EN-US>, culture);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>используем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>инвариантную</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>культуру</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s2 = dt.ToString(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;D&quot;</span></span><span
lang=EN-US>, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CultureInfo</span></span>.InvariantCulture);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// используем культуру текущего потока
выполнения<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'>3 = </span><span lang=EN-US>dt</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ToString</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>D</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>, </span><span
lang=EN-US>null</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Чаще всего при получении строкового представления объекта
нужно указать только формат, довольствуясь региональными стандартами,
связанными с вызывающим потоком. Для упрощения работы во многие типы добавлены
перегруженные версии метода <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ToString()</span></span>, вызывающие <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IFormattable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.ToString()</span></span> с
аргументами по умолчанию:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> x = 1024;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s1 = x.ToString();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s2 = x.ToString(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;X&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s3 = x.ToString(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CultureInfo</span></span>.InvariantCulture);</span></p>

<p class=MsoNormal>Любой тип может определять дополнительные методы для
получения строкового представления данных. Например, в <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span>
определены методы <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ToLongDateString()</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ToShortDateString()</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ToLongTimeString()</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ToShortDateString()</span></span>.</p>

<p class=MsoNormal>Для получения данных типа по строке обычно используются
статические методы, которые по соглашению об именовании называются <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parse()</span></span> и <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TryParse()</span></span>.
Если преобразование из строки невозможно, метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Parse()</span></span> генерирует исключение, а <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TryParse()</span></span>
возвращает значение <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>false</span></span>. Методы <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Parse()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TryParse()</span></span> есть во всех
примитивных типах, классе <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enum</span></span>, в типах для работы со
временем и во многих других типах. Обычно эти методы имеют перегруженные
версии, принимающие в качестве аргумента поставщик формата. Некоторые типы
дополнительно перегружают <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Parse()</span></span> и <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TryParse()</span></span> для более тонкой настройки преобразования:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> x = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Int32</span></span>.Parse(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;1024&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> z = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Int32</span></span>.Parse(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;A03&quot;</span></span><span lang=EN-US>,
<span class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>NumberStyles</span></span>.HexNumber);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> y;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Int32</span></span>.TryParse(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;4201&quot;</span></span><span lang=EN-US>,
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>out</span></span><span lang=EN-US> y))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Success&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span><span
lang=EN-US> dt = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.Parse(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;13/01/2000 16:45:06&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Платформа .NET способна поддерживать различные текстовые
кодировки и наборы символов. Для этого используется базовый класс <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Text.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Encoding</span></span>
и наследники этого класса – конкретные кодировки. Чтобы получить объект-кодировку
можно использовать статический метод <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Encoding</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.GetEncoding()</span></span> или статические
свойства для популярных кодировок:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// используется имя кодировки по стандарту IANA
(см. сайт iana.org)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Encoding</span></span><span
lang=EN-US> utf8 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Encoding</span></span>.GetEncoding(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;utf-8&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// распространённую кодировку можно получить
через свойство</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Encoding</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>ascii</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Encoding</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ASCII</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=MsoNormal>Основными методами каждого объекта-кодировки являются <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetBytes()</span></span> и <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetString()</span></span>.
Первый метод нужен для перевода строки или массива символов в массив байтов
(коды символов), второй метод делает обратное преобразование:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Encoding</span></span><span
lang=EN-US> ascii = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Encoding</span></span>.ASCII;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[] asciiBytes = ascii.GetBytes(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Sample text&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> s = ascii.GetString(asciiBytes);</span></p>

<h1><a name="_Toc348862492">5. Сравнение для выяснения равенства</a></h1>

<p class=MsoNormal>Платформа .NET и язык C# предлагают несколько стандартных
протоколов для выяснения равенства объектов. Наиболее общий подход при
реализации проверки равенства заключается в переопределении виртуального метода
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Equals()</span></span>
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Object</span></span>.
Базовая версия этого метода использует равенство ссылок. Тип <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ValueType</span></span>
перекрывает <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Equals()</span></span>,
чтобы реализовать равенство по значению, то есть проверку на совпадение всех
соответствующих полей двух переменных типа значения.</p>

<p class=MsoNormal>Основными причинами перекрытия <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Equals()</span></span> в пользовательском типе
являются особая семантика равенства, перенос на ссылочный тип равенства по
значению, необходимость ускорения проверки на равенство для типа значения.
Перекрытая версия <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Equals()</span></span>
должна удовлетворять следующим требованиям:</p>

<p class=MsoNormal>1. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>x.Equals(x)
== </span></span><span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>true</span></span>.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>2. </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>x.Equals(y) == y.Equals(x)</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>3. </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>(x.Equals(y) &amp;&amp; y.Equals(z)) == </span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span><!--[if gte msEquation 12]><m:oMath><i
 style='mso-bidi-font-style:normal'><span lang=EN-US style='font-family:"Cambria Math",serif;
 mso-ansi-language:EN-US'><m:r>&#10233;</m:r></span></i></m:oMath><![endif]--><![if !msEquation]><span
style='font-size:14.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:minor-bidi;
position:relative;top:3.0pt;mso-text-raise:-3.0pt;mso-ansi-language:RU;
mso-fareast-language:RU;mso-bidi-language:AR-SA'><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:16.5pt;
 height:16.5pt'>
 <v:imagedata src="metoda1.files/image001.png" o:title="" chromakey="white"/>
</v:shape></span><![endif]><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>x.Equals(z) == </span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal>4. Вызовы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>x.Equals(y)</span></span> возвращают одинаковое значение до тех
пор, пока <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>x</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>y</span></span>
остаются неизменными.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>5. </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>x.Equals(</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>) == </span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>false</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>если<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>x != </span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal>6. Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Equals()</span></span> не должен генерировать исключений.</p>

<p class=MsoNormal>Так как метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Equals()</span></span> класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Object</span></span> принимает в качестве
аргумента объект, для типов значений при вызове метода происходит операция
упаковки. Чтобы избежать этого, тип может дополнительно к перекрытию <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Equals()</span></span>
реализовать интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEquatable</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEquatable</span></span>&lt;T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Equals(T
other);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Рассмотрим пример неизменяемой структуры <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Area</span></span>, в которой
выполнено перекрытие метода <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Equals()</span></span>, реализация интерфейса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEquatable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и
перекрыта операция проверки равенства.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>struct</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Area</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEquatable</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Area</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public readonly int</span></span><span
lang=EN-US> Measure1;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public readonly int</span></span><span
lang=EN-US> Measure2;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> Area(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> m1, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> m2)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Measure1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Math</span></span>.Min(m1, m2);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Measure2 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Math</span></span>.Max(m1, m2);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public override bool</span></span><span
lang=EN-US> Equals(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> other)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (other </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>is</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Area</span></span>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> Equals((<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Area</span></span>)
other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>false</span></span><span style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
альтернативная реализация (подходит для типов значений)</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// Area? otherArea = other as Area?;</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// return
otherArea.HasValue &amp;&amp; Equals(otherArea.Value);</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Equals(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Area</span></span> other)<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>реализация</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> IEquatable&lt;Area&gt;</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> Measure1
== other.Measure1</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>&amp;&amp; Measure2 ==
other.Measure2;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>   </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>override</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> GetHashCode()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> Measure1 *
31 + Measure2;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static bool operator</span></span><span
lang=EN-US> ==(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Area</span></span> a1, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Area</span></span>
a2)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
a1.Equals(a2);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static bool operator</span></span><span
lang=EN-US> !=(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Area</span></span> a1, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Area</span></span>
a2)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
style='mso-ansi-language:RU'> !</span><span lang=EN-US>a</span><span
style='mso-ansi-language:RU'>1.</span><span lang=EN-US>Equals</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>a</span><span
style='mso-ansi-language:RU'>2);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Базовые типы значений платформы .NET (включая структуры для
представления времени) реализуют интерфейс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEquatable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и перекрывают операции <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>==</span></span> и <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>!=</span></span>. Тип <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span>
дополнительно содержит перегруженную версию <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Equals()</span></span>, позволяющую выполнить
сравнение, учитывающее региональные стандарты или нечувствительное к регистру.
Эта версия принимает в качестве аргумента один из элементов перечисления <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparison</span></span>:</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CurrentCulture</span></span>
– сравнение в алфавите текущего регионального стандарта;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CurrentCultureIgnoreCase</span></span>
– сравнение в алфавите текущего регионального стандарта без учёта регистра
символов;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>InvariantCulture</span></span>
– сравнение в алфавите инвариантной культуры;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>InvariantCultureIgnoreCase</span></span>
– сравнение в алфавите инвариантной культуры без учёта регистра;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Ordinal</span></span>
– <span class=a2>порядковое сравнение</span>, при котором символы
интерпретируются как числа (коды в UTF-16);</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>OrdinalIgnoreCase</span></span>
– порядковое сравнение без учёта регистра.</p>

<p class=MsoNormal>Если создатель типа не реализовал эффективный метод проверки
равенства, этот недостаток можно восполнить, применив подходящий <span
class=a2>подключаемый интерфейс</span>. Интерфейсы <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Collections.Generic.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span>
позволяют организовать проверку объектов на равенство и вычисление хэш-кода
объекта:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Equals(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> x, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> y);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> GetHashCode(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> obj);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Equals(T x,
T y);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>GetHashCode</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>T</span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>obj</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Желательно, чтобы во вспомогательном типе для проверки
равенства были реализованы обе версии интерфейса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span>.
Существует абстрактный класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Collections.Generic.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>EqualityComparer</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
реализующий интерфейсы <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEqualityComparer</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span>
и содержащий виртуальные методы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Equals()</span></span> и <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetHashCode()</span></span>. Можно наследовать
от этого класса и заместить его виртуальные методы.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Customer</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
FirstName { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
LastName { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LastFirstComparer</span></span> : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EqualityComparer</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Customer</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public override bool</span></span><span
lang=EN-US> Equals(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Customer</span></span> x, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Customer</span></span>
y)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
x.LastName == y.LastName &amp;&amp;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>               </span>x.FirstName == y.FirstName;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public override int</span></span><span
lang=EN-US> GetHashCode(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Customer</span></span> obj)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
(obj.LastName + </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;;&quot;</span></span><span
lang=EN-US> + obj.FirstName).GetHashCode();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Статическое<span style='mso-ansi-language:EN-US'> </span>свойство<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>EqualityComparer</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;.Default</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>возвращает<span
style='mso-ansi-language:EN-US'> </span>экземпляр<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EqualityComparer</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:
EN-US'> </span>типа<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>T</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>Этот<span style='mso-ansi-language:EN-US'> </span>экземпляр<span
style='mso-ansi-language:EN-US'> </span>использует<span style='mso-ansi-language:
EN-US'> </span>метод<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Equals(T)</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>либо<span style='mso-ansi-language:
EN-US'> </span>метод<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Equals(</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>)</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:
EN-US'> </span>зависимости<span style='mso-ansi-language:EN-US'> </span>от<span
style='mso-ansi-language:EN-US'> </span>того<span lang=EN-US style='mso-ansi-language:
EN-US'>, </span>реализует<span style='mso-ansi-language:EN-US'> </span>ли<span
style='mso-ansi-language:EN-US'> </span>тип<span style='mso-ansi-language:EN-US'>
</span><span class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>T</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'> </span>интерфейс<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEquatable</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal>Ранее указывалось, что по умолчанию структуры реализуют
равенство по значению: две структуры равны, если равны значения всех их соответствующих
элементов. Интерфейс <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IStructuralEquatable</span></span>
позволяет перенести данную семантику на другие типы. На платформе .<span
lang=EN-US style='mso-ansi-language:EN-US'>NET</span><span lang=EN-US> </span>этот
интерфейс явно реализуют любые массивы и кортежи (классы вида <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Tuple</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;&gt;</span></span>).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>interface</span></span><span class=a3><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IStructuralEquatable</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>bool</span></span><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
Equals(</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> other, </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span class=a3><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> comparer);<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
GetHashCode(</span></span><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> comparer);<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>}<o:p></o:p></span></span></p>

<p class=MsoNormal>Передаваемый<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>метод<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>Equals()</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>объект<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>comparer</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>применяется<span style='mso-ansi-language:
EN-US'> </span>к<span style='mso-ansi-language:EN-US'> </span>каждому<span
style='mso-ansi-language:EN-US'> </span>индивидуальному<span style='mso-ansi-language:
EN-US'> </span>элементу<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>составном<span style='mso-ansi-language:
EN-US'> </span>объекте<span lang=EN-US style='mso-ansi-language:EN-US'>. </span>Следующий<span
style='mso-ansi-language:EN-US'> </span>пример<span style='mso-ansi-language:
EN-US'> </span>демонстрирует<span style='mso-ansi-language:EN-US'> </span>использование<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IStructuralEquatable</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] low = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;the quick brown
fox&quot;</span></span><span lang=EN-US>.Split();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] high = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;THE QUICK BROWN
FOX&quot;</span></span><span lang=EN-US>.Split();</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IStructuralEquatable</span></span><span
lang=EN-US> se = low;</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>переменная</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> f </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>равна</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> true<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> f = se.Equals(high, <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparer</span></span>.InvariantCultureIgnoreCase);</span></p>

<h1><a name="_Toc348862493">6. Сравнение для выяснения порядка</a></h1>

<p class=MsoNormal>Стандартным способом сравнения для выяснения порядка
является реализация типом интерфейсов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparable</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> CompareTo(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparable</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> T&gt;</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>CompareTo</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>T</span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>other</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Оба интерфейса предоставляют одинаковый функционал.
Универсальный интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IComparable</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> избавляет от
необходимости упаковки при работе с типами значений. Метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>x.CompareTo(y)</span></span> должен возвращать любое
положительное число, если <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>x</span></span> «больше» <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>y</span></span>, отрицательное число, если <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>x</span></span> «меньше» <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>y</span></span>, и ноль, если
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>x</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>y</span></span>
равны.</p>

<p class=MsoNormal>Базовые типы реализуют обе версии интерфейса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparable</span></span>. В
типе <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span>
метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CompareTo()</span></span>
выполняет чувствительное к регистру сравнение строк с учётом региональных
стандартов. В некоторых базовых типах дополнительно определён статический метод
сравнения <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Compare()</span></span>.
Например, <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span>
имеет перегруженные версии <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Compare()</span></span>, которые принимают или элемент перечисления
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparison</span></span>,
или булев флаг (игнорирование регистра) и объект <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CultureInfo</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> s1 = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Strasse&quot;</span></span><span
lang=EN-US>, s2 = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Stra&szlig;e&quot;</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>порядковое</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>сравнение</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, i = -108<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> i = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>.Compare(s1, s2, <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparison</span></span>.Ordinal);</span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>j</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>
= 0, так как в немецком языке такие слова равны<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> j = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>.Compare(s1, s2, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>false</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> CultureInfo(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;de-DE&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=MsoNormal>Кроме реализации <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparable</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> тип
может дополнительно перегружать операции <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span>. Перегрузка операций
сравнения обычно выполняется, если результат операции не зависит от контекста
выполнения<a style='mso-footnote-id:ftn5' href="#_ftn5" name="_ftnref5" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[5]</span></span><![endif]></span></span></a>.</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> isAfterDoomsday
= <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.Now &gt; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span>(2012, 12, 21);</span></p>

<p class=MsoNormal>Как и в случае проверки на равенство, сравнение для
выяснения порядка можно выполнить при помощи подключаемых интерфейсов. Для
порядкового сравнения предназначены интерфейсы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparer</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparer</span></span>
(пространства имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.Generic</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections</span></span>).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparer</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Compare(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> x, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> y);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparer</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Compare(T x,
T y);</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Существует<span style='mso-ansi-language:EN-US'> </span>абстрактный<span
style='mso-ansi-language:EN-US'> </span>класс<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>System.Collections.Generic.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Comparer</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>облегчающий<span style='mso-ansi-language:
EN-US'> </span>реализацию<span style='mso-ansi-language:EN-US'> </span>интерфейсов<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparer</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IComparer</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Wish</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public int</span></span><span lang=EN-US>
Priority { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>PriorityComparer</span></span> : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Comparer</span></span>&lt;<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Wish</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public override int</span></span><span
lang=EN-US> Compare(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Wish</span></span> x, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Wish</span></span>
y)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (Equals(x,
y))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>          
</span><span style='mso-spacerun:yes'> </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> 0;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
x.Priority.CompareTo(y.Priority);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Статическое<span style='mso-ansi-language:EN-US'> </span>свойство<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Comparer</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;.Default</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>возвращает<span
style='mso-ansi-language:EN-US'> </span>экземпляр<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Comparer</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:
EN-US'> </span>типа<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>T</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>Этот<span style='mso-ansi-language:EN-US'> </span>экземпляр<span
style='mso-ansi-language:EN-US'> </span>использует<span style='mso-ansi-language:
EN-US'> </span>метод<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>CompareTo(T)</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>либо<span style='mso-ansi-language:
EN-US'> </span>метод<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>CompareTo(</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>)</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>зависимости<span
style='mso-ansi-language:EN-US'> </span>от<span style='mso-ansi-language:EN-US'>
</span>того<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>реализует<span
style='mso-ansi-language:EN-US'> </span>ли<span style='mso-ansi-language:EN-US'>
</span>тип<span style='mso-ansi-language:EN-US'> </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>T</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>интерфейс<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparable</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal>Абстрактный класс <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparer</span></span>
предназначен для сравнения строк с учётом языка и регистра. Этот<span
style='mso-ansi-language:EN-US'> </span>класс<span style='mso-ansi-language:
EN-US'> </span>реализует<span style='mso-ansi-language:EN-US'> </span>интерфейсы<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparer</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>, </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparer</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEqualityComparer</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&gt;</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>Некоторые неабстрактные наследники <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparer</span></span>
доступны через его статические свойства. Например, свойство <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>StringComparer</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.CurrentCulture</span></span>
возвращает объект, реализующий сравнение строк с учётом текущих региональных
стандартов.</p>

<p class=MsoNormal>Интерфейс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Collections.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IStructuralComparable</span></span> позволяет
провести порядковое сравнение составных объектов, выполняя сравнение отдельных
элементов этих объектов. На платформе .<span lang=EN-US style='mso-ansi-language:
EN-US'>NET</span><span lang=EN-US> </span>этот интерфейс явно реализуют массивы
и кортежи.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>interface</span></span><span class=a3><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IStructuralComparable</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>{<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span class=a3><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> CompareTo(</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span class=a3><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> other, </span></span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IComparer</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> comparer);<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=a3><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>}<o:p></o:p></span></span></p>

<h1><a name="_Toc348862494">7. Жизненный цикл объектов</a></h1>

<p class=MsoNormal>Все типы платформы .NET делятся на ссылочные типы и типы
значений. Переменные типов значений создаются в стеке, их время жизни
ограничено тем блоком кода, в котором они объявляются. Например, если
переменная типа значения объявлена в некотором методе, то после выхода из
метода память в стеке, занимаемая переменной, автоматически освободится.
Переменные ссылочного типа (объекты) располагаются в динамической памяти – <span
class=a2>управляемой куче</span> (managed heap). Размещение объектов в
управляемой куче происходит последовательно. Для этого CLR поддерживает
указатель на свободное место в куче, перемещая его на соответствующее
количество байтов после выделения памяти очередному объекту.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_2"
 o:spid="_x0000_i1042" type="#_x0000_t75" style='width:461.25pt;height:195.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image002.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 1. Управляемая куча до (1) и после (2) выделения памяти под
объект <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>E</span></span>.</p>

<h2>7.1. Алгоритм сборки мусора</h2>

<p class=MsoNormal>Если новый объект требует для размещения больше памяти, чем
имеющийся свободный объем, CLR запускает процесс, называемый <span class=a2>сборка
мусора</span><a style='mso-footnote-id:ftn6' href="#_ftn6" name="_ftnref6"
title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:14.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[6]</span></span><![endif]></span></span></a>
(garbage collection). На первом этапе сборки мусора строится <span class=a2>граф
используемых объектов</span>. Отправными точками в построении графа являются <span
class=a2>корневые объекты</span>. Это объекты следующих категорий:</p>

<p class=MsoNormal>– локальная переменная или аргумент выполняемого метода (а
также всех методов в стеке вызова);</p>

<p class=MsoNormal>– статическое поле;</p>

<p class=MsoNormal>– объект в <span class=a2>очереди завершения</span> (этот
термин будет разъяснён позже).</p>

<p class=MsoNormal>При помощи графа используемых объектов выясняется реально
занимаемая этими объектами память. Затем происходит <span class=a2>дефрагментация
кучи</span> – используемые объекты перераспределяются так, чтобы занимаемая ими
память составляла единый блок в начале кучи. После этого сборка мусора
завершается, и новый объект размещается в управляемой куче.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_12"
 o:spid="_x0000_i1041" type="#_x0000_t75" style='width:443.25pt;height:324.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image003.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 2. Фазы сборки мусора: 1) инициирование, 2) выявление
используемых объектов, 3) дефрагментация, 4) размещение объекта.</p>

<p class=MsoNormal>При размещении и удалении объектов CLR использует ряд
оптимизаций. Во-первых, объекты размером 85000 и более байтов размещаются в
отдельной управляемой <span class=a2>куче больших объектов</span> (<span
lang=EN-US style='mso-ansi-language:EN-US'>Large</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Object</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Heap</span>). При сборке мусора
данная куча не дефрагментируется, так как копирование больших блоков памяти
снижает производительность. Во-вторых, в управляемой куче для малых объектов
выделяется три поколения – Gen0, Gen1 и Gen2. Вначале все объекты относятся к поколению
Gen0. После первой сборки мусора «пережившие» её объекты переходят в поколение
Gen1. В дальнейшем сборка мусора будет работать с объектами поколения <span
lang=EN-US style='mso-ansi-language:EN-US'>Gen</span>1, только если
освобождение памяти в <span lang=EN-US style='mso-ansi-language:EN-US'>Gen</span>0
дало неудовлетворительный результат. Если в <span lang=EN-US style='mso-ansi-language:
EN-US'>Gen</span>1 произошла сборка мусора, то «пережившие» её объекты
переходят в поколение Gen2. Отметим, что куча больших объектов всегда
рассматривается как куча объектов поколения <span lang=EN-US style='mso-ansi-language:
EN-US'>Gen</span>2.</p>

<p class=MsoNormal>Сборщик мусора представлен статическим классом <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GC</span></span>,
который обладает несколькими полезными методами (приведён неполный список):</p>

<p class=MsoNormal>1. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collect()</span></span>
– вызывает принудительную сборку мусора в программе.</p>

<p class=MsoNormal>2. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetGeneration()</span></span>
– возвращает номер поколения для указанного объекта;</p>

<p class=MsoNormal>3. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SuppressFinalize()</span></span>
– подавляет вызов финализатора для объекта;</p>

<p class=MsoNormal>4. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitForPendingFinalizers()</span></span>
– приостанавливает текущий поток выполнения до тех пор, пока не будут выполнены
все финализаторы освобождаемых объектов.</p>

<h2>7.2. Финализаторы и интерфейс IDisposable</h2>

<p class=MsoNormal>Обсудим автоматическую сборку мусора с точки зрения
программиста, разрабатывающего некий класс. С одной стороны, такой подход имеет
свои преимущества. В частности, практически исключаются случайные утечки
памяти, которые могут вызвать «забытые» объекты. Однако объект может в процессе
создания или работы резервировать неуправляемые системные ресурсы, которые
нужно освободить после того, как объект перестаёт использоваться. Примерами
таких ресурсов являются открытый операционной системой файл или сетевое подключение.
Платформа .NET предлагает подход, обеспечивающий автоматическое освобождение
ресурсов при уничтожении объекта. Тип <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Object</span></span> содержит
виртуальный метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Finalize()</span></span>.
Класс (но не структура!) может переопределить этот метод для освобождения неуправляемых
ресурсов. Объект такого класса обрабатывается особо при размещении в куче и при
сборке мусора. При размещении ссылка на объект запоминается в специальной
внутренней структуре CLR. При сборке мусора эта ссылка перемещается в <span
class=a2>очередь завершения</span> (freachable queue). Затем в отдельном
программном потоке у объектов из очереди завершения происходит вызов метода <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Finalize()</span></span>,
после этого ссылка на объект удаляется из очереди завершения.</p>

<p class=MsoNormal>Язык C# не позволяет явно переопределить в пользовательском
классе метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Finalize()</span></span>.
Вместо этого в классе описывается специальный <span class=a2>финализатор</span>.
Имя финализатора имеет вид <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>~</span></span><span class=af4><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>имя-класса</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>()</span></span>, он не имеет параметров и модификаторов доступа
(считается, что у него модификатор доступа <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>protected</span></span>). При наследовании в
финализатор класса-наследника автоматически подставляется вызов финализатора
класса-предка.</p>

<p class=MsoNormal>Приведём пример класса с финализатором:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ClassWithFinalizer</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
DoSomething()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;I am working...&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>~</span><span lang=EN-US>ClassWithFinalizer</span><span
style='mso-ansi-language:RU'>()<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
здесь должен быть код освобождения неуправляемых ресурсов<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Bye</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>!&quot;</span></span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Вызов метода <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Finalize()</span></span> является недетерминированным. Для
освобождения управляемых ресурсов (т. е. ресурсов платформы .NET) программист
может описать в классе некий метод, который следует вызывать вручную, когда
ресурс больше не нужен. Для унификации данного решения предлагается интерфейс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDisposable</span></span>
с единственным методом <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Dispose()</span></span>.
Если класс или структура реализуют этот интерфейс, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Dispose()</span></span> содержит код
освобождения управляемых ресурсов.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ClassWithDispose</span></span> : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IDisposable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
DoSomething()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;I am working...&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>Dispose</span><span
style='mso-ansi-language:RU'>()<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
здесь должен быть код освобождения управляемых ресурсов</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Bye</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>!&quot;</span></span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Язык C# имеет специальный оператор <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span>, который
гарантирует вызов метода <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Dispose()</span></span> для заданных переменных в конце блока кода.
Синтаксис оператора <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>using</span></span> следующий:</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>using</span></span><span style='mso-ansi-language:
RU'> (</span><span class=af4><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>получение-ресурса</span></span><span
style='mso-ansi-language:RU'>) </span><span class=af4><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>вложенный-оператор</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Здесь <span class=af4><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>получение-ресурса</span></span> означает один из вариантов.</p>

<p class=MsoNormal>1. Объявление и инициализацию локальной переменой (или
списка переменных). Тип переменной должен реализовывать <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDisposable</span></span>.
Такая переменная в блоке <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>using</span></span> доступна только для чтения.</p>

<p class=MsoNormal>2. Выражение, значение которого имеет тип, реализующий <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDisposable</span></span>.</p>

<p class=MsoNormal>Приведём пример использования оператора <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ClassWithDispose</span></span> x = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ClassWithDispose</span></span>())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>x.DoSomething();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>компилятор</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> C# </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>поместит</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>сюда</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>вызов</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> x.Dispose()<o:p></o:p></span></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h2>7.3. Слабые ссылки</h2>

<p class=MsoNormal><span class=a2>Слабая ссылка</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>weak</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>reference</span>) – особый вид
ссылки на объект в системах со сборкой мусора. Если на объект имеются только
слабые ссылки, он рассматривается алгоритмом сборки мусора как подлежащий
удалению.</p>

<p class=MsoNormal>В .NET слабые ссылки представлены классами <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>WeakReference</span></span><span
lang=EN-US> </span>и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WeakReference</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>T</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span>. Конструктор класса
принимает объект, на который создаётся слабая ссылка. Свойство <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Target</span></span> указывает на этот объект
или имеет значение <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span>, если объект был удалён сборщиком мусора.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> weak = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WeakReference</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StringBuilder</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Test&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (weak.IsAlive)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(weak.Target);<span
style='mso-spacerun:yes'>        </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// Test</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GC</span></span><span
lang=EN-US>.Collect();</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(weak.Target == </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
lang=EN-US>);<span style='mso-spacerun:yes'>    </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// True</span></span></p>

<p class=MsoNormal>Одно из применений слабых ссылок – построение кэшей больших
объектов. При кэшировании формируется слабая ссылка на объект. При доступе
проверяется свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Target</span></span>.
Если оно равно <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span>, объект повторно кэшируется.</p>

<h1><a name="_Toc348862495">8. Перечислители и итераторы</a></h1>

<p class=MsoNormal>Рассмотрим стандартный код, работающий с массивом. Вначале
массив инициализируется, затем печатаются все его элементы:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] data = {1, 2, 4, 8};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> item </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> data)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>item</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Данный код работоспособен по двум причинам. Во-первых, любой
массив относится к перечисляемым типам. Во-вторых, оператор <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span> знает,
как действовать с объектами перечисляемых типов. <span class=a2>Перечисляемый
тип</span> (<span lang=EN-US style='mso-ansi-language:EN-US'>enumerable</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>type</span>)
– это тип с экземплярным методом <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>GetEnumerator()</span></span>, возвращающим перечислитель. <span
class=a2>Перечислитель</span> (enumerator) – объект, обладающий свойством <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Current</span></span>,
представляющим текущий элемент набора, и методом <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MoveNext()</span></span> для перемещения к
следующему элементу. Оператор <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span> получает перечислитель,
вызывая метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetEnumerator()</span></span>,
а затем использует <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MoveNext()</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Current</span></span>
для итерации по набору.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// семантика работы оператора foreach из
предыдущего примера<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] data = {1, 2, 4, 8};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> enumerator = data.GetEnumerator();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>while</span></span><span
lang=EN-US> (enumerator.MoveNext())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> item = (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>)
enumerator.Current;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>item</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>В дальнейших примерах параграфа будет использоваться класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Shop</span></span>,
представляющий «магазин», который хранит некие «товары».</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private string</span></span><span lang=EN-US>[]
_items = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new string</span></span><span
lang=EN-US>[0];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public
int</span></span><span lang=EN-US> ItemsCount</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
_items.Length; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
AddItem(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> item)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span>.Resize(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ref</span></span><span lang=EN-US> _items,
ItemsCount + 1);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>_items[ItemsCount - 1] = item;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
GetItem(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
style='mso-ansi-language:RU'> _</span><span lang=EN-US>items</span><span
style='mso-ansi-language:RU'>[</span><span lang=EN-US>index</span><span
style='mso-ansi-language:RU'>];<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Пусть требуется сделать класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Shop</span></span>
перечисляемым. Для этого существует три способа:</p>

<p class=MsoNormal>1. Реализовать интерфейсы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>.</p>

<p class=MsoNormal>2. Реализовать интерфейсы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=MsoNormal>3. Способ, при котором стандартные интерфейсы не
применяются.</p>

<p class=MsoNormal>Интерфейсы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>
описаны в пространстве имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Collections</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span> GetEnumerator();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> Current {
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>MoveNext</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>void</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>Reset</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Свойство для чтения <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Current</span></span> представляет текущий
объект набора. Для обеспечения универсальности это свойство имеет тип <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span>.
Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MoveNext()</span></span>
выполняет перемещение на следующую позицию в наборе. Этот метод возвращает
значение <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span>,
если дальнейшее перемещение возможно. Предполагается, что <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MoveNext()</span></span> нужно вызвать и для
получения первого элемента, то есть начальная позиция – «перед первым
элементом». Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Reset()</span></span>
сбрасывает позицию в начальное состояние.</p>

<p class=MsoNormal>Добавим поддержку интерфейсов <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>
в класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Shop</span></span>.
Обратите внимание, что для этого используется вложенный класс, реализующий
интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>опущены</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элементы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> ItemsCount, AddItem(), GetItem()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ShopEnumerator</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private readonly string</span></span><span
lang=EN-US>[] _data; </span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>локальная</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>копия</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>данных</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private int</span></span><span lang=EN-US>
_position = -1;<span style='mso-spacerun:yes'>      </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>текущая</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>позиция</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>в</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>наборе</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US>
ShopEnumerator(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] values)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>_data = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new string</span></span><span lang=EN-US>[values.Length];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span>.Copy(values,
_data, values.Length);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public object</span></span><span lang=EN-US>
Current</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>get</span></span><span lang=EN-US> { </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> _data[_position]; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public bool</span></span><span lang=EN-US>
MoveNext()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>      
</span><span style='mso-spacerun:yes'>     </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>if</span></span><span lang=EN-US> (_position &lt; _data.Length - 1)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>_position++;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return false</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
Reset()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>_position = -1;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span> GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ShopEnumerator</span></span><span
style='mso-ansi-language:RU'>(_</span><span lang=EN-US>items</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Теперь класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span> можно использовать следующим
образом:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> shop = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>shop.AddItem(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;computer&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>shop.AddItem(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;monitor&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> s </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> shop)</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>    </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span></span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteLine</span><span style='mso-ansi-language:RU'>(</span><span
lang=EN-US>s</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>При записи цикла <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span> объявляется переменная,
тип которой совпадает с типом элемента коллекции. Так как свойство <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Current</span></span> имеет
тип <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span>,
то на каждой итерации выполняется приведение этого свойства к типу переменной
цикла<a style='mso-footnote-id:ftn7' href="#_ftn7" name="_ftnref7" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[7]</span></span><![endif]></span></span></a>.
Это может повлечь ошибки времени выполнения. Избежать ошибок помогает
реализация перечисляемого типа при помощи универсальных интерфейсов <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>out</span></span><span lang=EN-US> T&gt; : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>&lt;T&gt;
GetEnumerator();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>out</span></span><span lang=EN-US> T&gt; : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IDisposable</span></span>, <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>T Current { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Универсальные<span style='mso-ansi-language:EN-US'> </span>интерфейсы<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>наследуются<span
style='mso-ansi-language:EN-US'> </span>от<span style='mso-ansi-language:EN-US'>
</span>обычных<span style='mso-ansi-language:EN-US'> </span>версий<span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>У<span style='mso-ansi-language:
EN-US'> </span>интерфейса<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>типизированное<span style='mso-ansi-language:
EN-US'> </span>свойство<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Current</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Тип<span lang=EN-US style='mso-ansi-language:
EN-US'>, </span>реализующий<span style='mso-ansi-language:EN-US'> </span>интерфейс<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>должен<span
style='mso-ansi-language:EN-US'> </span>содержать<span style='mso-ansi-language:
EN-US'> </span>две<span style='mso-ansi-language:EN-US'> </span>версии<span
style='mso-ansi-language:EN-US'> </span>метода<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>GetEnumerator()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Обычно<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span><span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>.GetEnumerator()</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>применяется<span style='mso-ansi-language:
EN-US'> </span>явная<span style='mso-ansi-language:EN-US'> </span>реализация<span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>опущены</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элементы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> ItemsCount, AddItem(), GetItem()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ShopEnumerator</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private readonly string</span></span><span
lang=EN-US>[] _data;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private int</span></span><span lang=EN-US>
_position = -1;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US>
ShopEnumerator(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] values)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>_data = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new string</span></span><span lang=EN-US>[values.Length];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span>.Copy(values,
_data, values.Length);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Current</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>get</span></span><span lang=EN-US> { </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> _data[_position]; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span>.Current</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>get</span></span><span lang=EN-US> { </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> _data[_position]; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public bool</span></span><span lang=EN-US>
MoveNext()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>if</span></span><span lang=EN-US> (_position &lt; _data.Length - 1)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>_position++;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return false</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
Reset()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>_position = -1;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US> Dispose()
{ </span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>/* </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пустая</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>реализация</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> */</span></span><span lang=EN-US> }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span><span lang=EN-US>&gt; GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ShopEnumerator</span></span>(_items);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>.GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
GetEnumerator();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Возможна (хотя и нетипична) реализация перечисляемого типа
без использования стандартных интерфейсов:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>опущены</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элементы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> ItemsCount, AddItem(), GetItem()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ShopEnumerator</span></span> GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ShopEnumerator</span></span>(_items);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>class</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ShopEnumerator</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>    </span>//
реализация соответствует первому примеру,<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>    </span></span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>где</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
ShopEnumerator – </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>вложенный</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>класс</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Current { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US> { . . . } </span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>MoveNext</span><span
style='mso-ansi-language:RU'>() { . . . }<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Во всех предыдущих примерах для перечислителя создавался
пользовательский класс. Существуют альтернативные подходы к реализации
перечислителя. Так как перечисляемый тип обычно хранит свои данные в
стандартной коллекции или массиве, то обычно достаточно вернуть перечислитель
этой коллекции:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>опущены</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элементы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> ItemsCount, AddItem(), GetItem()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span> GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
_items.GetEnumerator();<span style='mso-spacerun:yes'>      </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>перечислитель</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>массива</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Создать перечислитель можно при помощи итератора. <span
class=a2>Итератор</span> (<span lang=EN-US style='mso-ansi-language:EN-US'>iterator</span>)&nbsp;–
это операторный блок, который порождает упорядоченную последовательность
значений. Итератор отличает присутствие одного или нескольких операторов <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>yield</span></span>.
Оператор <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>yield</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>выражение</span></span>
возвращает следующее значение последовательности, а оператор <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>yield</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>break</span></span> прекращает генерацию
последовательности. Итераторы могут использоваться в качестве тела метода, если
тип метода – один из интерфейсов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerator</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=MsoNormal>Реализуем метод <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.GetEnumerator()</span></span> при помощи
итератора.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>опущены</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элементы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> ItemsCount, AddItem(), GetItem()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span><span lang=EN-US>&gt; GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> s </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> _items)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>yield</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Как видим, код заметно упростился. Элементы коллекции
перебираются в цикле, и для каждого вызывается <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>yield</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> s</span></span>. Но
достоинства итераторов этим не ограничиваются. В следующем примере в класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Shop</span></span>
добавляется метод, позволяющий перебрать коллекцию в обратном порядке.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Shop</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>опущены</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элементы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>описанные</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ранее</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span><span lang=EN-US>&gt; GetItemsReversed()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>for</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> i =
_items.Length; i &gt; 0; i--)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>yield return</span></span><span lang=EN-US> _items[i - 1];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пример</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>использования</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> shop.GetItemsReversed())</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Итераторы реализуют концепцию <span class=a2>отложенных
вычислений</span>. Каждое выполнение оператора <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>yield</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span>
ведёт к выходу из метода и возврату значения. Но состояние метода, его
внутренние переменные и позиция <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>yield</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span>
запоминаются, чтобы быть восстановленными при следующем вызове.</p>

<p class=MsoNormal>Поясним концепцию отложенных вычислений на примере. Пусть
имеется класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Helper</span></span> с итератором <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetNumbers()</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>static class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Helper</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt; GetNumbers()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> i = 0;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>while</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>) </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>yield return</span></span><span lang=EN-US>
i++;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Кажется, что вызов метода <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetNumbers()</span></span> приведёт к
«зацикливанию» программы. Однако использование итераторов обеспечивает этому
методу следующее поведение. При первом вызове <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetNumbers()</span></span> вернёт значение <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>i = 0</span></span>, и
состояние метода (значение переменной <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>i</span></span>) будет зафиксировано. При
следующем вызове метод вернёт значение <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>i = 1</span></span> и снова зафиксирует своё состояние,
и так далее. Таким образом, следующий код успешно печатает три числа:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
style='mso-ansi-language:RU'> (</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>number</span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Helper</span></span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>GetNumbers</span><span style='mso-ansi-language:
RU'>())<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(number);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (number == 2)
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>break</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Рассмотрим ещё один пример итераторов. Пусть<span
style='mso-ansi-language:EN-US'> </span>описан<span style='mso-ansi-language:
EN-US'> </span>класс<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Range</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Range</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public int</span></span><span lang=EN-US> Low {
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public int</span></span><span lang=EN-US> High
{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt; GetNumbers()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>    
</span><span style='mso-spacerun:yes'>   </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>for</span></span><span lang=EN-US> (</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US> counter = Low; counter &lt;=
High; counter++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>yield return</span></span><span lang=EN-US> counter;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Используем<span style='mso-ansi-language:EN-US'> </span>класс<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Range</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>следующим<span style='mso-ansi-language:
EN-US'> </span>образом<span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> range = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Range</span></span> {Low = 0, High = 10};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> enumerator = range.GetNumbers();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> number </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> enumerator)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>number</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>На консоль будут выведены числа от 0 до 10. Интересно, что
если изменить объект <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>range</span></span>
<span class=a2>после</span> получения перечислителя <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>enumerator</span></span>, это повлияет на
выполнение цикла <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>foreach</span></span>. Следующий код выводит числа от 0 до 5.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>range</span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Range</span></span><span style='mso-ansi-language:RU'> {</span><span
lang=EN-US>Low</span><span style='mso-ansi-language:RU'> = 0, </span><span
lang=EN-US>High</span><span style='mso-ansi-language:RU'> = 10};<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> enumerator = range.GetNumbers();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>range.High = 5;<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>изменяем</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>свойство</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>объекта</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> range</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> number </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> enumerator)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>number</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Возможности итераторов широко используются в технологии LINQ
<span lang=EN-US style='mso-ansi-language:EN-US'>to</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Objects</span>, которая будет
описана далее.</p>

<h1><a name="_Toc348862496">9. Стандартные интерфейсы коллекций</a></h1>

<p class=MsoNormal>Платформа .NET включает большой набор типов для
предоставления стандартных коллекций – списков, множеств, словарей. Эти типы
можно разделить на несколько категорий: базовые интерфейсы и вспомогательные
классы, классы для коллекций-списков и словарей, набор классов для построения
собственных коллекций. Типы сгруппированы в следующие пространства имён:</p>

<p class=MsoNormal>1. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections</span></span>
– коллекции, в которых элемент коллекции представлен как <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span> (<span
class=a2>слаботипизированные коллекции</span>).</p>

<p class=MsoNormal>2. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.Specialized</span></span>
– специальные коллекции.</p>

<p class=MsoNormal>3. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.Generic</span></span>
– универсальные классы и интерфейсы коллекций.</p>

<p class=MsoNormal>4. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.ObjectModel</span></span>
– базовые и вспомогательные типы, которые могут применяться для построения
пользовательских коллекций.</p>

<p class=MsoNormal>5. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections.Concurrent</span></span>
– коллекции для использования в многопоточных приложениях.</p>

<p class=MsoNormal>Опишем набор интерфейсов, реализуемых практически всеми типами
коллекций. Основу набора составляют интерфейсы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>.
Они отражают фундаментальное свойство любой коллекции – возможность перечислить
её элементы. Слаботипизированные словари реализуют интерфейс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDictionaryEnumerator</span></span>
для перебора пар «ключ-значение» (<span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DictionaryEntry</span></span> –вспомогательная
структура, у которой определены свойства <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Key</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Value</span></span>).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IDictionaryEnumerator</span></span> : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DictionaryEntry</span></span> Entry { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> Key { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> Value { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span><span lang=EN-US> </span>предназначен
для коллекций, запоминающих число хранимых элементов. Этот интерфейс определяет
свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Count</span></span>,
а также метод для копирования коллекции в массив и свойства для синхронизации
коллекции при многопоточном использовании.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>метод</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> CopyTo(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Array</span></span> array, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойства</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Count { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>
IsSynchronized { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>SyncRoot</span><span
style='mso-ansi-language:RU'> { </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
style='mso-ansi-language:RU'>; }<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Универсальный интерфейс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> также поддерживает
свойство для количества элементов. Кроме этого, он предоставляет методы для
добавления и удаления элементов, копирования элементов в массив, поиска
элемента.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span>&lt;T&gt; : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Add(T
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Clear();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Contains(T
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> CopyTo(T[]
array, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> arrayIndex);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Remove(T
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойства</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Count { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>IsReadOnly</span><span
style='mso-ansi-language:RU'> { </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
style='mso-ansi-language:RU'>; }<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IList</span></span> описывает набор данных,
которые проецируются на массив. Дополнительно к функциональности,
унаследованной от <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span>, интерфейс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span>
позволяет обращаться к элементу по индексу, добавлять, удалять и искать
элементы.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IList</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ICollection</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Add(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Clear();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Contains(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> IndexOf(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Insert(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> index, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Remove(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> RemoveAt(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> index);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойства</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> IsFixedSize
{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> IsReadOnly
{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US>[</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> index] { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Возможности интерфейса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IList</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> тождественны
возможностям <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IList</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IList</span></span>&lt;T&gt; : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ICollection</span></span>&lt;T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> IndexOf(T
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Insert(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> index, T
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> RemoveAt(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> index);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойство</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>T </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US>[</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index] { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>В качестве примера работы с интерфейсом <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
рассмотрим метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Permutate()</span></span>,
генерирующий все перестановки указанного набора данных.</p>

<p class=aCxSpFirst><a name="OLE_LINK2"></a><a name="OLE_LINK1"><span
style='mso-bookmark:OLE_LINK2'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public
static</span></span><span lang=EN-US> <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IList</span></span>&lt;T&gt;&gt; Permutate&lt;T&gt;(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span>&lt;T&gt;
sequence,</span></span></a></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>                                                
</span></span></span></span><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> count)</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (count == 1)</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>yield return</span></span><span lang=EN-US>
sequence;</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>else</span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>for</span></span><span lang=EN-US> (</span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> i = 0; i
&lt; count; i++)</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (</span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> perm </span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US>
Permutate(sequence, count - 1))</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>yield return</span></span><span lang=EN-US>
perm;</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>циклический</span></span></span></span><span style='mso-bookmark:
OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> </span></span></span></span><span style='mso-bookmark:
OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>сдвиг</span></span></span></span><span
style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:OLE_LINK2'><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> sequence<o:p></o:p></span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>T last = sequence[count - 1];</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>sequence.RemoveAt(count - 1);</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>sequence.Insert(0, last);</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK1'><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>}</span></span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK1'><span style='mso-bookmark:
OLE_LINK2'><span lang=EN-US>}</span></span></span></p>

<span style='mso-bookmark:OLE_LINK2'></span><span style='mso-bookmark:OLE_LINK1'></span>

<p class=MsoNormal>Интерфейсы<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDictionary</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IDictionary</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;TKey, TValue&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>определяют<span
style='mso-ansi-language:EN-US'> </span>протокол<span style='mso-ansi-language:
EN-US'> </span>взаимодействия<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>коллекций<span lang=EN-US
style='mso-ansi-language:EN-US'>-</span>словарей<span lang=EN-US
style='mso-ansi-language:EN-US'> (</span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>KeyValuePair</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;TKey,
TValue&gt;</span></span><span lang=EN-US style='mso-ansi-language:EN-US'> – </span>это<span
style='mso-ansi-language:EN-US'> </span>вспомогательная<span style='mso-ansi-language:
EN-US'> </span>структура<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>у<span
style='mso-ansi-language:EN-US'> </span>которой<span style='mso-ansi-language:
EN-US'> </span>определены<span style='mso-ansi-language:EN-US'> </span>свойства<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Key</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>Value</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>).<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IDictionary</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ICollection</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Add(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> key, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Clear();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Contains(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> key);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IDictionaryEnumerator</span></span>
GetEnumerator();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Remove(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> key);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойства</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> IsFixedSize
{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> IsReadOnly
{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US>[</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> key] { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span> Keys { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }<span
style='mso-spacerun:yes'>        </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>все</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ключи</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>словаря</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span> Values { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }<span
style='mso-spacerun:yes'>      </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>все</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>значения</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>словаря</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IDictionary</span></span>&lt;TKey, TValue&gt; :</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ICollection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>KeyValuePair</span></span>&lt;TKey, TValue&gt;&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Add(TKey
key, TValue value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>
ContainsKey(TKey key);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US> Remove(TKey
key);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>
TryGetValue(TKey key, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>out</span></span><span
lang=EN-US> TValue value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойства</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>TValue </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US>[TKey key] { </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span>&lt;TKey&gt; Keys { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span>&lt;TValue&gt; Values
{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для работы с коллекциями-множествами предназначен интерфейс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ISet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. Его
набор методов отражает типичные операции для множеств.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>interface</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ISet</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; : </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ICollection</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>Add(T
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void </span></span><span lang=EN-US>ExceptWith(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void </span></span><span lang=EN-US>IntersectWith(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>IsProperSubsetOf(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>IsProperSupersetOf(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>IsSubsetOf(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>IsSupersetOf(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>Overlaps(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool </span></span><span lang=EN-US>SetEquals(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void </span></span><span lang=EN-US>SymmetricExceptWith(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void </span></span><span lang=EN-US>UnionWith(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; other);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для взаимодействия с коллекциями, предназначенными только
для чтения, в платформе .NET версии 4.5 введён интерфейс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IReadOnlyList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. Он
позволяет узнать число хранимых элементов и получить элемент по индексу.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IReadOnlyList</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>out</span></span><span lang=EN-US> T&gt; : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>свойства</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Count { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>T </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US>[</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index] { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Рис. 3 демонстрирует связи между интерфейсами коллекций.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_4"
 o:spid="_x0000_i1040" type="#_x0000_t75" style='width:474pt;height:207.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image004.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 3. Стандартные интерфейсы коллекций.</p>

<h1><a name="_Toc348862497">10. Массивы и класс </a><span style='mso-bookmark:
_Toc348862497'><span lang=EN-US style='mso-ansi-language:EN-US'>System</span>.</span><span
style='mso-bookmark:_Toc348862497'><span lang=EN-US style='mso-ansi-language:
EN-US'>Array</span></span></h1>

<p class=MsoNormal>Класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span> является базовым классом
для любого массива. Любой массив реализует интерфейсы <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IStructuralEquatable</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IStructuralComparable</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
причём первые три интерфейса реализованы явно (методы <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Add()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Remove()</span></span> генерируют исключение в
случае коллекции фиксированной длины, которой является массив). В табл. 6
описаны экземплярные элементы любого массива, а табл. 7 содержит статические
методы класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Array</span></span>.</p>

<p class=ae>Таблица 6</p>

<p class=af>Экземплярные элементы массива</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td width="77%" style='width:77.52%;border:solid windowtext 1.0pt;border-left:
  none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Rank</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, возвращает размерность массива</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Length</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, возвращает общее число элементов массива</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LongLength</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, число элементов. Имеет тип <span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>long</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CopyTo()</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод копирует фрагмент массива в другой массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetLength()</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод возвращает число элементов в указанном измерении</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetLowerBound()</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод возвращает нижнюю границу для указанного измерения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetUpperBound()</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод возвращает верхнюю границу для указанного измерения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetValue()</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод возвращает значение элемента с указанными индексами</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;mso-yfti-lastrow:yes'>
  <td width="22%" style='width:22.48%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>SetValue()</span></span></p>
  </td>
  <td width="77%" style='width:77.52%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод устанавливает значение элемента с указанными индексами</p>
  </td>
 </tr>
</table>

</div>

<p class=ae>Таблица 7</p>

<p class=af>Статические методы класса <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя метода</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Sort()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Сортирует массив, переданный в качестве аргумента (возможно, с применением
  собственного объекта для сравнения элементов)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>BinarySearch()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Поиска элемента в отсортированном массиве</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IndexOf()</span></span>,</p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastIndexOf()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращается индекс первого (последнего) вхождения элемента в
  одномерный массив или фрагмент массива. Если элемент в массив не входит,
  возвращается значение, на единицу меньше нижней границы индекса</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Exists()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Определяет, содержит ли массив хотя бы один элемент,
  удовлетворяющий предикату, который задан аргументом метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Find()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает первый элемент, удовлетворяющий предикату, который
  задан аргументом метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindLast()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает первый элемент с конца массива, удовлетворяющий
  предикату, который задан аргументом метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindAll()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает все элементы, удовлетворяющие предикату, который
  задан аргументом метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindIndex()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает индекс первого вхождения элемента, удовлетворяющего
  предикату, заданному как аргумент метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindLastIndex()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает индекс последнего вхождения элемента,
  удовлетворяющего предикату, заданному как аргумент метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ConvertAll()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Конвертирует массив одного типа в массив другого типа</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ForEach()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Выполняет указанное действие для всех элементов массива</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrueForAll()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если заданный предикат верен для всех элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Clear()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Устанавливает для массива или его части значение по умолчанию
  для типа элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Reverse()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Меняет порядок элементов в одномерном массиве или его части на
  противоположный</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>AsReadOnly()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт на основе массива коллекцию, не допускающую модификации
  своих элементов (<span lang=EN-US style='mso-ansi-language:EN-US'>read</span>-<span
  lang=EN-US style='mso-ansi-language:EN-US'>only</span><span lang=EN-US> </span><span
  lang=EN-US style='mso-ansi-language:EN-US'>collection</span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CreateInstance()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт экземпляр массива любого типа, размерности и длины</p>
  </td>
 </tr>
</table>

</div>

<p class=ae>Окончание табл. 7</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя метода</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Copy()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Копирует раздел одного массива в другой массив, выполняя
  приведение типов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ConstrainedCopy()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод подобен <span class=af3><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Copy()</span></span>,
  но если приведение типов для элементов неудачно, выполняется отмена операции
  копирования</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Resize()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Позволяет изменить размер массива</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Рассмотрим несколько примеров использования методов массива.
В первом примере создадим массив и выполним работу с его элементами, не
применяя традиционный синтаксис C#.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
lang=EN-US> a = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span>.CreateInstance(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>),
2);<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>  </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>тип</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>, </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>длина</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>a.SetValue(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;hi&quot;</span></span><span lang=EN-US>, 0);<span
style='mso-spacerun:yes'>                  </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// a[0] = &quot;hi&quot;;</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>a.SetValue(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;there&quot;</span></span><span lang=EN-US>, 1);<span
style='mso-spacerun:yes'>               </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// a[1] = &quot;there&quot;;</span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> s = (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>) a.GetValue(0);<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// s = a[0];</span></span></p>

<p class=MsoNormal>Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CreateInstance()</span></span> может создать массив любой
размерности с указанным диапазоном изменения индексов:</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// b
– </span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>это</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>массив</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> int[-5..4, 100..119]<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><a name="OLE_LINK4"></a><a name="OLE_LINK3"><span
style='mso-bookmark:OLE_LINK4'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> b = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span>.CreateInstance(</span></span></a><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (</span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>), <span
style='mso-spacerun:yes'>    </span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>тип</span></span></span></span><span style='mso-bookmark:OLE_LINK3'><span
style='mso-bookmark:OLE_LINK4'><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элемента</span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK3'><span
style='mso-bookmark:OLE_LINK4'><span lang=EN-US><span
style='mso-spacerun:yes'>                             </span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
style='mso-ansi-language:RU'>[] {10, 20}, <span
style='mso-spacerun:yes'>  </span></span></span></span><span style='mso-bookmark:
OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
длины размерностей</span></span></span></span><span style='mso-bookmark:OLE_LINK3'><span
style='mso-bookmark:OLE_LINK4'><span style='mso-ansi-language:RU'><o:p></o:p></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK3'><span
style='mso-bookmark:OLE_LINK4'><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                             </span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
style='mso-ansi-language:RU'>[] {-5, 100}); </span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// нижние границы</span></span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
style='mso-ansi-language:RU'><o:p></o:p></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK3'><span
style='mso-bookmark:OLE_LINK4'><span lang=EN-US>b.SetValue(25, -3, 110);</span></span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> x = (</span></span></span><span
style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:OLE_LINK4'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>)
b.GetValue(-2, 115);</span></span></span></p>

<span style='mso-bookmark:OLE_LINK4'></span><span style='mso-bookmark:OLE_LINK3'></span>

<p class=MsoNormal>Группа статических методов класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span> позволяет
выполнить сортировку и поиск данных в массиве. Методы поиска могут использовать
заданные предикаты, а сортировка – выполняться по заданному критерию сравнения.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
style='mso-ansi-language:RU'>[] </span><span lang=EN-US>a</span><span
style='mso-ansi-language:RU'> = {10, 3, 5, -7, 0, 20, 10, 4};<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// поиск элемента по предикату</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> b = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span>.Find(a, x =&gt; x &gt; 6);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// поиск всех элементов</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
style='mso-ansi-language:RU'>[] </span><span lang=EN-US>c</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>FindAll</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>a</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>x</span><span
style='mso-ansi-language:RU'> =&gt; </span><span lang=EN-US>x</span><span
style='mso-ansi-language:RU'> &gt; 6);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// действие над элементами</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
lang=EN-US>.ForEach(c, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>проверка</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>условия</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> flag = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span>.TrueForAll(a, x =&gt; x
&gt; 0); </span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>сортировка</span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
lang=EN-US>.Sort(a, (x, y) =&gt; x == y ? 0 : x &gt; y ? -1 : 1);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>двоичный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>поиск</span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> pos = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Array</span></span>.BinarySearch(a, 3);<span
style='mso-spacerun:yes'>                </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>двоичный</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>поиск</span></span></p>

<p class=MsoNormal>Массивы допускают копирование элементов и изменение размера:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] a = {10, 3, 5, -7, 0, 20, 10, 4};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] b = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new int</span></span><span
lang=EN-US>[a.Length];</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>long</span></span><span
lang=EN-US>[] c = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new long</span></span><span
lang=EN-US>[a.Length];</span></p>

<p class=aCxSpMiddle><span lang=EN-US>a.CopyTo(b, 0);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
lang=EN-US>.Copy(a, c, a.Length);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Array</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Resize</span><span
style='mso-ansi-language:RU'>(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ref</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>a</span><span
style='mso-ansi-language:RU'>, 40);<o:p></o:p></span></p>

<p class=MsoNormal>Заметим, что для быстрого копирования массивов с элементами
типа значений можно использовать класс <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Buffer</span></span>. Он
оперирует байтами данных.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] a = {10, 3, 5, -7, 0, 20, 10, 4};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] b = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new int</span></span><span
lang=EN-US>[a.Length];</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Buffer</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>BlockCopy</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>a</span><span
style='mso-ansi-language:RU'>, 3, </span><span lang=EN-US>b</span><span
style='mso-ansi-language:RU'>, 5, 10);<span style='mso-spacerun:yes'>   
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// смещение задано в байтах</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<h1><a name="_Toc348862498">11. Типы для работы с коллекциями-списками</a></h1>

<p class=MsoNormal>Рассмотрим типы из базовой библиотеки платформы .NET,
применяемые при работе с коллекциями со списковой семантикой.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> из пространства имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Collections.Generic</span></span> – основной
класс для представления наборов, которые допускают динамическое добавление
элементов<a style='mso-footnote-id:ftn8' href="#_ftn8" name="_ftnref8" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[8]</span></span><![endif]></span></span></a>.
Для хранения данных набора используется внутренний массив. Класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
реализует интерфейсы <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IList</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span>, <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IList</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IReadOnlyList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. В
табл. 8 представлено описание <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span>-элементов класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=ae>Таблица 8</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="21%" valign=top style='width:21.24%;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Элемент</p>
  </td>
  <td width="78%" valign=top style='width:78.76%;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="100%" colspan=2 style='width:100.0%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавление и удаление элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Add()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавление одного элемента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>AddRange()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавление набора элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Insert()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Вставка элемента в заданную позицию</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>InsertRange()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Вставка набора элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Remove()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Удаление элемента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>RemoveAt()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Удаление элемента на указанной позиции со сдвигом остальных</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>RemoveRange()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Удаление диапазона элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>RemoveAll()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Удаление всех элементов, удовлетворяющих заданному предикату</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width="100%" colspan=2 style='width:100.0%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Индексирование элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>this</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>[</span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> index]</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Основной индексатор</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetRange()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получение подсписка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetEnumerator()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получение перечислителя</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width="100%" colspan=2 style='width:100.0%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Поиск и сортировка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>BinarySearch()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Поиск элемента в упорядоченном наборе</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IndexOf()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Индекс первого вхождения своего аргумента в набор</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17;mso-yfti-lastrow:yes'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastIndexOf()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Индекс последнего вхождения своего аргумента в набор</p>
  </td>
 </tr>
</table>

</div>

<p class=ae>Окончание табл. 8</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="21%" valign=top style='width:21.24%;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Элемент</p>
  </td>
  <td width="78%" valign=top style='width:78.76%;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Contains()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Проверка, содержится ли указанный элемент в наборе</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Exists()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Проверка, содержит ли набор элемент, удовлетворяющий предикату</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Find()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает первый элемент, удовлетворяющий предикату, который
  задан как аргумент метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindLast()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает первый элемент с конца набора, удовлетворяющий
  предикату, который задан как аргумент метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindAll()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает все элементы набора, удовлетворяющие предикату</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindIndex()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает индекс первого вхождения элемента, удовлетворяющего
  предикату, который задан как аргумент метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindLastIndex()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает индекс последнего вхождения элемента,
  удовлетворяющего предикату, который задан как аргумент метода</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrueForAll()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если заданный предикат верен для всех элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Sort()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Сортировка набора (возможно, с применением собственного объекта
  для сравнения элементов)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width="100%" colspan=2 style='width:100.0%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Экспорт и конвертирование элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToArray()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразование набора в массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CopyTo()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Копирование набора или его части в массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>AsReadOnly()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразование набора в коллекцию только для чтения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ConvertAll()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Конвертирование набора одно типа в набор другого типа</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width="100%" colspan=2 style='width:100.0%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Другие методы и свойства</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Count</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Количество элементов в наборе</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Capacity</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Ёмкость набора</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrimExcess()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Усечение размера внутреннего массива до необходимой минимальной
  величины</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Clear()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Очистка списка (удаление всех элементов)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Reverse()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Изменение порядка элементов на противоположный</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:21;mso-yfti-lastrow:yes'>
  <td width="21%" style='width:21.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ForEach()</span></span></p>
  </td>
  <td width="78%" style='width:78.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Выполняет указанное действие для всех элементов списка</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> имеет три конструктора. Первый из них –
обычный конструктор без параметров. Второй конструктор позволяет создать набор
на основе коллекции – производится копирование элементов коллекции в список.
Третий конструктор принимает в качестве аргумента начальную ёмкость набора. <span
class=a2>Ёмкость набора</span> (<span lang=EN-US style='mso-ansi-language:EN-US'>capacity</span>)
– это количество элементов набора, которое он способен содержать без увеличения
размера внутреннего массива.</p>

<p class=MsoNormal>Следующий код демонстрирует использование некоторых свойств
и методов класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span>. Обратите внимание, что для добавления
элементов в созданный набор применяется возможность инициализации
классов-коллекций.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>&gt; words = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span><span lang=EN-US>&gt; {</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;melon&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;avocado&quot;</span></span><span
lang=EN-US>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US>words.AddRange(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US>[] {</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;banana&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;plum&quot;</span></span><span lang=EN-US>});</span></p>

<p class=aCxSpMiddle><span lang=EN-US>words.Insert(0, </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;lemon&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>words.InsertRange(0, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US>[] {</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;peach&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;apple&quot;</span></span><span
lang=EN-US>});</span></p>

<p class=aCxSpMiddle><span lang=EN-US>words.Remove(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;melon&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>words.RemoveAt(3);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>words.RemoveAll(s =&gt; s.StartsWith(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;a&quot;</span></span><span lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>&gt; subset = words.GetRange(1, 2);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] wordsArray = words.ToArray();</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>&gt; lengths = words.ConvertAll&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt;(s =&gt; s.Length);</span></p>

<p class=MsoNormal>На примере <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> рассмотрим особенность,
присущую использованию коллекций в языке <span lang=EN-US style='mso-ansi-language:
EN-US'>C</span>#. Если коллекция хранит структуры, то <span lang=EN-US
style='mso-ansi-language:EN-US'>C</span># не позволяет изменить части структуры
при помощи индексатора коллекции (так как индексатор является функцией,
возвращающей <span class=a2>копию</span> элемента коллекции):</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public struct</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> list = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>&gt;
{</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span> {Name = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Ivanov&quot;</span></span><span lang=EN-US>}};</span></p>

<p class=aCxSpLast><span lang=EN-US>list[0].Name = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Petrov&quot;</span></span><span lang=EN-US>;<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ошибка</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>компиляции</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>!</span></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LinkedList</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> служит для представления двусвязного
списка. Такой список позволяет осуществлять вставку и удаление элемента без
сдвига остальных элементов. Однако доступ к элементу по индексу требует прохода
по списку. <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>LinkedList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
реализует интерфейсы <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ICollection</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ICollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. Каждый элемент
двусвязного списка представлен объектом <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public sealed class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LinkedList</span></span><span class=a3><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span>
List { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LinkedListNode</span></span>&lt;T&gt; Next { </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LinkedListNode</span></span>&lt;T&gt; Previous { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> T Value {
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>При добавлении элемента можно указать, чтобы он помещался в
начало списка, или в конец списка, или относительно существующего в списке
элемента. Для этого класс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedList</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> содержит специальные
методы:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>AddFirst</span><span
style='mso-ansi-language:RU'>(</span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>node</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span><span lang=EN-US>&lt;T&gt;
AddFirst(T value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> <span class=a3><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>AddLast</span></span>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LinkedListNode</span></span>&lt;T&gt; node);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span><span lang=EN-US>&lt;T&gt;
AddLast(T value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> AddAfter(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt; node,</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>       </span></span></span><span lang=EN-US><span
style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'> </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt;
newNode);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span><span lang=EN-US>&lt;T&gt;
AddAfter(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt; node, T
value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> AddBefore(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt; node,</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>       </span></span></span><span lang=EN-US><span
style='mso-spacerun:yes'>              </span><span
style='mso-spacerun:yes'> </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt;
newNode);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span><span lang=EN-US>&lt;T&gt;
AddBefore(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt; node, T
value);</span></p>

<p class=MsoNormal>Аналогичные методы существуют и для удаления элементов
списка:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> RemoveFirst();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> RemoveLast();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public bool</span></span><span
lang=EN-US> Remove(T value);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> Remove(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedListNode</span></span>&lt;T&gt; node);</span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LinkedList</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> содержит свойства для числа элементов, для
указания на первый и последний элемент. Имеются методы для поиска элементов.</p>

<p class=MsoNormal>Ниже приведён пример использования <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>LinkedList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> tune = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LinkedList</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>&gt;();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.AddFirst(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;do&quot;</span></span><span lang=EN-US>);<span
style='mso-spacerun:yes'>                       </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// do</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.AddLast(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;so&quot;</span></span><span lang=EN-US>);<span
style='mso-spacerun:yes'>                        </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// do - so</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.AddAfter(tune.First, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;re&quot;</span></span><span lang=EN-US>);<span
style='mso-spacerun:yes'>           </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// do - re- so</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.AddAfter(tune.First.Next, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;mi&quot;</span></span><span lang=EN-US>);<span
style='mso-spacerun:yes'>      </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// do - re - mi- so</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.AddBefore(tune.Last, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;fa&quot;</span></span><span lang=EN-US>);<span
style='mso-spacerun:yes'>           </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// do - re - mi - fa- so</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.RemoveFirst();<span
style='mso-spacerun:yes'>                        </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// re - mi - fa - so</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.RemoveLast();<span
style='mso-spacerun:yes'>                         </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// re - mi - fa</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> miNode = tune.Find(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;mi&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>tune.Remove(miNode);<span
style='mso-spacerun:yes'>                       </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// re - fa</span></span></p>

<p class=aCxSpLast><span lang=EN-US>tune.AddFirst(miNode);<span
style='mso-spacerun:yes'>                     </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// mi - re - fa</span></span></p>

<p class=MsoNormal>Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Queue</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stack</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
реализуют структуры данных «очередь» и «стек» на основе массива<a
style='mso-footnote-id:ftn9' href="#_ftn9" name="_ftnref9" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[9]</span></span><![endif]></span></span></a>.
Конструкторы этих классов, как и конструкторы класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
позволяют создать объект на основе другой коллекции, а также указать значение
для ёмкости (но ёмкость не доступна в виде отдельного свойства). Элементы
классов вполне предсказуемы и описаны в табл. 9 и табл. 10.</p>

<p class=ae>Таблица 9</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Queue</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Элемент</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Clear()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Очистка очереди (удаление всех элементов)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Contains()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Проверка, содержится ли указанный элемент в очереди</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CopyTo()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Копирование очереди в массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Count</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Количество элементов (свойство только для чтения)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Dequeue()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Извлечение элемента из очереди</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Enqueue()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Помещение элемента в очередь</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetEnumerator()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получение перечислителя</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Peek()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Чтение очередного элемента без его удаления из очереди</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToArray()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразование очереди в массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrimExcess()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Усечение размера внутреннего массива до необходимой минимальной
  величины</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=ae>Таблица 10</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stack</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Элемент</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Clear()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Очистка стека (удаление всех элементов)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Contains()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Проверка, содержится ли указанный элемент в стеке</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CopyTo()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Копирование стека в массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Count</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Количество элементов (свойство только для чтения)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetEnumerator()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получение перечислителя</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Peek()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Чтение очередного элемента без его удаления из стека</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Pop()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Извлечение элемента из стека</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Push()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Помещение элемента в стек</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ToArray()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразование стека в массив</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TrimExcess()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Усечение размера внутреннего массива до необходимой минимальной
  величины</p>
  </td>
 </tr>
</table>

</div>

<h1><a name="_Toc348862499">12. Типы для работы с коллекциями-множествами</a></h1>

<p class=MsoNormal>В библиотеке базовых классов платформы .NET имеются два
класса для представления множеств (то есть коллекций, которые не содержат
повторяющихся элементов) – <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>HashSet</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. Оба
класса реализуют интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ISet</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>HashSet</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> описывает множество, в котором вхождение
элемента проверяется на основе хэш-кода. Конструкторы класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>HashSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
позволяют создать множество на основе коллекции, а также указать объект,
реализующий интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEqualityComparer</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> для проверки равенства
элементов множества. Кроме реализации интерфейса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ISet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>HashSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
содержит экземплярный метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>RemoveWhere()</span></span> для удаления элементов, удовлетворяющих
заданному предикату. Статический метод <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CreateSetComparer()</span></span> возвращает
экземпляр класса, реализующего <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>HashSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;&gt;</span></span>.</p>

<p class=MsoNormal>Следующий пример показывает использование <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>HashSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>:</p>

<p class=aCxSpFirst><a name="OLE_LINK5"><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> setOne = </span></a><span style='mso-bookmark:OLE_LINK5'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>HashSet</span></span>&lt;</span></span><span style='mso-bookmark:
OLE_LINK5'><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>char</span></span><span lang=EN-US>&gt;(</span></span><span
style='mso-bookmark:OLE_LINK5'><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;the
quick brown fox&quot;</span></span><span lang=EN-US>);</span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK5'><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>var</span></span><span lang=EN-US> setTwo = </span></span><span
style='mso-bookmark:OLE_LINK5'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>HashSet</span></span>&lt;</span></span><span
style='mso-bookmark:OLE_LINK5'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span><span
lang=EN-US>&gt;(</span></span><span style='mso-bookmark:OLE_LINK5'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;jumps over the lazy dog&quot;</span></span><span
lang=EN-US>);</span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK5'><span lang=EN-US>setOne.IntersectWith(setTwo);<span
style='mso-spacerun:yes'>               </span></span></span><span
style='mso-bookmark:OLE_LINK5'><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span></span><span style='mso-bookmark:
OLE_LINK5'><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>результат</span></span></span><span
style='mso-bookmark:OLE_LINK5'><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> = the uro</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK5'><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span><span lang=EN-US>.WriteLine(setOne.Contains(</span></span><span
style='mso-bookmark:OLE_LINK5'><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>'t'</span></span><span
lang=EN-US>));<span style='mso-spacerun:yes'>    </span></span></span><span
style='mso-bookmark:OLE_LINK5'><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// True</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK5'><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span><span lang=EN-US>.WriteLine(setOne.Contains(</span></span><span
style='mso-bookmark:OLE_LINK5'><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>'j'</span></span><span
lang=EN-US>));<span style='mso-spacerun:yes'>    </span></span></span><span
style='mso-bookmark:OLE_LINK5'><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// False</span></span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK5'><span lang=EN-US>setTwo.RemoveWhere(c
=&gt; c &lt; </span></span><span style='mso-bookmark:OLE_LINK5'><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>'k'</span></span><span lang=EN-US>);</span></span></p>

<span style='mso-bookmark:OLE_LINK5'></span>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SortedSet</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> – это множество, поддерживающее набор
элементов в отсортированном порядке. Конструкторы класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
позволяют создать множество на основе коллекции, а также указать объект,
реализующий интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IComparer</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> для проверки порядка элементов множества.
Набор методов <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SortedSet</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> схож с набором методов класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>HashSet</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.
Экземплярный метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Reverse()</span></span>
возвращает набор элементов в противоположном порядке, а метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetViewBetween()</span></span> возвращает
фрагмент («окно») исходного множества между двумя элементами.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> setOne = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SortedSet</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>char</span></span><span lang=EN-US>&gt;(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;the quick brown fox&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;{0} {1}&quot;</span></span><span
lang=EN-US>, setOne.Min, setOne.Max);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span><span
lang=EN-US>&gt; reversed = setOne.Reverse();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> setTwo = setOne.GetViewBetween(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>'a'</span></span><span lang=EN-US>, </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>'p'</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;{0} {1}&quot;</span></span><span
lang=EN-US>, setTwo.Min, setTwo.Max);</span></p>

<h1><a name="_Toc348862500">13. Типы для работы с коллекциями-словарями</a></h1>

<p class=MsoNormal>Под термином <span class=a2>словарь</span> будем понимать
коллекцию, которая хранит пары «ключ-значение» с возможностью доступа к
элементам по ключу. Базовая библиотека платформы .NET предлагает несколько
коллекций-словарей, как классических, так и с различными дополнительными
возможностями.</p>

<p class=MsoNormal>Универсальный класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Dictionary</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span> – классический
словарь с возможностью указать тип для ключа и тип для значения<a
style='mso-footnote-id:ftn10' href="#_ftn10" name="_ftnref10" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[10]</span></span><![endif]></span></span></a>.
Данный класс является одним из наиболее часто используемых классов-коллекций
(наряду с классом <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span>). Класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Dictionary</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span> реализует
обе версии интерфейса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IDictionary</span></span> (обычную и универсальную). Пример
использования класса приведён ниже.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// конструируем словарь и помещаем в него один
элемент<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// обратите внимание на синтаксис инициализации
словаря<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> d = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Dictionary</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>&gt; {{</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;One&quot;</span></span><span lang=EN-US>,
1}};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// помещаем элементы, используя индексатор и
метод Add()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>d[</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Two&quot;</span></span><span
lang=EN-US>] = 22;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>d.Add(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Three&quot;</span></span><span lang=EN-US>, 3);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// обновляем существующий элемент<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>d</span><span style='mso-ansi-language:
RU'>[</span><span class=ad><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Two</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>]
= 2; <o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(d[</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Two&quot;</span></span><span
lang=EN-US>]);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(d.ContainsKey(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;One&quot;</span></span><span
lang=EN-US>));<span style='mso-spacerun:yes'>    </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>быстрая</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>операция</span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(d.ContainsValue(3));<span style='mso-spacerun:yes'>     
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>медленная</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>операция</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> val;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (!d.TryGetValue(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;ONE&quot;</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>out</span></span><span
lang=EN-US> val))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;No such value&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// различные способы перечисления словаря<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
style='mso-ansi-language:RU'> (</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>pair</span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
lang=EN-US>d</span><span style='mso-ansi-language:RU'>)<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(pair.Key + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;; &quot;</span></span><span lang=EN-US> +
pair.Value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> key </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> d.Keys)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(key);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> value </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> d.Values)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>value</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Словарь может работать с элементами любого типа, так как у
любого объекта можно получить хэш-код и сравнить объекты на равенство,
используя методы <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetHashCode()</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Equals()</span></span>.
Пользовательские типы могут переопределять данные методы, предоставляя их
эффективную реализацию. Кроме этого, конструктору словаря можно передать
объект, реализующий интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey&gt;</span></span>. Типичным примером
использования такого подхода является конструирование словаря, обеспечивающего
сравнение строк-ключей независимо от их регистра:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> comparer = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StringComparer</span></span>.OrdinalIgnoreCase;</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> d = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Dictionary</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>&gt;(comparer);</span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>OrderedDictionary</span></span> – слаботипизированный класс,
запоминающий порядок добавления элементов в словарь. В некотором смысле, данный
класс является комбинацией классов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Hashtable</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ArrayList</span></span>. Для
доступа к элементам в <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>OrderedDictionary</span></span> можно применять как ключ, так и
целочисленный индекс.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ListDictionary</span></span> использует для хранения элементов
словаря не хэш-таблицу, а односвязный список. Это делает данный класс
неэффективным при работе с большими наборами данных. <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ListDictionary</span></span>
рекомендуется использовать, если количество хранимых элементов не превышает
десяти. Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>HybridDictionary</span></span> – это форма словаря, использующая
список для хранения при малом количестве элементов, и переключающаяся на
применение хэш-функции, когда количество элементов превышает определённый
порог. Оба класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ListDictionary</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>HybridDictionary</span></span> являются
слаботипизированными и находятся в пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Collections.Specialized</span></span>.</p>

<p class=MsoNormal>Платформа .NET предоставляет три класса-словаря,
организованных так, что их элементы всегда отсортированы по ключу: <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedDictionary</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;TKey,&nbsp;TValue&gt;</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedList</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span>.
Данные классы используют разные внутренние структуры для хранения элементов
словаря. Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SortedDictionary</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span> быстрее
классов <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedList</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span>
при выполнении вставки элементов. Но классы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SortedList</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>SortedList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span>
могут предоставить возможность, которой нет у <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SortedDictionary</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey, TValue&gt;</span></span> – доступ к
элементу не только по ключу, но и с использованием целочисленного индекса.</p>

<h1><a name="_Toc348862501">14. Типы для создания пользовательских коллекций</a></h1>

<p class=MsoNormal>Типы коллекций, описанные в предыдущих параграфах, применимы
в большинстве стандартных ситуаций. Однако иногда требуется создать собственный
тип-коллекцию. Например, в случае, когда изменение коллекции должно
генерировать событие, или когда необходима дополнительная проверка данных при
помещении их в коллекцию. Для облегчения решения этой задачи платформа .NET
предлагает несколько классов, размещённых в пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Collections.ObjectModel</span></span>.</p>

<p class=MsoNormal>Универсальный класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Collection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> является настраиваемой
оболочкой над классом <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span><a style='mso-footnote-id:ftn11'
href="#_ftn11" name="_ftnref11" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[11]</span></span><![endif]></span></span></a>.
В дополнение к реализации интерфейсов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IList</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span>, класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
определяет четыре виртуальных метода <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ClearItems()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>InsertItem()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>RemoveItem()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SetItem()</span></span> и свойство для чтения <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Items</span></span>, имеющее
тип <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.
Переопределяя виртуальные методы, можно модифицировать нормальное поведение
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> при
изменении набора.</p>

<p class=MsoNormal>Рассмотрим пример использования <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.
Пусть класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
представляет отдельную композицию музыкального альбома. Класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Album</span></span>
наследуется от <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Collection</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Track</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span> и описывает альбом.
Виртуальные методы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Collection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span>
переопределяются, чтобы корректно изменять значение свойства <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Album</span></span> у объекта <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Track</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Title { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public uint</span></span><span lang=EN-US>
Length { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Album</span></span> Album { </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>internal set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Album</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>protected override void</span></span><span
lang=EN-US> InsertItem(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Track</span></span> item)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>.InsertItem(index,
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>item.Album = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>protected override void</span></span><span
lang=EN-US> SetItem(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Track</span></span> item)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>.SetItem(index,
item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>item.Album = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>protected override void</span></span><span
lang=EN-US> RemoveItem(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> index)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US>[index].Album
= </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>.RemoveItem(index);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>protected override void</span></span><span
lang=EN-US> ClearItems()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span> track </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>track.Album = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>.ClearItems();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>У класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Collection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> имеется конструктор,
принимающий в качестве аргумента объект, реализующий <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. В
отличие от других классов коллекций, этот набор не копируется – запоминается
ссылка на него. То есть, изменение набора будет означать изменение коллекции <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> (хотя
и без вызова виртуальных методов).</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ReadOnlyCollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> – это наследник <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
предоставляющий доступ для чтения элементов, но не для модификации коллекции.
Конструктор класса принимает в качестве аргумента объект, реализующий <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IList</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.
Класс не содержит открытых методов добавления или удаления элемента, но можно
получить доступ к элементу по индексу и изменить его.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> album = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Album</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Speak To Me&quot;</span></span><span
lang=EN-US>, Length = 68},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Breathe&quot;</span></span><span
lang=EN-US>, Length = 168},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;On The Run&quot;</span></span><span
lang=EN-US>, Length = 230}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> albumReadOnly = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ReadOnlyCollection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span>&gt;(album);</span></p>

<p class=aCxSpLast><span lang=EN-US>albumReadOnly[1].Title = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>.Empty;</span></p>

<p class=MsoNormal>Класс<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ObservableCollection</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> – </span>это<span style='mso-ansi-language:
EN-US'> </span>коллекция<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>позволяющая<span
style='mso-ansi-language:EN-US'> </span>отслеживать<span style='mso-ansi-language:
EN-US'> </span>модификации<span style='mso-ansi-language:EN-US'> </span>своего<span
style='mso-ansi-language:EN-US'> </span>набора<span style='mso-ansi-language:
EN-US'> </span>данных<span lang=EN-US style='mso-ansi-language:EN-US'>. </span>Этот
класс наследуется от <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Collection</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span> и реализует интерфейс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>INotifyCollectionChanged</span></span>,
который описывает событие, генерируемое при изменении данных:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>INotifyCollectionChanged</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>event</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>NotifyCollectionChangedEventHandler</span></span> CollectionChanged;</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Аргумент события <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CollectionChanged</span></span> позволяет узнать, какое действие
выполнено над набором данных (добавление, удаление, замена элемента), а также
получить информацию о новых или удалённых элементах коллекции.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// коллекция album – такая же, как в предыдущем
примере<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> observable = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ObservableCollection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span>&gt;(album);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>observable.CollectionChanged += (sender,
e) =&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                             </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                 </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span>.WriteLine(e.Action);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                 </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span> item </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> e.NewItems)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                 </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                     </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span>.WriteLine(item.Title);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                 </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                             </span>};</span></p>

<p class=aCxSpLast><span lang=EN-US>observable.Add(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Time&quot;</span></span><span
lang=EN-US>, Length = 424});</span></p>

<p class=MsoNormal>Абстрактный<span style='mso-ansi-language:EN-US'> </span>класс<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>KeyedCollection</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;TKey,
TItem&gt;</span></span><span lang=EN-US style='mso-ansi-language:EN-US'> </span>является<span
style='mso-ansi-language:EN-US'> </span>наследником<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Collection</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Этот класс добавляет
возможность обращения к элементу по ключу (как в словарях). При использовании <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>KeyedCollection</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;TKey, TItem&gt;</span></span>
требуется переопределить метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>GetKeyForItem()</span></span> для вычисления ключа элемента.</p>

<p class=MsoNormal>Для демонстрации применения <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>KeyedCollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey, TItem&gt;</span></span> модифицируем
пример с классами <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Album</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Track</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private string</span></span><span lang=EN-US>
_title;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Title</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> _title; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>if</span></span><span lang=EN-US> (Album != </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span><span lang=EN-US> &amp;&amp; _title != </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>value</span></span><span lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>Album.ChangeTitle(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>value</span></span><span lang=EN-US>); <span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>изменение</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ключа</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>_title = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>value</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public uint</span></span><span lang=EN-US>
Length { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AlbumDictionary</span></span> Album { </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>get</span></span><span lang=EN-US>; </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>internal set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AlbumDictionary</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>KeyedCollection</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Track</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>protected override string</span></span><span
lang=EN-US> GetKeyForItem(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span> item)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>item</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Title</span><span
style='mso-ansi-language:RU'>;<span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// ключом будет название композиции</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>internal void</span></span><span lang=EN-US>
ChangeTitle(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Track</span></span> track, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> title)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>ChangeItemKey(track, title);<span style='mso-spacerun:yes'>   </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>метод</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>меняет</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ключ</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элемента</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>методы</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> ClearItems(),
InsertItem(), RemoveItem(), SetItem()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
реализованы так же, как в классе Album<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пример</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>использования</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> album = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AlbumDictionary</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Speak To Me&quot;</span></span><span
lang=EN-US>, Length = 68},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Breathe&quot;</span></span><span
lang=EN-US>, Length = 168},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Track</span></span>
{Title = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;On The Run&quot;</span></span><span
lang=EN-US>, Length = 230}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US>album[0].Length = 0;<span
style='mso-spacerun:yes'>                 </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>обращение</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>по</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>индексу</span></span></p>

<p class=aCxSpLast><span lang=EN-US>album[</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Speak To Me&quot;</span></span><span lang=EN-US>].Length =
68;<span style='mso-spacerun:yes'>    </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>обращение</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>по</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ключу</span></span></p>

<h1><a name="_Toc348862502">15. Технология LINQ to </a><span style='mso-bookmark:
_Toc348862502'><span lang=EN-US style='mso-ansi-language:EN-US'>O</span>bjects</span></h1>

<p class=MsoNormal>Платформа .NET версии 3.5 представила новую технологию
работы с коллекциями – <span class=a2>Language Integrated Query</span> (LINQ).
По типу обрабатываемой информации LINQ делится на LINQ to Objects – библиотеки
для обработки коллекций объектов в памяти, LINQ to SQL – библиотеки для работы
с базами данных, LINQ to XML предназначена для обработки XML-информации. В
данном параграфе акцент сделан на LINQ to Objects.</p>

<p class=MsoNormal>Технически, LINQ to Objects – это набор классов, содержащих
типичные методы обработки коллекций: поиск данных, сортировка, фильтрация.
Ядром LINQ to Objects является статический класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>,
размещённый в пространстве имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Linq</span></span><a style='mso-footnote-id:ftn12'
href="#_ftn12" name="_ftnref12" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[12]</span></span><![endif]></span></span></a>
. Этот класс содержит набор методов расширения интерфейса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
которые в дальнейшем будут называться <span class=a2>операторами LINQ</span>. Для
удобства дальнейшего изложения используем стандартное деление операторов LINQ
на группы в зависимости от выполняемых действий:</p>

<p class=MsoNormal>1. Оператор условия <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Where</span></span> (отложенные вычисления).</p>

<p class=MsoNormal>2. Операторы проекций (отложенные вычисления).</p>

<p class=MsoNormal>3. Операторы упорядочивания (отложенные вычисления).</p>

<p class=MsoNormal>4. Оператор группировки <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GroupBy</span></span> (отложенные вычисления).</p>

<p class=MsoNormal>5. Операторы соединения (отложенные вычисления).</p>

<p class=MsoNormal>6. Операторы работы с множествами (отложенные вычисления).</p>

<p class=MsoNormal>7. Операторы агрегирования.</p>

<p class=MsoNormal>8. Операторы генерирования (отложенные вычисления).</p>

<p class=MsoNormal>9. Операторы кванторов и сравнения.</p>

<p class=MsoNormal>10. Операторы разбиения (отложенные вычисления).</p>

<p class=MsoNormal>11. Операторы элемента.</p>

<p class=MsoNormal>12. Операторы преобразования.</p>

<p class=MsoNormal>В примерах параграфа будут использоваться либо коллекции
примитивных типов, либо коллекция <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>gr</span></span> объектов класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Age { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt; Marks { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> gr = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>&gt;{</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Smirnov&quot;</span></span><span
lang=EN-US>, Age = 18, Marks = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {10, 8, 9}},</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Ivanova&quot;</span></span><span
lang=EN-US>, Age = 20, Marks = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {5, 6, 9}},</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Kuznetsov&quot;</span></span><span
lang=EN-US>, Age = 18, Marks = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {7, 7, 4}},</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Sokolov&quot;</span></span><span
lang=EN-US>, Age = 20, Marks = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {7, 8, 8}},</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Lebedeva&quot;</span></span><span
lang=EN-US>, Age = 20, Marks = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {9, 9, 9}}</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>};<o:p></o:p></span></p>

<p class=af5>1. Оператор условия Where().</p>

<p class=MsoNormal>Оператор производит фильтрацию коллекции, основываясь на
аргументе-предикате. Сигнатуры<span style='mso-ansi-language:EN-US'> </span>оператора<a
style='mso-footnote-id:ftn13' href="#_ftn13" name="_ftnref13" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[13]</span></span><![endif]></span></span></a><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Where&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                        </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>&gt;
predicate);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Where&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                        </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>&gt;
predicate);</span></p>

<p class=MsoNormal>Второй вариант оператора <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Where()</span></span> позволяет передать
аргументу-предикату индекс элемента в коллекции (заметим, что многие другие операторы
имеют перегруженную версию, устроенную по такому же принципу).</p>

<p class=MsoNormal>Примеры<span style='mso-ansi-language:EN-US'> </span>использования<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Where()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> list = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt; {1, 3, -1, -4, 7};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r1 = list.Where(x =&gt; x &lt; 0);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r2 = gr.Where(student =&gt; student.Age &gt; 19);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r3 = gr.Where((student, pos) =&gt; student.Age &gt; 19 &amp;&amp;
pos &lt; 3);</span></p>

<p class=af5>2. Операторы проекций.</p>

<p class=MsoNormal>Операторы проекций применяются для выборки информации, при
этом они могут изменять тип элементов итоговой коллекции. Основным<span
style='mso-ansi-language:EN-US'> </span>оператором<span style='mso-ansi-language:
EN-US'> </span>проекции<span style='mso-ansi-language:EN-US'> </span>является<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Select()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;S&gt; Select&lt;T, S&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>S</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>selector</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SelectMany()</span></span> может применяться, если результатом
проекции является набор данных. В этом случае оператор соединяет все элементы
набора в одну коллекцию.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;S&gt; SelectMany&lt;T, S&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;source,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
<span class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;S&gt;&gt; selector);</span></p>

<p class=MsoNormal>Примеры использования операторов проекций:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>r</span><span
style='mso-ansi-language:RU'>1 = </span><span lang=EN-US>gr</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Select</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>student</span><span
style='mso-ansi-language:RU'> =&gt; </span><span lang=EN-US>student</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Name</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r2 = gr.Select(student =&gt; </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> {student.Name, student.Age});</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r3 = gr.SelectMany(student =&gt; student.Marks);</span></p>

<p class=MsoNormal>Коллекция <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>r1</span></span> будет содержать имена студентов. Коллекция <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>r2</span></span> состоит из
объектов анонимного типа с полями <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Name</span></span> и <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Age</span></span>. Коллекция <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>r3</span></span> – это все оценки студентов (15
элементов типа <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span>).</p>

<p class=af5>3. Операторы упорядочивания.</p>

<p class=MsoNormal>Операторы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>OrderBy()</span></span> и <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OrderByDescending()</span></span> выполняют
сортировку коллекции по возрастанию или убыванию соответственно. Имеется версия
данных операторов, принимающая в качестве дополнительного аргумента объект,
реализующий <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparer</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IOrderedEnumerable</span></span><span
lang=EN-US>&lt;T&gt; OrderBy&lt;T, K&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                    </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, K&gt; keySelector);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IOrderedEnumerable</span></span><span
lang=EN-US>&lt;T&gt; OrderByDescending&lt;T, K&gt;(</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T, K&gt; keySelector);</span></p>

<p class=MsoNormal>Интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IOrderedEnumerable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> является наследником <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и
описывает упорядоченную последовательность элементов с указанием на ключ
сортировки. Если после выполнения сортировки по одному ключу требуется
дополнительная сортировка по другому ключу, нужно воспользоваться операторами <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThenBy()</span></span> и <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThenByDescending()</span></span>.
Имеется также оператор <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Reverse()</span></span>,
обращающий коллекцию.</p>

<p class=MsoNormal>Пример использования операторов упорядочивания:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Reverse(gr);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r2 = gr.OrderBy(student =&gt; student.Age);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r3 = gr.OrderByDescending(student =&gt; student.Age)</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>          
</span></span><span style='mso-ansi-language:RU'>.</span><span lang=EN-US>ThenBy</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>student</span><span
style='mso-ansi-language:RU'> =&gt; </span><span lang=EN-US>student</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Name</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Чтобы получить коллекцию <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>r1</span></span>, метод расширения
использовался как обычный статический метод класса, так как у <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
имеется собственный метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Reverse()</span></span>. В коллекции <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>r3</span></span> студенты упорядочены по
убыванию возраста, а при совпадении возрастов – по фамилиям в алфавитном
порядке.</p>

<p class=af5>4. Оператор группировки GroupBy().</p>

<p class=MsoNormal>Оператор группировки <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GroupBy()</span></span> разбивает коллекцию на
группы элементов с одинаковым значением некоторого ключа. Оператор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GroupBy()</span></span> имеет
перегруженные версии, позволяющие указать селектор ключа, преобразователь
элементов в группе, объект, реализующий <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> для сравнения ключей.
Простейшая версия оператора группировки имеет следующий вид:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IGrouping</span></span>&lt;K, T&gt;&gt;
GroupBy&lt;T, K&gt;(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; src,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                          </span><span
style='mso-spacerun:yes'> </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>K</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>keySelector</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Здесь последний параметр указывает на функцию, которая
строит по элементу поле-ключ. Обычно эта функция просто выбирает одно из полей
объекта. Интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IGrouping</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;K, T&gt;</span></span> унаследован от <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> и
содержит дополнительное типизированное свойство <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Key</span></span> – ключ группировки.</p>

<p class=MsoNormal>Рассмотрим применение оператора группировки. Сгруппируем
студентов по возрасту и для каждой группы возрастов выведем ключ и элементы:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r1 = gr.GroupBy(student =&gt; student.Age);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IGrouping</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt; group </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> r1)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(group.Key);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span> student </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> group)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(student.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=af5><span lang=EN-US style='mso-ansi-language:EN-US'>5. </span>Операторы<span
style='mso-ansi-language:EN-US'> </span>соединения<span lang=EN-US
style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal>Операторы соединения применяются, когда требуется соединить
две коллекции, элементы которых имеют общие атрибуты. Основным оператором
соединения является оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Join()</span></span>.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>V</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>Join</span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>U</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>K</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>V</span><span
style='mso-ansi-language:RU'>&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span><span style='mso-ansi-language:RU'>&lt;</span><span
lang=EN-US>T</span><span style='mso-ansi-language:RU'>&gt; </span><span
lang=EN-US>outer</span><span style='mso-ansi-language:RU'>,<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>                            </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;U&gt;
inner,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
K&gt; outerKeySelector,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;U,
K&gt; innerKeySelector,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
U, V&gt; resultSelector);</span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Join()</span></span> требует задания двух коллекций (внешней и
внутренней) и трёх функций. Первая функция порождает ключ из элемента внешней
коллекции, вторая – из элемента внутренней коллекции, а третья функция
продуцирует объект коллекции-результата. При выполнении соединения <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Join()</span></span>
итерируется по внешней коллекции и ищет соответствия с элементами внутренней
коллекции. При этом возможны следующие ситуации:</p>

<p class=MsoNormal>1. Найдено одно соответствие – в результат включается один
элемент.</p>

<p class=MsoNormal>2. Найдено множественное соответствие – результат содержит
по элементу для каждого соответствия.</p>

<p class=MsoNormal>3. Соответствий не найдено – элемент не входит в результат.</p>

<p class=MsoNormal>Рассмотрим примеры использования оператора <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Join()</span></span>. Для этого опишем
коллекцию <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>cit</span></span>
объектов класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Citizen</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Citizen</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public int</span></span><span lang=EN-US>
BirthYear { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
IDNumber { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> year = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.Now.Year;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> cit = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Citizen</span></span>&gt;
{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Citizen</span></span> {BirthYear = year - 17, IDNumber = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;KLM897&quot;</span></span><span
lang=EN-US>},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Citizen</span></span> {BirthYear = year - 18, IDNumber = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;WEF442&quot;</span></span><span
lang=EN-US>},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Citizen</span></span> {BirthYear = year - 18, IDNumber = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;HHH888&quot;</span></span><span
lang=EN-US>},</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>         
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Citizen</span></span> {BirthYear = year - 25, IDNumber = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;XYZ012&quot;</span></span><span
lang=EN-US>}};</span></p>

<p class=MsoNormal>Выполним<span style='mso-ansi-language:EN-US'> </span>оператор<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Join()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r1 = gr.Join(cit,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>          
</span><span style='mso-spacerun:yes'> </span>student =&gt; year - student.Age,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>          
</span><span style='mso-spacerun:yes'> </span>citizen =&gt; citizen.BirthYear,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'> </span>(student,
citizen) =&gt; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> {student.Name, citizen.IDNumber});</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// r1 содержит следующие объекты:<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// {Name = &quot;Smirnov&quot;, IDNumber =
&quot;WEF442&quot;}<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
{Name = &quot;Smirnov&quot;, IDNumber = &quot;HHH888&quot;}<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
{Name = &quot;Kuznetsov&quot;, IDNumber = &quot;WEF442&quot;}<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// {Name = &quot;Kuznetsov&quot;, IDNumber =
&quot;HHH888&quot;}<o:p></o:p></span></span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>GroupJoin()</span></span> порождает набор, группируя элементы
внутренней коллекции при нахождении соответствия с элементом внешней коллекции:
Если же соответствие не найдено, в результат включается пустая группа.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;V&gt; GroupJoin()&lt;T, U, K, V&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
outer,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                       </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;U&gt; inner,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
K&gt; outerKeySelector,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>          
</span><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>                          </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;U,
K&gt; innerKeySelector,</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>     
</span><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;U&gt;, V&gt; resultSelector);</span></p>

<p class=MsoNormal>Ниже приведён пример использования <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GroupJoin()</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r3 = cit.GroupJoin(gr,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span><span style='mso-spacerun:yes'> </span>citizen =&gt; citizen.BirthYear,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>          
</span>student =&gt; year - student.Age,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span>(citizen,
group) =&gt; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> {citizen.IDNumber,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span><span
style='mso-spacerun:yes'> </span>Names = group.Select(st =&gt; st.Name)});</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> data </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> r3)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>    
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(data.IDNumber);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>    
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> s </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> data.Names)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>    
</span></span><span style='mso-ansi-language:RU'>{ <o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>         </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
1-я и 4-я группы пусты,<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>         </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
2-я и 3-я содержат по два элемента</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>         </span></span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteLine</span><span style='mso-ansi-language:RU'>(</span><span
lang=EN-US>s</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>     </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Zip()</span></span> порождает набор на основе двух исходных
коллекций, выполняя заданное генерирование элементов. Длина результирующей
коллекции равна длине меньшей из двух исходных коллекций.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;V&gt; Zip&lt;T, U, V&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; first,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;U&gt;
second,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
U, V&gt; resultSelector);</span></p>

<p class=MsoNormal>Дадим простейший пример использования <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Zip()</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[] numbers = {1, 2, 3, 4};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] words = {</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;one&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;two&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;three&quot;</span></span><span
lang=EN-US>};</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> res = numbers.Zip(words, (f, s) =&gt; f + </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;=&quot;</span></span><span lang=EN-US> + s);<span
style='mso-spacerun:yes'>   </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// 3 </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>элемента</span></span></p>

<p class=af5>6. Операторы работы с множествами.</p>

<p class=MsoNormal>В LINQ to Objects имеется набор операторов для работы с
множествами.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Distinct&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Union&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; first,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                        </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
second);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Intersect&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; first,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
second);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Except&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; first,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                         </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>second</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Distinct()</span></span> удаляет из коллекции повторяющиеся
элементы. Операторы <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Union()</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Intersect()</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Except()</span></span>
представляют объединение, пересечение и разность двух множеств.</p>

<p class=af5>7. Операторы агрегирования.</p>

<p class=MsoNormal>К операторам агрегирования относятся операторы, результатом
работы которых является скалярное значение. Следующие операторы возвращают
количество элементов коллекции. При этом может быть использована перегруженная
версия, принимающая в качестве второго аргумента предикат фильтрации.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> Count&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>long</span></span><span
lang=EN-US> LongCount&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=MsoNormal>Следующие операторы подсчитывают сумму и среднее значение в
коллекции. При этом <span class=af4><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span lang=EN-US> </span>должен
быть типом <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>long</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>float</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>double</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>decimal</span></span>
или вариантом этих типов с поддержкой <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span> (например, <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>long</span></span>?).</p>

<p class=aCxSpFirst><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US> Sum(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=af4><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US>&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US> Sum&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, </span><span class=af4><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Num</span></span><span lang=EN-US>&gt; selector);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US> Average(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=af4><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US>&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpLast><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US> Average&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, </span><span class=af4><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Num</span></span><span lang=EN-US>&gt; selector);</span></p>

<p class=MsoNormal>Существует также несколько перегруженных версий операторов
для нахождения минимального и максимального значений. Первые две версии
применяются для коллекций с числовым элементом. Последние две предполагают, что
элемент коллекции реализует интерфейс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IComparable</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.</p>

<p class=aCxSpFirst><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US> Min/Max(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;</span><span
class=af4><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US>&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Num</span></span><span
lang=EN-US> Min&lt;T&gt;/Max&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; src, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, </span><span class=af4><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Num</span></span><span lang=EN-US>&gt; selector);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>T Min&lt;T&gt;/Max&lt;T&gt;(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpLast><span lang=EN-US>S Min&lt;T, S&gt;/Max&lt;T, S&gt;(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; src, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
S&gt; selector);</span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Aggregate()</span></span> позволяет выполнить для коллекции
собственный алгоритм агрегирования. Его<span style='mso-ansi-language:EN-US'> </span>простейшая<span
style='mso-ansi-language:EN-US'> </span>форма<span lang=EN-US style='mso-ansi-language:
EN-US'>:<o:p></o:p></span></p>

<p class=a><span lang=EN-US>T Aggregate&lt;T&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T, T, T&gt; func);</span></p>

<p class=MsoNormal>Функция <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>func</span></span> принимает два аргумента: значение-аккумулятор и
текущее значение коллекции. Результат функции перезаписывается в аккумулятор. В
следующем примере оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Aggregate()</span></span> применяется для обращения строки:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> text = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;The quick brown fox
jumps over the lazy dog&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] words = text.Split(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>'
'</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> reversed = words.Aggregate((acc, next) =&gt; next + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot; &quot;</span></span><span lang=EN-US> +
acc);</span></p>

<p class=af5>8. Операторы генерирования.</p>

<p class=MsoNormal>Эта группа операторов позволяет создать набор данных. Первый
оператор группы – оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Range()</span></span>. Он просто выдаёт указанное количество подряд
идущих целых чисел, начиная с заданного значения.</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>&gt; Range(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> start, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> count);</span></p>

<p class=MsoNormal>Продемонстрируем использование <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Range()</span></span> в задаче поиска простых
чисел, которую решим при помощи LINQ:</p>

<p class=aCxSpFirst><a name="OLE_LINK9"><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></span></a></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK9'><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>var</span></span><span lang=EN-US> primes = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(2,
999)</span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK9'><span lang=EN-US><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>           
</span>.Where(x =&gt; !<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(2, (</span></span><span
style='mso-bookmark:OLE_LINK9'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>) <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Math</span></span>.Sqrt(x))</span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK9'><span lang=EN-US><span
style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>                      </span>.Any(y =&gt; x != y
&amp;&amp; x%y == 0));</span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK9'><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>foreach</span></span><span lang=EN-US> (</span></span><span
style='mso-bookmark:OLE_LINK9'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> prime </span></span><span style='mso-bookmark:OLE_LINK9'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> primes)</span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK9'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span></span></span><span
style='mso-bookmark:OLE_LINK9'><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteLine</span></span><span style='mso-bookmark:OLE_LINK9'><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>prime</span></span><span
style='mso-bookmark:OLE_LINK9'><span style='mso-ansi-language:RU'>);<o:p></o:p></span></span></p>

<span style='mso-bookmark:OLE_LINK9'></span>

<p class=MsoNormal>Следующий оператор генерирования – оператор <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Repeat()</span></span>. Он создаёт коллекцию, в
которой указанный элемент повторяется требуемое число раз. Для ссылочных типов
дублируются ссылки, а не содержимое.</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>Repeat</span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt;(</span><span lang=EN-US>T</span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>element</span><span
style='mso-ansi-language:RU'>, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>count</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Покажем не совсем стандартное применение <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Repeat()</span></span> для генерирования последовательности
случайных чисел:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Random</span></span><span
lang=EN-US> rnd = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span>();</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Repeat(0, 20).Select(i
=&gt; rnd.Next(0, 40));</span></p>

<p class=MsoNormal>Последним генерирующим оператором является оператор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Empty()</span></span>,
который порождает пустое перечисление определённого типа.</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>Empty</span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt;();<o:p></o:p></span></p>

<p class=af5>9. Операторы кванторов и сравнения.</p>

<p class=MsoNormal>Операторы кванторов похожи на соответствующие операторы в
математической логике.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> Any&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US>&gt; predicate);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> Any&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> All&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US>&gt; predicate);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> Contains&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, T
value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> Contains&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, T
value,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                 </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>comparer</span><span
style='mso-ansi-language:RU'>)<o:p></o:p></span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Any()</span></span> проверяет наличие хотя бы одного элемента в
коллекции, удовлетворяющего указанному предикату. Вторая версия оператора <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Any()</span></span> просто
проверяет коллекцию на непустоту. Оператор <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>All()</span></span> возвращает <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span>, если все
элементы коллекции удовлетворяют предикату. И, наконец, оператор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Contains()</span></span>
проверяет, входит ли заданное значение в коллекцию.</p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SequenceEqual()</span></span> сравнивает две коллекции и возвращает
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span>,
если обе коллекции имеют одну длину, и их соответствующие элементы равны:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> SequenceEqual&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; first,</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span></span></span><span lang=EN-US><span
style='mso-spacerun:yes'>                  </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
second);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> SequenceEqual&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; first,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
second,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEqualityComparer</span></span>&lt;T&gt;
comparer);</span></p>

<p class=af5>10. Операторы разбиения.</p>

<p class=MsoNormal>Операторы разбиения выделяют некую часть исходной коллекции
(например, первые десять элементов).</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Take&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> count);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; TakeWhile&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>&gt;
predicate);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; Skip&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> count);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; SkipWhile&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>predicate</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Комбинация операторов <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Take()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Skip()</span></span> часто применяется, чтобы
организовать постраничный просмотр информации (например, просмотр записей из
большой таблицы):</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var </span></span><span
lang=EN-US>bigTable = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(1, 1000);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int </span></span><span
lang=EN-US>pageSize = 20, pageNumber = 6;</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var </span></span><span
lang=EN-US>page = bigTable.Skip((pageNumber - 1)*pageSize).Take(pageSize);</span></p>

<p class=af5>11. Операторы элемента.</p>

<p class=MsoNormal>Эта группа операторов предназначена для выделения из
коллекции единственного элемента, удовлетворяющего определённым условиям.</p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>First()</span></span> выделяет первый элемент (или первый элемент,
удовлетворяющий определённому предикату).</p>

<p class=aCxSpFirst><span lang=EN-US>T First&lt;T&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpLast><span lang=EN-US>T First&lt;T&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>bool</span></span><span lang=EN-US>&gt; predicate);</span></p>

<p class=MsoNormal>Если в коллекции нет элементов, или не нашлось элементов,
удовлетворяющих предикату, оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>First()</span></span> выбрасывает исключение <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>InvalidOperationException</span></span>.
Если требуется, чтобы исключение не выбрасывалось, а возвращалось
предопределённое значение для типа, следует использовать оператор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FirstOrDefault()</span></span>.</p>

<p class=aCxSpFirst><span lang=EN-US>T FirstOrDefault&lt;T&gt;(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>T FirstOrDefault&lt;T&gt;(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; source,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                   </span><span
style='mso-spacerun:yes'> </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>predicate</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Аналогично работают операторы <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Last()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LastOrDefault()</span></span> для выделения
последнего элемента.</p>

<p class=MsoNormal>Операторы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Single()</span></span> и <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SingleOrDefault()</span></span> рассчитаны на
то, что коллекция (или набор элементов, удовлетворяющих предикату) будет
состоять из одного элемента, который данные операторы и возвращают. Если в
коллекции нет элементов, или их оказалось больше одного, оператор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Single()</span></span>
выбрасывает исключение <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>InvalidOperationException</span></span>. Оператор <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SingleOrDefault()</span></span> выбрасывает
такое исключение, если элементов оказалось больше одного.</p>

<p class=MsoNormal>Пара операторов <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ElementAt()</span></span> и <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ElementAtOrDefault()</span></span> пытаются
вернуть элемент на указанной целочисленной позиции.</p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DefaultIfEmpty()</span></span> проверяет коллекцию на пустоту. Если
в коллекции нет элементов, то возвращается или значение по умолчанию для типа,
или указанное значение. Если коллекция непустая, то она и возвращается.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>DefaultIfEmpty</span><span
style='mso-ansi-language:RU'>&lt;</span><span lang=EN-US>T</span><span
style='mso-ansi-language:RU'>&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span><span style='mso-ansi-language:RU'>&lt;</span><span
lang=EN-US>T</span><span style='mso-ansi-language:RU'>&gt; </span><span
lang=EN-US>source</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; DefaultIfEmpty&lt;T&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                 </span>T</span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>defaultValue</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=af5>12. Операторы преобразования.</p>

<p class=MsoNormal>Назначение данных операторов – преобразования универсальных
коллекций, реализующих <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, в конкретные типы.</p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AsEnumerable()</span></span> возвращает свой аргумент, приведённый
к типу <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. Этот
оператор необходим в том случае, если тип аргумента <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>source</span></span> имеет методы, аналогичные
имеющимся в LINQ to Objects.</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;T&gt;
AsEnumerable&lt;T&gt;(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=MsoNormal>Операторы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ToArray()</span></span> и <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ToList()</span></span> выполняют преобразование
коллекции в массив или список.</p>

<p class=aCxSpFirst><span lang=EN-US>T[] ToArray&lt;T&gt;(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>this</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span><span
lang=EN-US>&lt;T&gt; ToList&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source);</span></p>

<p class=MsoNormal>Существует несколько версий оператора <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ToDictionary()</span></span>, порождающего из
коллекции словарь. Например, следующая версия использует отдельные функции для
выделения из элемента коллекции ключа и значения ключа.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Dictionary</span></span><span
lang=EN-US>&lt;K, V&gt; ToDictionary&lt;T, K, V&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                       </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, K&gt; keySelector,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                       </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;T, V&gt; valueSelector);</span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ToLookup()</span></span> преобразовывает коллекцию в объект класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Lookup</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;K, V&gt;</span></span> из
пространства имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Linq</span></span>.
Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Lookup</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;K, V&gt;</span></span>
представляет словарь, в котором ключу сопоставлен не единственный элемент, а
набор элементов.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ILookup</span></span><span
lang=EN-US>&lt;K, V&gt; ToLookup&lt;T, K, V&gt;(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>this</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
source,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
K&gt; keySelector,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;T,
V&gt; valueSelector);</span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>OfType&lt;T&gt;()</span></span> итерируется по коллекции и
генерирует список, содержащий только элементы заданного типа <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>T</span></span>.</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;T&gt;
OfType&lt;T&gt;(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span> source);</span></p>

<p class=MsoNormal>Оператор <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Cast&lt;T&gt;()</span></span> итерируется по слаботипизированной
коллекции и пытается выполнить приведение каждого элемента к указанному типу.
Если приведение выполнить не удаётся, генерируется исключение. Данный оператор
полезен, если мы хотим применять LINQ для старых коллекций, таких, как <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ArrayList</span></span>.</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;T&gt;
Cast&lt;T&gt;(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span> source);</span></p>

<p class=MsoNormal>Из операторов преобразования отложенные вычисления выполняют
операторы <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsEnumerable&lt;T&gt;()</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>OfType&lt;T&gt;()</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Cast&lt;T&gt;()</span></span>.</p>

<p class=MsoNormal>Язык C# версии 3.0 вводит новые ключевые слова и особые
синтаксические расширения для записи некоторых операторов LINQ в виде выражений
запросов. Составленное выражение запросов должно подчиняться следующим правилам
(за строгим описанием правил следует обратиться к MSDN):</p>

<p class=MsoNormal>1. Выражение должно начинаться с конструкции <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span>, которая
указывает на обрабатываемую коллекцию.</p>

<p class=MsoNormal>2. Затем выражение может содержать ноль или более конструкций
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>let</span></span>
или <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span>.
Конструкция <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>let</span></span>
представляет переменную и присваивает ей значение. Конструкция <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span> фильтрует
элементы коллекции.</p>

<p class=MsoNormal>3. Затем выражение может включать ноль или более конструкций
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>orderby</span></span>,
с полями сортировки и необязательным указанием на направление упорядочивания.
Направление может быть <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ascending</span></span> или <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>descending</span></span>.</p>

<p class=MsoNormal>4. Затем следует конструкция <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>select</span></span> или <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>group</span></span>.</p>

<p class=MsoNormal>5. Наконец, в оставшейся части выражения может следовать
необязательная конструкция продолжения. Такой конструкцией является <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>into</span></span>.</p>

<p class=MsoNormal>Выражения запросов транслируются компилятором в вызовы
соответствующих операторов LINQ. Приведём некоторые примеры эквивалентной
записи запросов к коллекциям данных.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>r</span><span
style='mso-ansi-language:RU'>1 = </span><span lang=EN-US>gr</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Where</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'> =&gt; </span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Age</span><span
style='mso-ansi-language:RU'> &gt; 20).</span><span lang=EN-US>Select</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'> =&gt; </span><span lang=EN-US>s</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Marks</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>эквивалентный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>синтаксис</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span><span
lang=EN-US> s </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> gr</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>where</span></span><span lang=EN-US> s.Age &gt;
20</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>select</span></span><span lang=EN-US> s.Marks;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r3 = gr.OrderByDescending(s =&gt; s.Age).ThenBy(s =&gt; s.Name);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>эквивалентный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>синтаксис</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r4 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span><span
lang=EN-US> s </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> gr</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>orderby</span></span><span lang=EN-US> s.Age </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>descending</span></span><span lang=EN-US>,
s.Name</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>select</span></span><span lang=EN-US> s;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r5 = gr.Select(student =&gt; </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> {student.Name, student.Age});</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>эквивалентный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>синтаксис</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r6 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span><span
lang=EN-US> student </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> gr </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>select</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> {student.Name, student.Age};</span></p>

<p class=MsoNormal>Приведём несколько примеров использования технологии LINQ to
Objects. В первом примере подсчитывается частота вхождения каждого слова в
текст.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> text = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;this is the text and
this is the code for the text&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> words = text.Split(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>'
'</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> result = words.GroupBy(word =&gt; word.ToUpper())</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span><span style='mso-spacerun:yes'>   </span>.Select(group =&gt; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> {group.Key,
Count = group.Count()})</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span>.OrderBy(pair =&gt; pair.Count);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> pair </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> result)</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>    </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span>.WriteLine(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;{0} - {1}&quot;</span></span><span lang=EN-US>, pair.Count,
pair.Key);</span></p>

<p class=MsoNormal>Второй пример – метод расширения, демонстрирующий идею
алгоритма быстрой сортировки (так как LINQ to Objects использует отложенные
вычисления, метод выполняется медленно).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt;
QSort&lt;T&gt;(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; data)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                      </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>where</span></span><span lang=EN-US> T : <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IComparable</span></span>&lt;T&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> tail =
data.Skip(1);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (tail.Any())</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> elem =
data.First();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> head =
data.Take(1);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> left =
tail.Where(x =&gt; x.CompareTo(elem) &lt; 0).QSort();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>     </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> right = tail.Where(x =&gt; x.CompareTo(elem) &gt;= 0).QSort();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
left.Concat(head).Concat(right);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>data</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h1><a name="_Toc348862503">16. Работа с объектами файловой системы</a></h1>

<p class=MsoNormal>В пространстве имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.IO</span></span> доступно несколько
классов для работы с объектами файловой системы – дисками, каталогами, файлами.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DriveInfo</span></span> инкапсулирует информацию о диске. Он имеет
статический метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetDrives()</span></span>
для получения массива объектов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DriveInfo</span></span>, соответствующих дискам
операционной системы. В примере кода демонстрируется работа с элементами класса
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DriveInfo</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>allDrives</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DriveInfo</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>GetDrives</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> d </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> allDrives)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Drive name: {0}&quot;</span></span><span
lang=EN-US>, d.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Drive type: {0}&quot;</span></span><span
lang=EN-US>, d.DriveType);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (!d.IsReady) </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>continue</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Volume Label: {0}&quot;</span></span><span
lang=EN-US>, d.VolumeLabel);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;File system: {0}&quot;</span></span><span
lang=EN-US>, d.DriveFormat);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Root: {0}&quot;</span></span><span
lang=EN-US>, d.RootDirectory);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Total size: {0}&quot;</span></span><span
lang=EN-US>, d.TotalSize);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Free size: {0}&quot;</span></span><span
lang=EN-US>, d.TotalFreeSpace);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Available: {0}&quot;</span></span><span
lang=EN-US>, d.AvailableFreeSpace);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Directory</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DirectoryInfo</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileInfo</span></span>
предназначены для работы с каталогами и файлами. Первые два класса выполняют
операции при помощи статических методов, вторые два – при помощи экземплярных
методов.</p>

<p class=MsoNormal>Рассмотрим работу с классами <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DirectoryInfo</span></span> и
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileInfo</span></span>.
Данные классы являются наследниками абстрактного класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileSystemInfo</span></span>.
Этот класс содержит следующие основные элементы, перечисленные в табл. 11.</p>

<p class=ae>Таблица 11</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileSystemInfo</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td valign=top style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Attributes</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство позволяет получить или установить атрибуты объекта
  файловой системы (тип – перечисление <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>FileAttributes</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CreationTime</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Время создания объекта файловой системы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Exists</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, проверка существования объекта файловой
  системы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Extension</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, расширение файла</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FullName</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, полное имя объекта файловой системы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastAccessTime</span></span>,<span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastAccessTimeUtc</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Время последнего доступа к объекту файловой системы (локальное
  или всемирное координированное)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastWriteTime</span></span>,<span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LastWriteTimeUtc</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Время последней записи для объекта файловой системы (локальное
  или всемирное координированное)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Name</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, имя файла или каталога</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Delete()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод удаляет объект файловой системы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Refresh()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод обновляет информацию об объекте файловой системы</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Конструктор класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DirectoryInfo</span></span> принимает в
качестве аргумента строку с именем того каталога, с которым будет производиться
работа. Для указания текущего каталога используется строка <span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;.&quot;</span></span>.
При попытке работать с данными несуществующего каталога генерируется
исключение. Работа с методами и свойствами класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DirectoryInfo</span></span>
показана в следующем фрагменте кода:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> dir = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DirectoryInfo</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>@&quot;C:\Temp&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// выводим некоторые свойства каталога C:\Temp<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Full name: {0}&quot;</span></span><span
lang=EN-US>, dir.FullName);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Parent directory:
{0}&quot;</span></span><span lang=EN-US>, dir.Parent);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Root directory:
{0}&quot;</span></span><span lang=EN-US>, dir.Root);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Creation date:
{0}&quot;</span></span><span lang=EN-US>, dir.CreationTime);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>создаём</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>подкаталог</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpLast><span lang=EN-US>dir.CreateSubdirectory(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Subdir&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DirectoryInfo</span></span> обладает двумя наборами методов для
получения дочерних подкаталогов, файлов или объектов <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileSystemInfo</span></span>.
Методы вида <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Get</span></span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Элементы</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span> выполняются
немедленно и возвращают массив. Методы вида <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerate</span></span><span class=af4><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Элементы</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>()</span></span> используют отложенное
выполнение и возвращают перечислитель:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> dir = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DirectoryInfo</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>@&quot;C:\Temp&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// получаем файлы по маске из всех подкаталогов<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileInfo</span></span><span
lang=EN-US>[] f = dir.GetFiles(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;*.txt&quot;</span></span><span
lang=EN-US>, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SearchOption</span></span>.AllDirectories);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>получаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>файлы</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>используя</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>отложенное</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>выполнение</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> fileInfo </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> dir.EnumerateFiles())</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>   </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>fileInfo</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Name</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>FileInfo</span></span> описывает файл на диске и позволяет
производить операции с этим файлом. Наиболее важные элементы класса
представлены в табл. 12.</p>

<p class=ae>Таблица 12</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileInfo</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>AppendText()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт объект <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>StreamWriter</span></span>
  для добавления текста к файлу</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CopyTo()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Копирует существующий файл в новый файл</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Create()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт файл и возвращает объект <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>FileStream</span></span> для работы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CreateText()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт объект <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>StreamWriter</span></span>
  для записи текста в новый файл</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Decrypt()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Дешифрует файл, зашифрованный методом <span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Encrypt()</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Directory</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, каталог файла</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>DirectoryName</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, полный путь к файлу</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Encrypt()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Шифрует файл с учётом системных данных текущего пользователя</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsReadOnly</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Булево свойство. Указывает, является ли файл файлом только для
  чтения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Length</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство для чтения, размер файла в байтах</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>MoveTo()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Перемещает файл (возможно, с переименованием)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Open()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Открывает файл с указанными правами доступа</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>OpenRead()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт объект <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>FileStream</span></span>,
  доступный только для чтения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>OpenText()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт объект <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>StreamReader</span></span>
  для чтения информации из текстового файла</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>OpenWrite()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Создаёт объект <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>FileStream</span></span>,
  доступный для чтения и записи</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Как правило, код, работающий с данными файла, вначале
вызывает метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Open()</span></span>.
Рассмотрим перегруженную версию метода <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Open()</span></span> с тремя параметрами.
Первый параметр определяет режим запроса на открытие файла. Для него
используются значения из перечисления <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileMode</span></span>:</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Append</span></span>
– открывает файл, если он существует, и ищет конец файла. Если файл не
существует, то он создаётся. Этот режим может использоваться только с доступом <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileAccess</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Write</span></span>;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Create</span></span>
– указывает на создание нового файла. Если файл существует, он будет
перезаписан;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CreateNew</span></span>
– указывает на создание нового файла. Если файл существует, генерирует
исключение <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IOException</span></span>;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Open</span></span>
– операционная система должна открыть существующий файл;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>OpenOrCreate</span></span>
– операционная система должна открыть существующий файл или создать новый, если
файл не существует;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Truncate</span></span>
– система должна открыть существующий файл и обрезать его до нулевой длины.</p>

<p class=MsoNormal>Рис. 4 показывает выбор <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileMode</span></span> в зависимости от задачи.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_7"
 o:spid="_x0000_i1039" type="#_x0000_t75" style='width:481.5pt;height:448.5pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image005.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 4. Выбор значения <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileMode</span></span>.</p>

<p class=MsoNormal>Второй параметр метода <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Open()</span></span> определяет тип доступа к
данным файла. Для него используются элементы перечисления <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileAccess</span></span>:</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Read</span></span>
– файл будет открыт только для чтения;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadWrite</span></span>
– файл будет открыт и для чтения, и для записи;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Write</span></span>
– файл открывается только для записи, то есть добавления данных.</p>

<p class=MsoNormal>Третий параметр задаёт возможность совместной работы с
открытым файлом и представлен значениями перечисления <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileShare</span></span>:</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>None</span></span>
– совместное использование запрещено, на любой запрос на открытие файла будет
возвращено сообщение об ошибке;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Read</span></span>
– файл могут открыть и другие пользователи, но только для чтения;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadWrite</span></span>
– другие пользователи могут открыть файл и для чтения, и для записи;</p>

<p class=MsoNormal><span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Write</span></span>
– файл может быть открыт другими пользователями для записи.</p>

<p class=MsoNormal>Вот пример кода, использующего метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Open()</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> file = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileInfo</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>@&quot;C:\Test.txt&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileStream</span></span><span
lang=EN-US> fs = file.Open(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileMode</span></span>.OpenOrCreate,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileAccess</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ReadWrite</span><span
style='mso-ansi-language:RU'>, </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileShare</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>None</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Кроме методов класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileInfo</span></span>, статический класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>
обладает методами, позволяющими легко прочитать и записать информацию,
содержащуюся в файле определённого типа:</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.AppendAllLines()</span></span> – добавляет к текстовому файлу
набор строк;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.AppendAllText()</span></span> – добавляет строку к текстовому
файлу;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.ReadAllBytes()</span></span> – возвращает содержимое файла как
массив байтов;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.ReadAllLines()</span></span> – читает текстовый файл как массив
строк;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.ReadLines()</span></span> – читает файл как коллекцию строк,
используя отложенные вычисления;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.ReadAllText()</span></span> – читает содержимое текстового файла
как строку;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.WriteAllBytes()</span></span> – записывает в файл массив байтов;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.WriteAllLines()</span></span> – записывает в файл массив или
коллекцию строк;</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>File</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.WriteAllText()</span></span> – записывает текстовый файл как одну
строку;</p>

<p class=MsoNormal>Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ZipArchive</span></span><span lang=EN-US> </span>и
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipFile</span></span><span
lang=EN-US> </span>из пространства имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.IO.Compression</span></span><a
style='mso-footnote-id:ftn14' href="#_ftn14" name="_ftnref14" title=""><span
class=MsoFootnoteReference><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span lang=EN-US style='font-size:14.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
RU;mso-bidi-language:AR-SA'>[14]</span></span><![endif]></span></span></span></a><span
lang=EN-US> </span>обеспечивают работу с <span lang=EN-US style='mso-ansi-language:
EN-US'>ZIP</span>-архивами. Статические методы класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipFile</span></span><span
lang=EN-US> </span>позволяют создать архив из файлов указанного каталога,
извлечь файлы из архива и открыть архив, вернув объект класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipArchive</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создаём архив<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// (можно дополнительно указать степень сжатия)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipFile</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>CreateFromDirectory</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>@&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>C</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>:\</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Temp</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>\</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Data</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
style='mso-ansi-language:RU'>, </span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>@&quot;C:\MyArchive.zip&quot;</span></span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// разархивируем<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipFile</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ExtractToDirectory</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>@&quot;C:\MyArchive.zip&quot;</span></span><span
style='mso-ansi-language:RU'>, </span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>@&quot;C:\NewFolder&quot;</span></span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ZipArchive</span></span> представляет пакет сжатых файлов и
ориентирован на использование совместно с потоками данных. Отдельный файл
архива описывается объектом класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ZipArchiveEntry</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
style='mso-ansi-language:RU'> (</span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipArchive</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>zip</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ZipFile</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>OpenRead</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>@&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>C</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>:\</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MyArchive</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>.</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>zip</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
style='mso-ansi-language:RU'>))<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ZipArchiveEntry</span></span> entry </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> zip.Entries)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>entry</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>FullName</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
предполагается некая работа с потоком данных<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>stream</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>entry</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Open</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Статический класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Path</span></span> предназначен для работы с
именами файлов и путями в файловой системе. Методы этого класса позволяют
выделить имя файла из полного пути, скомбинировать для получения пути имя файла
и имя каталога. Также класс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Path</span></span> обладает методами, генерирующими
имя для временного файла или каталога. Для поиска стандартных папок (например, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>My Documents</span></span>)
следует применять метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>GetFolderPath()</span></span> класса <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Environment</span></span>,
указав в качестве аргумента одно из значений перечисления <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Environment</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SpecialFolder</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> tempFile = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Path</span></span>.GetTempFileName(); <span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// c:\Temp\tmp144A.tmp</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> ext = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Path</span></span>.GetExtension(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;info.txt&quot;</span></span><span
lang=EN-US>); <span style='mso-spacerun:yes'>  </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// .txt</span></span></p>

<p class=aCxSpMiddle><a name="OLE_LINK6"><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> win =</span></a></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK6'><span lang=EN-US><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>     </span><span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Environment</span></span>.GetFolderPath(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Environment</span></span>.<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>SpecialFolder</span></span>.Windows);</span></span></p>

<span style='mso-bookmark:OLE_LINK6'></span>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>FileSystemWatcher</span></span> позволяет производить мониторинг
активности выбранного каталога. У этого класса определены события, которые
генерируются, когда файлы или подкаталоги создаются, удаляются, модифицируются,
или изменяются их атрибуты. Применение класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileSystemWatcher</span></span> демонстрирует
следующий фрагмент кода:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создаём и настраиваем объект </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>FileSystemWatcher</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> watcher = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileSystemWatcher</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                  </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span>Path = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>@&quot;C:\Temp&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span><span
style='mso-spacerun:yes'> </span>Filter = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;*.txt&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span>IncludeSubdirectories = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                  </span>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>устанавливаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>обработчики</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>событий</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileSystemEventHandler</span></span><span
lang=EN-US> handler = (o, e) =&gt;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;File {0} was {1}&quot;</span></span><span
lang=EN-US>, e.FullPath, e.ChangeType);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>watcher.Created += handler;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>watcher.Changed += handler;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>watcher.Deleted += handler;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>watcher.Renamed += (o, e) =&gt;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Renamed: {0} -&gt;
{1}&quot;</span></span><span lang=EN-US>, e.OldFullPath, e.FullPath);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>watcher.Error += (o, e) =&gt;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Error: {0}&quot;</span></span><span
lang=EN-US>, e.GetException().Message);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>запускаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>мониторинг</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>watcher.EnableRaisingEvents = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Monitoring is on. Press
&lt;enter&gt; to exit&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.ReadLine();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>останавливаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>мониторинг</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>уничтожаем</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> <span lang=EN-US>FileSystemWatcher<o:p></o:p></span></span></span></p>

<p class=aCxSpLast><span lang=EN-US>watcher.Dispose();</span></p>

<h1><a name="_Toc348862504">17. Ввод и вывод информации</a></h1>

<p class=MsoNormal>Платформа .NET содержит развитый набор типов для операций
ввода и вывода информации. Типы для поддержки ввода/вывода можно разбить на две
категории: типы для представления потоков данных и адаптеры потоков. <span
class=a2>Поток данных</span> – это абстрактное представление данных в виде
последовательности байтов. Поток либо ассоциируется с неким физическим
хранилищем (файлами на диске, памятью, сетью), либо декорирует (обрамляет)
другой поток, преобразуя данные тем или иным образом. <span class=a2>Адаптеры
потоков</span> служат оболочкой потока, преобразуя информацию определённого
формата в набор байтов (сами адаптеры потоками не являются).</p>

<h2>17.1. Потоки данных и декораторы потоков</h2>

<p class=MsoNormal>Представим наиболее часто используемые классы для работы с
потоками в виде следующих категорий.</p>

<p class=MsoNormal><span class=af6>1. Абстрактный класс </span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.IO.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span><span
class=af6>.</span> Это базовый класс для других классов, представляющих потоки.</p>

<p class=af5>2. Классы для работы с потоками, связанными с хранилищами.</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>FileStream</span></span> – класс для работы с файлами, как с
потоками (пространство имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.IO</span></span>).</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>MemoryStream</span></span> – класс для представления потока в
памяти (пространство имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.IO</span></span>).</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>NetworkStream</span></span> – работа с сокетами, как с потоками
(пространство имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Net.Sockets</span></span>).</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>PipeStream</span></span><span lang=EN-US> </span>– абстрактный
класс из пространства имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.IO.Pipes</span></span>, базовый для классов-потоков, которые
позволяют передавать данные между процессами операционной системы.</p>

<p class=af5>3. Декораторы потоков.</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DeflateStream</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GZipStream</span></span> – классы для потоков
со сжатием данных (пространство имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.IO.Compression</span></span>).</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CryptoStream</span></span> – поток зашифрованных данных (пространство
имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Security.Cryptography</span></span>).</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BufferedStream</span></span> – поток с поддержкой буферизации
данных (пространство имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.IO</span></span>).</p>

<p class=af5>4. Адаптеры потоков.</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BinaryReader</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BinaryWriter</span></span> – классы для ввода и
вывода примитивных типов в двоичном формате.</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StreamReader</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StreamWriter</span></span> – классы для ввода и
вывода информации в строковом представлении.</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlReader</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlWriter</span></span> – абстрактные классы
для ввода/вывода XML.</p>

<p class=MsoNormal>Элементы абстрактного класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span> сведены
в табл. 13.</p>

<p class=ae>Таблица 13</p>

<p class=af>Элементы абстрактного класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.1%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="20%" style='width:20.58%;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Категория</p>
  </td>
  <td width="79%" style='width:79.42%;border:solid windowtext 1.0pt;border-left:
  none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Элементы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="20%" rowspan=6 style='width:20.58%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Чтение данных</p>
  </td>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>bool</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> CanRead { </span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>get</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>; }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>IAsyncResult</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> BeginRead(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>byte</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>[] buffer, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> count,<o:p></o:p></span></span></p>
  <p class=afb><span class=af3><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-ansi-language:
  EN-US'><span style='mso-spacerun:yes'>                       </span></span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>AsyncCallback</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> callback, </span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>object</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> state)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> EndRead(</span></span><span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>IAsyncResult</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> asyncResult)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> Read(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>byte</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>[] buffer, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> count)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Task</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>&lt;</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>&gt; ReadAsync(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>byte</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>[] buffer, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> count)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> ReadByte()<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width="20%" rowspan=8 style='width:20.58%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Запись<span style='mso-ansi-language:EN-US'> </span>данных<span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>bool</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> CanWrite { </span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>get</span></span><span class=af3><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>; }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>IAsyncResult</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> BeginWrite(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>byte</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>[] buffer, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> count,<o:p></o:p></span></span></p>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'><span
  style='mso-spacerun:yes'>                        </span>AsyncCallback</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> callback, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>object</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> state)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> EndWrite(</span></span><span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>IAsyncResult</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> asyncResult)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> Write(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>byte</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>[] buffer, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> count)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Task</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> WriteAsync(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>byte</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>[] buffer, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>int</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> count)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> WriteByte(</span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>byte</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> value)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> CopyTo(</span></span><span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Stream</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> destination)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Task</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> CopyToAsync(</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Stream</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> destination)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width="20%" rowspan=5 style='width:20.58%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Перемещение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>bool</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> CanSeek { </span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>get</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>; }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>long</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> Position { </span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>get</span></span><span class=af3><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>; </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>set</span></span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>;
  }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> SetLength(</span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>long</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> value)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>long</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> Length { </span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>get</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>; }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>long</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> Seek(</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>long</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> offset, </span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>SeekOrigin</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> origin)<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20'>
  <td width="20%" rowspan=4 style='width:20.58%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Закрытие<span style='mso-ansi-language:EN-US'> </span>потока<span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> Close()<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:21'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> Dispose()<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:22'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>void</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> Flush()<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:23'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Task</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'> </span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'>Flush</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Async()<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:24'>
  <td width="20%" rowspan=3 style='width:20.58%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Таймауты<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>bool</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> CanTimeout { </span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>get</span></span><span class=af3><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>; }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:25'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> ReadTimeout { </span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>get</span></span><span class=af3><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>; </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>set</span></span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>;
  }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:26'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> WriteTimeout { </span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>get</span></span><span class=af3><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>; </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>set</span></span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>;
  }<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:27'>
  <td width="20%" rowspan=2 style='width:20.58%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Другие<span style='mso-ansi-language:EN-US'> </span>члены</p>
  </td>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>static
  readonly</span></span><span class=af3><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'> </span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Stream</span></span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>
  Null<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:28;mso-yfti-lastrow:yes'>
  <td width="79%" style='width:79.42%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>static</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'> </span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Stream</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> Synchronized(</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Stream</span></span><span class=af3><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman";mso-ansi-language:EN-US'> stream)<o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Stream</span></span> вводит поддержку асинхронных операций
ввода/вывода. Для этого служат методы вида <span class=af4><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ИмяОперации</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Async()</span></span> (например, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadAsync()</span></span>). Такие
методы имеют перегруженные версии с дополнительным параметром – токеном отмены<a
style='mso-footnote-id:ftn15' href="#_ftn15" name="_ftnref15" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[15]</span></span><![endif]></span></span></a>.
Асинхронный ввод/вывод поддерживается также при помощи методов <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BeginRead()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BeginWrite()</span></span>. Однако, это
устаревший шаблон использования асинхронных операций<a style='mso-footnote-id:
ftn16' href="#_ftn16" name="_ftnref16" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[16]</span></span><![endif]></span></span></a>.</p>

<p class=MsoNormal>Статический метод <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Synchronized()</span></span> возвращает
оболочку для потока, которая обеспечивает безопасность при совместной работе
нескольких <span class=a2>потоков выполнения</span> (threads).</p>

<p class=MsoNormal>Использование методов и свойств класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span> будет
показано на примере работы с классом <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileStream</span></span>. Объект класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileStream</span></span><span
lang=EN-US> </span>возвращается некоторыми методами классов <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileInfo</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.
Кроме этого, данный объект можно создать при помощи конструктора с параметрами,
включающими имя файла и опции доступа к файлу.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создаём файл test.dat в текущем каталоге и
записываем 100 байтов<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> fs = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileStream</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;test.dat&quot;</span></span><span lang=EN-US>, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>FileMode</span></span>.OpenOrCreate);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US> i = 0; i &lt; 100; i++)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>fs</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteByte</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>i</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// можно записать информацию из массива байтов</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// первый аргумент метода Write() – массив,
второй – смещение<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// в массиве, третий – количество записываемых
байтов<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
lang=EN-US>[] info = {1, 2, 3, 4, 5, 6, 7, 8, 9};</span></p>

<p class=aCxSpMiddle><span lang=EN-US>fs.Write(info, 2, 4);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// возвращаемся на начало потока и читаем все
байты<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>fs.Position = 0;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>while</span></span><span
lang=EN-US> (fs.Position &lt; fs.Length)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Write</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>fs</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ReadByte</span><span
style='mso-ansi-language:RU'>());<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// закрываем поток (и файл), освобождая ресурсы<o:p></o:p></span></span></p>

<p class=aCxSpLast><span lang=EN-US>fs</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Close</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>MemoryStream</span></span> даёт возможность организовать поток в
оперативной памяти. Свойство <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Capacity</span></span> этого класса позволяет получить или
установить количество байтов, выделенных под поток. Метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ToArray()</span></span> записывает все
содержимое потока в массив байтов. Метод <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WriteTo()</span></span> переносит содержимое
потока из памяти в другой поток, производный от класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span>.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BufferedStream</span></span> – это декоратор потока для повышения
производительности путём буферизации данных. В примере кода <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BufferedStream</span></span>
работает с <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>FileStream</span></span>,
предоставляя 20000 байтов буфера. То есть, второе физическое обращение к файлу
произойдёт только при чтении 20001-го байта<a style='mso-footnote-id:ftn17'
href="#_ftn17" name="_ftnref17" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[17]</span></span><![endif]></span></span></a>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// записываем 100000 байтов в файл<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteAllBytes</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>myFile</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bin</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>byte</span></span><span
style='mso-ansi-language:RU'>[100000]);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>читаем</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>используя</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>буфер</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileStream</span></span> fs = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.OpenRead(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;myFile.bin&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>using</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> bs = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BufferedStream</span></span>(fs, 20000))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>bs.ReadByte();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(fs.Position); <span
style='mso-spacerun:yes'>   </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// 20000</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DeflateStream</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GZipStream</span></span>
являются декораторами потока, реализующими сжатие данных. Они различаются тем,
что <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GZipStream</span></span>
записывает дополнительные данные о протоколе сжатия в начало и конец потока. В
следующем примере сжимается и восстанавливается текстовый поток из 1000 слов.</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>формируем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>набор</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>из</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> 1000
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>слов</span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> words = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;The quick brown fox
jumps over the lazy dog&quot;</span></span><span lang=EN-US>.Split();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> rnd = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span>();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> text = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Repeat(0, 1000)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span>.Select(i =&gt;
words[rnd.Next(words.Length)]);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
using </span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>обеспечит</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>корректное</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>закрытие</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>потоков</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> s = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;compressed.bin&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>using</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> ds = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DeflateStream</span></span>(s, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CompressionMode</span></span>.Compress))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>using</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextWriter</span></span> w = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamWriter</span></span>(ds))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>foreach</span></span><span lang=EN-US> (</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span><span lang=EN-US> word </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> text)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>w.Write(word + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot; &quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> s = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.OpenRead(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;compressed.bin&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>using</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> ds = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DeflateStream</span></span>(s,CompressionMode.Decompress))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>using</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextReader</span></span> r = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamReader</span></span>(ds))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(r.ReadToEnd());</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<h2><span lang=EN-US style='mso-ansi-language:EN-US'>17.2. </span>Адаптеры<span
style='mso-ansi-language:EN-US'> </span>потоков<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal>Перейдём к рассмотрению классов-адаптеров для потоков.
Классы <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BinaryReader</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BinaryWriter</span></span>
позволяют при помощи своих методов читать и записывать в поток данные
примитивных типов и массивов байтов или символов. Вся информация записывается в
поток в двоичном представлении. Рассмотрим работу с этими классами на примере
типа <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>,
который может записать свои данные в поток.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>  </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Age { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>double</span></span><span lang=EN-US> GPA { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; } <span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// Grade Point Average</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US>
SaveBinaryToStream(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> stream)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
конструктор позволяет &quot;обернуть&quot; адаптер вокруг потока<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> bw = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BinaryWriter</span></span>(stream);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// BinaryWriter имеет 18 перегруженных версий
метода Write()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>bw.Write(Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>bw.Write(Age);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>bw.Write(GPA);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>убеждаемся</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>что</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>буфер</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> <span lang=EN-US>BinaryWriter </span></span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пуст</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>bw.Flush();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US>
ReadBinaryFromStream(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> stream)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> br = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BinaryReader</span></span>(stream);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// для чтения каждого примитивного типа есть
свой метод<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>Name =
br.ReadString();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Age = br.ReadInt32();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>GPA</span><span style='mso-ansi-language:RU'> = </span><span lang=EN-US>br</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ReadDouble</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Абстрактные классы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TextReader</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TextWriter</span></span> дают
возможность читать и записывать данные в поток в строковом представлении. При
этом имеется поддержка асинхронного выполнения (методы вида <span class=af4><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ИмяОперации</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Async()</span></span>). От этих классов
наследуются классы <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StreamReader</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StreamWriter</span></span>. Представим методы
для работы с данными класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> с использованием <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamReader</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamWriter</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> SaveToStream(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> stream)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> sw = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StreamWriter</span></span>(stream);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// запись напоминает вывод на консоль (и не
случайно)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>sw.WriteLine(Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>sw.WriteLine(Age);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>sw.WriteLine(GPA);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>sw.Flush();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> ReadFromStream(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span> stream)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> sr = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StreamReader</span></span>(stream);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// читаем данные как строки</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>Name</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>sr</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ReadLine</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>Age = <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Int32</span></span>.Parse(sr.ReadLine());</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>GPA = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Double</span></span>.Parse(sr.ReadLine());</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h1><a name="_Toc348862505">18. Основы XML и </a><span style='mso-bookmark:
_Toc348862505'><span lang=EN-US style='mso-ansi-language:EN-US'>JSON</span></span></h1>

<p class=MsoNormal><span class=a2>Расширяемый язык разметки</span> (eXtensible
Markup Language, XML) – это способ описания структурированных данных. <span
class=a2>Структурированными данными</span> называются такие данные, которые
обладают заданным набором семантических атрибутов и допускают иерархическое
описание. XML-данные содержатся в <span class=a2>документе</span>, в роли
которого может выступать файл, поток или другое хранилище информации, способное
поддерживать текстовый формат.</p>

<p class=MsoNormal>Любой XML-документ строится по определённым правилам. Ниже
перечислены правила, следовать которым обязательно.</p>

<p class=MsoNormal><span class=af6>1. Единица информации – XML-элемент.</span>
XML-документ состоит из XML-элементов. Каждый элемент определяется при помощи <span
class=a2>имени</span>, <span class=a2>открывающего тега</span> и <span
class=a2>закрывающего тега</span>. Открывающий тег элемента записывается в
форме <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>имя-элемента</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>,
закрывающий тег – в форме <span class=ac><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&lt;/</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>имя-элемента</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>.
Между открывающим и закрывающим тегами размещается <span class=a2>содержимое
элемента</span>. Если содержимое элемента отсутствует, то элемент может быть
записан в форме <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>имя-элемента</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> /&gt;</span></span>
или <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>имя-элемента</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>/&gt;</span></span>.</p>

<p class=MsoNormal><span class=af6>2. Иерархия элементов.</span> Содержимым
XML-элемента может быть текст, пробельные символы (пробелы, табуляции, переводы
строки), а также другие XML-элементы. Допускается комбинация указанного содержимого
(например, элемент может содержать и текст, и вложенные элементы). Элементы
должны быть правильно вложены друг в друга – если элемент <span class=ad><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>A</span></span> вложен в
элемент <span class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>B</span></span>,
то закрывающий тег <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;/</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>A</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span> должен
находиться перед закрывающим тегом <span class=ac><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&lt;/</span></span><span class=ad><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>B</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>.</p>

<p class=MsoNormal><span class=af6>3. Корневой элемент.</span> В XML-документе
всегда должен быть единственный элемент, называемый <span class=a2>корневым</span>,
никакая часть которого не входит в содержимое любого другого элемента. Иначе
говоря, корневой элемент обрамляет все остальные элементы документа.</p>

<p class=MsoNormal><span class=af6>4. Синтаксис имён элемента.</span> Имена
элементов чувствительны к регистру. Имена могут содержать буквы, цифры, дефисы
(<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>-</span></span>),
символы подчёркивания (<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>_</span></span>),
двоеточия (<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>:</span></span>)
и точки (<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>.</span></span>),
однако должны начинаться только с буквы или символа подчёркивания. Двоеточие
может быть использовано только в специальных случаях – при записи префикса
пространства имён. Имена, начинающиеся с <span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xml</span></span> (вне зависимости от
регистра), зарезервированы для нужд XML.</p>

<p class=MsoNormal><span class=af6>5. Специальные символы.</span> Некоторые
символы не могут использоваться в тексте содержимого элементов, так как
применяются в разметке документа. Эти символы могут быть обозначены особым
образом:</p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;</span></span><span class=XML><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>amp</span></span><span class=XML><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>;</span></span><span
style='mso-tab-count:1'>      </span>символ <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&amp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;lt;</span></span><span style='mso-tab-count:1'> </span><span
style='mso-tab-count:1'>        </span>символ <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;gt;</span></span><span style='mso-tab-count:2'>        </span>символ
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span></p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;</span></span><span class=XML><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>quot</span></span><span class=XML><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>;</span></span><span
style='mso-tab-count:1'>    </span>символ <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;<o:p></o:p></span></span></p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;apos;</span></span><span style='mso-tab-count:1'>    </span>символ
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>'</span></span></p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;#</span></span><span class=XML><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span class=XML><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>;</span></span><span
style='mso-tab-count:1'>    </span>Unicode-символ с десятичным кодом <span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span></p>

<p class=MsoNormal><span class=XML><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&amp;#xhex;</span></span><span style='mso-tab-count:1'>   </span>Unicode-символ
с шестнадцатеричным кодом <span class=af4><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>hex</span></span></p>

<p class=MsoNormal><span class=af6>6. Атрибуты элемента.</span> Любой
XML-элемент может содержать один или несколько <span class=a2>атрибутов</span>,
записываемых в открывающем теге. Правила на имена атрибутов накладываются такие
же, как и на имена элементов. Имена атрибутов отделяются от их значений
символом <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=</span></span>.
Значение атрибута заключается в апострофы или в двойные кавычки. Если апостроф
или двойные кавычки присутствуют в значении атрибута, то для обрамления
используются те из них, которые не встречаются в значении. Приведём<span
style='mso-ansi-language:EN-US'> </span>пример<span style='mso-ansi-language:
EN-US'> </span>элементов<span style='mso-ansi-language:EN-US'> </span>с<span
style='mso-ansi-language:EN-US'> </span>атрибутами<span lang=EN-US
style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>elements-with-attributes</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>one</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>attr</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;value&quot;/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>several</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>first</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;1&quot; </span></span><span class=XML><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>second</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;2&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>third</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;3&quot;/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>apos-quote</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>case1</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;John's&quot; </span></span><span class=XML><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>case2</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>='He said:&quot;Hello, world!&quot;'/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>elements-with-attributes</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span class=af6><span lang=EN-US style='mso-ansi-language:
EN-US'>7. </span>Особые</span><span class=af6><span style='mso-ansi-language:
EN-US'> </span>части</span><span class=af6><span lang=EN-US style='mso-ansi-language:
EN-US'> XML-</span>документа</span><span class=af6><span lang=EN-US
style='mso-ansi-language:EN-US'>.</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>Кроме элементов, XML-документ может
содержать <span class=a2>XML-декларацию</span>, <span class=a2>комментарии</span>,
<span class=a2>инструкции по обработке</span>, <span class=a2>секции CDATA</span>.</p>

<p class=MsoNormal>XML-документ может начинаться с XML-декларации, определяющей
используемую версию XML, кодировку XML-документа и наличие внешних зависимостей
(обязательным атрибутом является только версия):</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;?</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>xml</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>version</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;1.0&quot; </span></span><span class=XML><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>encoding</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;utf-8&quot; </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>standalone</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;yes&quot; ?&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Комментарии размещаются в любом месте документа и
записываются в обрамлении <span class=aa><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;!--</span></span> и <span class=aa><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>--&gt;</span></span>. В тексте комментариев не должна содержаться
последовательность из двух знаков дефиса.</p>

<p class=MsoNormal>XML-документ может содержать инструкции по обработке,
несущие информацию для внешних приложений. Инструкции по обработке записываются
в обрамлении <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;?</span></span> и <span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>?&gt;</span></span>.</p>

<p class=MsoNormal>Секция CDATA используется для того, чтобы обозначить части
документа, которые не должны восприниматься как разметка. Секция CDATA
начинается со строки <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;![</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CDATA</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>[</span></span> и
заканчивается строкой <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>]]&gt;</span></span>. Внутри самой секции не должна
присутствовать строка <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>]]&gt;</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>example</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;![CDATA[ </span></span><span class=af0><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>&lt;aaa&gt;bb&amp;cc&lt;&lt;&lt;</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]]&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>example</span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Если XML-документ оформлен по описанным выше правилам, то он
называется <span class=a2>правильно построенным документом</span> (well-formed
document). Если правильно построенный XML-документ удовлетворяет некой
семантической схеме, задающей его структуру и содержание, то он называется <span
class=a2>действительным документом</span> (valid document).</p>

<p class=MsoNormal>Приведём XML-документ с описанием планет, который будет
использован далее в примерах кода:</p>

<p class=aCxSpFirst><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;?</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xml</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'> </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>version</span></span><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>=&quot;1.0&quot;
</span></span><span class=XML><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>encoding</span></span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>=&quot;</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>utf</span></span><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>-8&quot;
?&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;!-- первые четыре планеты --&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planets</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Mercury</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Venus</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Earth</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Moon</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>period</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>units</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;days&quot;&gt;</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>27.321582</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;/</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>period</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Mars</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Phobos</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>period</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>units</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;days&quot;&gt;</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>0.318</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>period</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Deimos</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>period</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>units</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;days&quot;&gt;</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>1.26244</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>period</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planets</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_35"
 o:spid="_x0000_i1038" type="#_x0000_t75" style='width:464.25pt;height:230.25pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image006.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 5. Древовидная структура XML-данных.</p>

<p class=MsoNormal>Отметим, что при описании дерева XML-элементов используются
следующие термины (см. рис. 5):</p>

<p class=MsoNormal>1. <span class=a2>Текущий элемент</span> (self);</p>

<p class=MsoNormal>2. <span class=a2>Предок</span> (ancestor) – любой элемент,
содержащий текущий;</p>

<p class=MsoNormal>3. <span class=a2>Корень</span> (root) – предок всех
элементов;</p>

<p class=MsoNormal>4. <span class=a2>Родитель</span> (parent) –
непосредственный предок текущего элемента;</p>

<p class=MsoNormal>5. <span class=a2>Потомок</span> (descendant) – любой
элемент, вложенный в текущий;</p>

<p class=MsoNormal>6. <span class=a2>Ребёнок</span> (child) – непосредственный
потомок текущего элемента;</p>

<p class=MsoNormal>7. <span class=a2>Сиблинги</span> (siblings) – элементы,
имеющие общего родителя.</p>

<p class=MsoNormal>В XML-документе с описанием планет элемент <span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>name</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
используется и как имя планеты, и как имя луны. Ссылки на <span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>name</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
будут неоднозначны – два одинаковых имени несут разную смысловую нагрузку. Для
устранения неоднозначности и обеспечения семантической уникальность элемента
предназначены <span class=a2>пространства имён XML</span>.</p>

<p class=MsoNormal>Чтобы связать элемент с пространством имён, используется
специальный атрибут <span class=XML><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>xmlns</span></span>. Обычно для идентификатора пространства имён
используют <span class=a2>унифицированный идентификатор ресурса</span> (<span
lang=EN-US style='mso-ansi-language:EN-US'>Uniform</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Resource</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Identifier</span>, URI), чтобы
уменьшить риск совпадения идентификаторов в разных документах.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;!-- фрагмент документа с планетами --&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planet</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xmlns</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;http://astronomy.com/planet&quot; &gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Earth</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xmlns</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;http://astronomy.com/moon&quot; &gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Moon</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>period</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>units</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;days&quot;&gt;</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>27.321582</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;/</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>period</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span></span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;/</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>planet</span></span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Чтобы не задавать атрибут <span class=XML><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xmlns</span></span> у каждого элемента,
действуют следующие правила. Считается, что пространство имён, заданное у
элемента, автоматически распространяется на все дочерние элементы. Также при описании
пространства имён можно определить <span class=a2>префикс</span>, который затем
записывается перед именем требуемых элементов через двоеточие. Атрибуты также
могут быть связаны с пространствами имён при помощи префиксов.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;!-- пространства имён обычно определяют в
начале документа --&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planets</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> </span></span><span class=XML><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>xmlns</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;http://astronomy.com/planet&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>         </span></span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>xmlns:m</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;http://astronomy.com/moon&quot;&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Earth</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>m:moon</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>m:name</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Moon</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>m:name</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>m:period</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>m:units</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;days&quot;&gt;</span></span><span class=a3><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>27.321582</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;/</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>m:period</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span></span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;/</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>m</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>:</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>moon</span></span><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>planet</span></span><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planets</span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span class=a2>JSON</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>JavaScript</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Object</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Notation</span>) – простой текстовый
формат обмена данными, удобный для чтения и записи как человеком, так и
компьютером. Он основан на подмножестве языка программирования JavaScript.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>JSON</span><span
lang=EN-US> </span>строится на двух структурах:</p>

<p class=MsoNormal>– <span class=a2>Коллекция пар ключ/значение</span>. В
разных языках, эта концепция реализована как объект, запись, структура, словарь
или ассоциативный массив.</p>

<p class=MsoNormal>– <span class=a2>Упорядоченный список значений</span>. В
большинстве языков это реализовано как массив, вектор, список или
последовательность.</p>

<p class=MsoNormal>В нотации JSON эти структуры принимают следующие формы:</p>

<p class=MsoNormal>1. <span class=a2>Объект</span> – неупорядоченный набор пар
ключ/значение. Объект начинается с открывающей фигурной скобки и заканчивается закрывающей
фигурной скобкой. Каждое имя ключа сопровождается двоеточием, пары
ключ/значение разделяются запятой.</p>

<p class=MsoNormal>2. <span class=a2>Массив</span> – упорядоченная коллекция
значений. Массив начинается с открывающей квадратной скобки и заканчивается
закрывающей квадратной скобкой. Значения разделены запятой.</p>

<p class=MsoNormal><span class=a2>Значение</span> может быть <span class=a2>строкой</span>,
<span class=a2>числом</span>, <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span>, <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>false</span></span>, <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span>,
<span class=a2>объектом</span> или <span class=a2>массивом</span>. Эти структуры
могут быть вложенными. <span class=a2>Строка&nbsp;</span>– коллекция нуля или
больше символов Unicode, заключённая в двойные кавычки. Число представляется
так же, как в C# (используется только десятичная система счисления). Пробелы
могут использоваться между любыми лексемами. Исключая некоторые детали
кодирования, вышеизложенное полностью описывает JSON<a style='mso-footnote-id:
ftn18' href="#_ftn18" name="_ftnref18" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[18]</span></span><![endif]></span></span></a>.</p>

<p class=MsoNormal>Приведём пример простейшего <span lang=EN-US
style='mso-ansi-language:EN-US'>JSON</span>-документа (описание объекта,
представляющего информацию о студенте с набором оценок):</p>

<p class=aCxSpFirst><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;id&quot;</span></span><span lang=EN-US>:
12,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>:
</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Petrov&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;marks&quot;</span></span><span
lang=EN-US>: [10, 8, 7, 9]</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<h1><a name="_Toc348862506"><span lang=EN-US style='mso-ansi-language:EN-US'>19.
</span>Технология</a><span style='mso-bookmark:_Toc348862506'><span lang=EN-US
style='mso-ansi-language:EN-US'> LINQ to XML</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></h1>

<p class=MsoNormal>Технология LINQ to XML предоставляет программный интерфейс
для работы с XML-документами, описываемыми в виде дерева объектов. Этот
программный интерфейс обеспечивает создание, редактирование и трансформацию
XML, при этом возможно применение LINQ-подобного синтаксиса.</p>

<p class=MsoNormal>LINQ to XML содержит набор классов, сосредоточенных в
пространстве имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Xml.Linq</span></span>
(рис. 6):</p>

<p class=MsoNormal>1. Абстрактные классы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XObject</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNode</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XContainer</span></span>
служат основой для иерархии классов, соответствующих различным объектам XML.</p>

<p class=MsoNormal>2. Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span>
представляют XML-элемент и XML-документ соответственно.</p>

<p class=MsoNormal>3. Класс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XAttribute</span></span> служит для описания
XML-атрибута.</p>

<p class=MsoNormal>4. Класс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XText</span></span> представляет текст в
XML-элементе.</p>

<p class=MsoNormal>5. Класс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XName</span></span> представляет имя атрибута
или элемента.</p>

<p class=MsoNormal>6. Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XDeclaration</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocumentType</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XProcessingInstruction</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XComment</span></span>
описывают соответствующие части XML-документа.</p>

<p class=MsoNormal>7. Статический класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Extensions</span></span> содержит методы
расширения для выполнения запросов к XML-данным.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_19"
 o:spid="_x0000_i1037" type="#_x0000_t75" style='width:461.25pt;height:225pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image007.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 6. Основные классы LINQ to XML.</p>

<p class=MsoNormal>Центральную роль в работе с XML-данными играют классы <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>.
Для создания отдельного XML-элемента обычно используется один из конструкторов
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>
other);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span>
name);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XStreamingElement</span></span>
other);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span>
name, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> content);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span>
name, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>params object</span></span><span lang=EN-US>[]
content);</span></p>

<p class=MsoNormal>Первая версия конструктора <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span> является копирующим
конструктором, а вторая – создаёт пустой элемент. Обсудим использование
четвёртой версии, которая позволяет указать имя элемента и его содержимое.
Заметим, что существует неявное преобразование строки в <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span>.
Интерпретация аргумента <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>content</span></span> производится по табл. 14.</p>

<p class=ae>Таблица 14</p>

<p class=af>Интерпретация аргумента <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>content</span></span> конструктора класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Тип или значение content</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Способ обработки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>string</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Преобразуется в дочерний объект типа <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>XText</span></span> и добавляется как текстовое содержимое
  элемента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>XText</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавляется как дочерний объект – текстовое содержимое элемента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>XElement</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавляется как дочерний элемент</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>XAttribute</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавляется как атрибут элемента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>XProcessingInstruction</span></span>,</p>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>XComment</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавляется как дочернее содержимое. При добавлении объектов
  типа <span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>XAttribute</span></span> или
  унаследованных от <span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>XNode</span></span>
  выполняется клонирование, если эти объекты уже имеют родителя в дереве
  объектов XML.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>IEnumerable</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Объект перечисляется и обрабатывается рекурсивно. Коллекция
  строк добавляется в виде единого текста</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Null</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Этот объект игнорируется</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Любой прочий тип</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Вызывается метод <span class=af3><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>ToString()</span></span>,
  и результат трактуется как <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>string</span></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Ниже приведены различные варианты вызова конструктора <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e1 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Earth&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;name&gt;Earth&lt;/name&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;planet&quot;</span></span><span lang=EN-US>, e1);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;planet&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span>&lt;name&gt;Earth&lt;/name&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;/planet&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e3 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;period&quot;</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XAttribute</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;units&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;days&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;period units=&quot;days&quot; /&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e4 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;comment&quot;</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XComment</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;the
comment&quot;</span></span><span lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;comment&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span>&lt;!--the comment--&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;/comment&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e5 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;list&quot;</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span>&lt;</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US>&gt; {</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;text&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                  </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Mars&quot;</span></span><span
lang=EN-US>)});</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;list&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span>text&lt;name&gt;Mars&lt;/name&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;/list&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e6 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;moon&quot;</span></span><span lang=EN-US>, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;moon /&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> e7 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;date&quot;</span></span><span lang=EN-US>, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTime</span></span>.Now);</span></p>

<p class=aCxSpLast><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// &lt;date&gt;2010-01-19T11:04:54.625+02:00&lt;/date&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Пятая версия конструктора <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span> подобна четвёртой, но
позволяет предоставить множество объектов для содержимого:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> p = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;planets&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Mercury&quot;</span></span><span
lang=EN-US>)),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Venus&quot;</span></span><span
lang=EN-US>)),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Earth&quot;</span></span><span
lang=EN-US>),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new </span></span><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
lang=EN-US>(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;moon&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>,
</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Moon&quot;</span></span><span lang=EN-US>),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                    </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;period&quot;</span></span><span
lang=EN-US>, 27.321582,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                              </span><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XAttribute</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;units&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;days&quot;</span></span><span
lang=EN-US>)))));</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>p</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// выводим первые три планеты в виде </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>XML</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=MsoNormal>Использование конструктора <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XAttribute</span></span> для создания
XML-атрибута очевидно из приведённых выше примеров. Конструкторы класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span>
позволяют указать декларацию XML-документа и набор объектов содержимого. В этот
набор могут входить комментарии, инструкции по обработке и не более одного
XML-элемента:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> d = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XDeclaration</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;1.0&quot;</span></span><span lang=EN-US>,
</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;utf-8&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;yes&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// используем элемент p из предыдущего примера<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> doc = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XDocument</span></span>(d, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XComment</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;первые
три планеты&quot;</span></span><span lang=EN-US>), p);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(doc.Declaration);<span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>печатаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>декларацию</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>doc</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>               
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// печатаем документ</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Кроме применения конструкторов, объекты XML можно создать из
строкового представления при помощи статических методов <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Parse()</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Parse()</span></span>:</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> planet = <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span>.Parse(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;&lt;name&gt;Earth&lt;/name&gt;&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Для сохранения элемента или XML-документа используется метод
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Save()</span></span>,
имеющийся у <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span>.
Данный метод перегружен и позволяет выполнить запись в текстовый файл или с
применением адаптеров <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextWriter</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlWriter</span></span>. Кроме этого, можно
указать опции сохранения (например, отключить автоматическое формирование
отступов элементов).</p>

<p class=a><span lang=EN-US>doc.Save(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;planets.xml&quot;</span></span><span
lang=EN-US>, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SaveOptions</span></span>.None);</span></p>

<p class=MsoNormal>Загрузка элемента или XML-документа выполняется статическими
методами <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Load()</span></span> или <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Load()</span></span>. Метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Load()</span></span>
перегружен и позволяет выполнить загрузку из файла, произвольного URI, а также
с применением адаптеров <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextReader</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>. Можно задать опции
загрузки (например, связать с элементами XML номер строки в исходном тексте).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> d1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XDocument</span></span>.Load(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planets.xml&quot;</span></span><span
lang=EN-US>, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LoadOptions</span></span>.SetLineInfo);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> d2 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>.Load(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;http://habrahabr.ru/rss/&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Рассмотрим набор методов и свойств, используемых в LINQ to
XML при выборке данных. Класс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XObject</span></span> имеет свойство <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>NodeType</span></span> для
типа XML-узла и свойство <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Parent</span></span>, указывающее, какому элементу принадлежит
узел.</p>

<p class=MsoNormal>Методы классов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XContainer</span></span>
позволяют получить у элемента наборы предков и дочерних узлов (элементов). При
этом возможно указание фильтра – имени элемента. Большинство методов возвращают
коллекции, реализующие <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span><a style='mso-footnote-id:ftn19'
href="#_ftn19" name="_ftnref19" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[19]</span></span><![endif]></span></span></a>.</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>выборки</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>у</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XNode<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
Ancestors();<span style='mso-spacerun:yes'>            </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
ElementsAfterSelf();<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
ElementsBeforeSelf();<span style='mso-spacerun:yes'>   </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> IsAfter(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span> node);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US> IsBefore(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span> node);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNode</span></span>&gt;
NodesAfterSelf();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNode</span></span>&gt;
NodesBeforeSelf();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>выборки</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>у</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XContainer<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNode</span></span>&gt;
DescendantNodes();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
Descendants();<span style='mso-spacerun:yes'>          </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span> Element(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span>
name);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
Elements();<span style='mso-spacerun:yes'>             </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XDocument</span></span> позволяет получить корневой элемент при
помощи свойства <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Root</span></span>.
В классе <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>
есть методы для запроса элементов-предков и элементов-потомков, а также методы
для запроса атрибутов.</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>выборки</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>у</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XElement<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span>&gt; AncestorsAndSelf();<span
style='mso-spacerun:yes'>     </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XAttribute</span></span><span lang=EN-US>
Attribute(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XName</span></span> name);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XAttribute</span></span>&gt; Attributes();<span
style='mso-spacerun:yes'>         </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XNode</span></span>&gt; DescendantNodesAndSelf();</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span lang=EN-US>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span>&gt; DescendantsAndSelf();<span
style='mso-spacerun:yes'>   </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// + XName name</span></span></p>

<p class=MsoNormal>Статический класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Extensions</span></span> определяет несколько
методов расширения, работающих с коллекциями элементов или узлов XML:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
Ancestors&lt;T&gt;(...) </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span><span
lang=EN-US> T: <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
AncestorsAndSelf(...);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>&gt; Attributes(...);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span>&gt;
DescendantNodes&lt;T&gt;(...) </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span><span
lang=EN-US> T: <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XContainer</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span>&gt; DescendantNodesAndSelf(...);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
Descendants&lt;T&gt;(...) </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span><span
lang=EN-US> T: <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XContainer</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
DescendantsAndSelf(...);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>&gt;
Elements&lt;T&gt;(...) </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span><span
lang=EN-US> T: <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XContainer</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;T&gt; InDocumentOrder&lt;T&gt;(...) </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>where</span></span><span lang=EN-US> T: <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNode</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span>&gt; Nodes&lt;T&gt;(...) </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>where</span></span><span lang=EN-US> T: <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XContainer</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>void </span></span><span
lang=EN-US>Remove(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>&gt;
source);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>void </span></span><span
lang=EN-US>Remove&lt;T&gt;(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>&lt;T&gt; source) </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>where</span></span><span lang=EN-US> T: <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XNode</span></span>;</span></p>

<p class=MsoNormal>Продемонстрируем примеры запросов, используя файл <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>planets.xml</span></span> с
описанием четырёх планет. Загрузим файл и выведем имена планет:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>xml</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Load</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planets</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>xml</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> query = xml.Root.Elements(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'>     </span>.Select(planet =&gt; planet.Element(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>).Value);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> name </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> query)</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>    </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span></span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteLine</span><span style='mso-ansi-language:RU'>(</span><span
lang=EN-US>name</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Выберем все элементы с именем <span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>moon</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>,
которые являются потомками корневого элемента. У каждого из элементов возьмём
ребёнка с именем <span class=ad><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>name</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span>:</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>moons</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>xml</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Descendants</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>moon</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>).</span><span
lang=EN-US>Select</span><span style='mso-ansi-language:RU'>(</span><span
lang=EN-US>p</span><span style='mso-ansi-language:RU'> =&gt; </span><span
lang=EN-US>p</span><span style='mso-ansi-language:RU'>.</span><span lang=EN-US>Element</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>name</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>));<o:p></o:p></span></p>

<p class=MsoNormal>Найдём элемент, содержащий указанный текст:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> phobos = xml.DescendantNodes().OfType&lt;<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XText</span></span>&gt;()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>.Where(text =&gt; text.Value ==
</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Phobos&quot;</span></span><span
lang=EN-US>)</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Select</span><span style='mso-ansi-language:RU'>(</span><span
lang=EN-US>text</span><span style='mso-ansi-language:RU'> =&gt; </span><span
lang=EN-US>text</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>Parent</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Модификация XML-информации в памяти выполняется при помощи
следующих методов классов <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNode</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XContainer</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><a
style='mso-footnote-id:ftn20' href="#_ftn20" name="_ftnref20" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[20]</span></span><![endif]></span></span></a>:</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>модификации</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>у</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XNode<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> AddAfterSelf(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>                </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> AddBeforeSelf(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>               </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> Remove();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> ReplaceWith(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'>  </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>модификации</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>у</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XContainer<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void </span></span><span
lang=EN-US>Add(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>                        
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void </span></span><span
lang=EN-US>AddFirst(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>                    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void </span></span><span
lang=EN-US>RemoveNodes();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void </span></span><span
lang=EN-US>ReplaceNodes(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>                </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>методы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>модификации</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>у</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XElement<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> RemoveAll();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> RemoveAttributes();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> ReplaceAll(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>                  </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> ReplaceAttributes(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> content);<span style='mso-spacerun:yes'>           </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// + params</span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> SetAttributeValue(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span> name, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> SetElementValue(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XName</span></span> name, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value);</span></p>

<p class=MsoNormal>Рассмотрим несколько примеров модификации XML. Начнём с
удаления заданных узлов. Для этого используем метод расширения <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Remove&lt;T&gt;()</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>xml</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XDocument</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Load</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>planets</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>xml</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span lang=EN-US>xml.Element(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;planets&quot;</span></span><span lang=EN-US>).Elements(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>).Elements(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;moon&quot;</span></span><span
lang=EN-US>).Remove();</span></p>

<p class=MsoNormal>Продемонстрируем добавление и замену элементов:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> p = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XDocument</span></span>.Load(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planets.xml&quot;</span></span><span
lang=EN-US>).Root;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>p.Add(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> XElement(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Jupiter&quot;</span></span><span
lang=EN-US>)));</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> moon = p.Descendants(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;moon&quot;</span></span><span
lang=EN-US>).First();</span></p>

<p class=aCxSpLast><span lang=EN-US>moon.ReplaceWith(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> XElement(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;DeathStar&quot;</span></span><span lang=EN-US>));</span></p>

<p class=MsoNormal>Покажем добавление атрибута к элементу:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
lang=EN-US> sun = xml.Element(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;planets&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span lang=EN-US>sun.Add(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;MassOfTheSun&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;332.946 Earths&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=MsoNormal>Функциональные конструкторы и поддержка методами выборки
коллекций открывают богатые возможности трансформации наборов объектов в XML. В
следующем примере показано создание XML-документа на основе коллекции студентов
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>gr</span></span>
(коллекция описана в параграфе, посвящённом <span lang=EN-US style='mso-ansi-language:
EN-US'>LINQ</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>to</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>objects</span>):</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> xml = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;students&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>from</span></span><span lang=EN-US> student </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> gr</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>select</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;student&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>,
student.Name),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;age&quot;</span></span><span lang=EN-US>,
student.Age),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>from</span></span><span lang=EN-US> mark </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> student.Marks</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>select new </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
lang=EN-US>(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;mark&quot;</span></span><span
lang=EN-US>, mark)));</span></p>

<p class=MsoNormal>Хотя предыдущий пример использует отложенный оператор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Select()</span></span>,
полная итерация по набору выполняется конструктором класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>. Если
необходимо отложенное конструирование XML-элементов, следует воспользоваться
классом <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XStreamingElement</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>[] names = {</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;John&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Paul&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;George&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Pete&quot;</span></span><span
lang=EN-US>};</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> xml = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XStreamingElement</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Beatles&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                           </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>from</span></span><span lang=EN-US> n </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> names</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                           </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>select</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XStreamingElement</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>, n));</span></p>

<p class=aCxSpLast><span lang=EN-US>names</span><span style='mso-ansi-language:
RU'>[3] = </span><span class=ad><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Ringo</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>;<span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
это присваивание изменит объект </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>xml</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Для описания пространства имён XML в LINQ to XML
используется класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XNamespace</span></span>. У этого класса нет открытого
конструктора, но определено неявное приведение строки к <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNamespace</span></span>:</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XNamespace</span></span><span lang=EN-US> ns = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;http://astronomy.com/planet&quot;</span></span><span
lang=EN-US>;</span></p>

<p class=MsoNormal>Чтобы указать на принадлежность имени к определённому
пространству имён, следует использовать перегруженную версию оператора <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>+</span></span>, объединяющую
объект <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XNamespace</span></span>
и строку в результирующий объект <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XName</span></span>:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
lang=EN-US> jupiter = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(ns + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>,
</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Jupiter&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;name xmlns=&quot;http://astronomy.com/planet&quot;&gt;Jupiter&lt;/name&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Префикс пространства имён устанавливается путём добавления в
элемент атрибута специального вида. Если префикс задан, им заменяется любое
указание пространства имён у дочернего элемента:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
lang=EN-US> planet = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>(ns + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planet&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XAttribute</span></span>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XNamespace</span></span>.Xmlns + </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;p&quot;</span></span><span lang=EN-US>, ns));</span></p>

<p class=aCxSpMiddle><span lang=EN-US>planet.Add(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(ns
+ </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>,
</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Jupiter&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(planet);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;p:planet xmlns:p=&quot;http://astronomy.com/planet&quot;&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span>&lt;p:name&gt;Jupiter&lt;/p:name&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// &lt;/p:planet&gt;<o:p></o:p></span></span></p>

<h1><a name="_Toc348862507">20. Дополнительные возможности обработки XML</a></h1>

<p class=MsoNormal>В дополнение к LINQ to XML, платформа .NET содержит
несколько программных интерфейсов для работы с XML. Для этого обычно используются
классы из пространств имён вида <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Xml.*</span></span> (сборка <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Xml.dll</span></span>).</p>

<p class=MsoNormal>Классы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlWriter</span></span><span
lang=EN-US> </span>– это основа механизма последовательного чтения, обработки и
записи XML-документов. Такой подход выгодно использовать, когда документ
слишком велик, чтобы читать его в память целиком, или содержит ошибки в
структуре.</p>

<p class=MsoNormal>Для чтения XML-документов применяется класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlReader</span></span> и его
наследники <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlTextReader</span></span>
(чтение на основе текстового потока), <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlNodeReader</span></span> (разбор XML из
объектов <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNode</span></span>)
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlValidatingReader</span></span>
(чтение с проверкой схемы XML-документа). Класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>
содержит статический метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Create()</span></span>, создающий объект для чтения на основе <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TextReader</span></span>
или строки URI (частный случай <span lang=EN-US style='mso-ansi-language:EN-US'>URI</span><span
lang=EN-US> </span>– имя файла):</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span><span lang=EN-US> reader
= <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planets.xml&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Create()</span></span> принимает в качестве дополнительного аргумента
объект класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlReaderSettings</span></span>, который задаёт различные опции
чтения данных:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// игнорируем при чтении комментарии и
пробельные символы<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> settings = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReaderSettings</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>settings.IgnoreComments = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>settings.IgnoreWhitespace = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlReader</span></span><span
lang=EN-US> reader = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planets.xml&quot;</span></span><span
lang=EN-US>, settings);</span></p>

<p class=MsoNormal>Объект <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span> извлекает
XML-конструкции из документа при помощи метода <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Read()</span></span><a style='mso-footnote-id:
ftn21' href="#_ftn21" name="_ftnref21" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[21]</span></span><![endif]></span></span></a>.
Тип текущей конструкции можно узнать, используя свойство <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>NodeType</span></span>, значениями которого
являются элементы перечисления <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span>. В табл. 15 приведены
основные элементы этого перечисления. С конструкцией работают, применяя
свойства <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Name</span></span>
(имя элемента), <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Value</span></span>
(данные элемента) и некоторые другие.</p>

<p class=ae>Таблица 15</p>

<p class=af>Основные элементы перечисления <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Значение</p>
  </td>
  <td width="60%" style='width:60.76%;border:solid windowtext 1.0pt;border-left:
  none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Пример</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CDATA</span></span><span
  class=af3><span style='mso-ansi-font-size:12.0pt;font-family:"Times New Roman",serif'><o:p></o:p></span></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;![CDATA[
  </span></span><span class=af8><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-ansi-language:
  EN-US'>This is CDATA info</span></span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>
  ]]&gt;<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Comment</span></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af9><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;!-- первые четыре планеты
  --&gt;<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Document</span></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;</span></span><span
  class=afc><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>planets</span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&gt;</span></span> (корневой элемент)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Element</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;</span></span><span
  class=afc><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>planet</span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&gt;<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>EndElement</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;/</span></span><span
  class=afc><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>planet</span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&gt;<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ProcessingInstruction</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;?</span></span><span
  class=afc><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>perl lower-to-upper-case </span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>?&gt;<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Text</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Mercury<o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Whitespace</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>\r \t \n</span></span>
  (перевод строки, табуляция)<span class=XML0><span style='mso-ansi-font-size:
  12.0pt;font-family:"Times New Roman",serif;color:windowtext;mso-ansi-language:
  RU'><o:p></o:p></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;mso-yfti-lastrow:yes'>
  <td width="39%" style='width:39.24%;border:solid windowtext 1.0pt;border-top:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>XmlDeclaration</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td width="60%" style='width:60.76%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;?</span></span><span
  class=afc><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>xml</span></span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'> </span></span><span class=XML0><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>version</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>=&quot;1.0&quot; </span></span><span
  class=XML0><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>encoding</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>=&quot;utf-8&quot; ?&gt;<o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Следующий пример демонстрирует разбор XML-файла и печать
разобранных конструкций:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> r = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;planets.xml&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>while</span></span><span lang=EN-US> (r.Read())</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;{0}\t&quot;</span></span><span
lang=EN-US>, r.Depth);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>switch</span></span><span lang=EN-US>
(r.NodeType)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>case</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span>.Element:</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>case</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span>.EndElement:</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'><span style='mso-spacerun:yes'>    </span></span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span><span lang=EN-US>.WriteLine(r.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'><span style='mso-spacerun:yes'>    </span>break</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>case</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span>.Text:</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>case</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span>.Comment:</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>case</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNodeType</span></span>.XmlDeclaration:</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(r.Value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>break</span></span><span style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для чтения атрибутов текущего элемента можно использовать
индексатор <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>,
указав имя или позицию атрибута (если атрибута не существует, индексатор вернёт
значение <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span>):</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// переписанный фрагмент оператора switch из
предыдущего примера<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>switch</span></span><span
lang=EN-US> (r.NodeType)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>case</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlNodeType</span></span>.Element:</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(r.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> attribute
= r[</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;units&quot;</span></span><span
lang=EN-US>];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(attribute ?? </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>.Empty);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>break</span></span><span style='mso-ansi-language:
RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>. . .<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Набор методов класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>, начинающихся с
префикса <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MoveTo</span></span>
(<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MoveToElement()</span></span>
и т. п.), может использоваться для перехода к следующей XML-конструкции в
потоке. Вернуться к просмотренным конструкциям нельзя.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlWriter</span></span> – это абстрактный класс для создания
XML-данных. Подчеркнём, что XML-данные всегда могут быть сформированы в виде
простой строки и затем записаны в любой поток. Однако такой подход не лишён
недостатков – возрастает вероятность неправильного формирования структуры XML
из-за элементарных ошибок. Класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlWriter</span></span> и его наследники
(например, <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlTextWriter</span></span>)
предоставляют более «помехоустойчивый» способ генерации XML-документа.</p>

<p class=MsoNormal>Приведём пример работы с классом <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlWriter</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// опция для формирования отступов в документе<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> settings = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlWriterSettings</span></span> {Indent = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US> };</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> writer = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlWriter</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;customers.xml&quot;</span></span><span
lang=EN-US>, settings))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>начинаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>с</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> XML-</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>декларации</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer.WriteStartDocument();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>открывающий</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>тег</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>с</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>двумя</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>атрибутами</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer.WriteStartElement(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;customer&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer.WriteAttributeString(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;id&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;1&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer.WriteAttributeString(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;status&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;archived&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>вложенный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>элемент</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>со</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>строковым</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>содержимым</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteElementString</span><span style='mso-ansi-language:RU'>(</span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
style='mso-ansi-language:RU'>, </span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Alex</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
так пишутся элементы с не строковым содержимым<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
для этого используется метод </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>WriteValue</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>writer.WriteStartElement(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;birthdate&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer.WriteValue(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DateTime</span></span>(1975, 8, 4));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>writer</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteEndElement</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
закрывающие теги (принцип стека)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>writer</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteEndElement</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>writer</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteEndDocument</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Этот пример формирует следующий XML-документ:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;?</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xml</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> </span></span><span class=XML><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>version</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;1.0&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>encoding</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;utf-8&quot;?&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>customer</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> </span></span><span class=XML><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>id</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;1&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>status</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;archived&quot;&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Alex</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>name</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>birthdate</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>1975-08-04T00:00:00</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>birthdate</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>customer</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Классы<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlNode</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlAttribute</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlElement</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlDocument</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>служат<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>представления<span lang=EN-US style='mso-ansi-language:EN-US'> XML-</span>документа<span
style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:EN-US'>
</span>виде<span style='mso-ansi-language:EN-US'> </span>дерева<span
style='mso-ansi-language:EN-US'> </span>объектов<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Программный интерфейс, основанный на
использовании данных классов, являлся предшественником LINQ to XML. В связи с
этим ограничимся только простым примером, демонстрирующим работу с указанными
классами:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> OutputNode(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlNode</span></span> node)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Type= {0} \t Name= {1} \t Value=
{2}&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span>node.NodeType, node.Name,
node.Value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if </span></span><span lang=EN-US>(node.Attributes
!= </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlAttribute</span></span> attr </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> node.Attributes)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Type={0} \t Name={1} \t Value={2}&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                              </span>attr.NodeType,
attr.Name, attr.Value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
если есть дочерние элементы, рекурсивно обрабатываем их<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (node.HasChildNodes)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlNode</span></span> child </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> node.ChildNodes)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>OutputNode(child);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пример</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>использования</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>метода</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> OutputNode()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> doc = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlDocument</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>doc.Load(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;planets.xml&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span lang=EN-US>OutputNode</span><span style='mso-ansi-language:
RU'>(</span><span lang=EN-US>doc</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>DocumentElement</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<h1><a name="_Toc348862508">21. Сериализация времени выполнения</a></h1>

<p class=MsoNormal><span class=a2>Сериализация времени выполнения</span>
(runtime serialization) – это процесс преобразования объекта или графа
связанных объектов в поток байтов. <span class=a2>Десериализация</span> –
обратный процесс, заключающийся в восстановлении состояния объекта из потока
байтов. Возможности сериализации используются при сохранении состояния объекта
в файле, передаче объектов по сети, клонировании объектов.</p>

<p class=MsoNormal>Платформа .NET обладает встроенным механизмом поддержки
сериализации времени выполнения. Основные классы, связанные с сериализацией,
размещены в пространствах имён с префиксом <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Runtime.Serialization</span></span>.
Например, сериализацию в двоичном формате обеспечивают классы из <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Runtime.Serialization.Formatters.Binary</span></span>.</p>

<p class=MsoNormal>При рассмотрении примеров сериализации будем использовать
классы, описывающие одного студента и группу студентов:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparable</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private string</span></span><span lang=EN-US>
_name;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private double</span></span><span lang=EN-US>
_gpa;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> _name; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US> { _name = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>value</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public double</span></span><span lang=EN-US>
GPA<span style='mso-spacerun:yes'>    </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// Grade Point Average, </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>средний</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>балл</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> _gpa; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US> { _gpa = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>value</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public int</span></span><span lang=EN-US>
CompareTo(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> other)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
GPA.CompareTo(other.GPA);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span> _bestStudent;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>double</span></span><span lang=EN-US> _gpa;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public double</span></span><span lang=EN-US>
GPA </span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> _gpa; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span> BestStudent</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
_bestStudent; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public double</span></span><span lang=EN-US>
CalculateGroupGPA()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> _gpa =
Items.Select(stud =&gt; stud.GPA).Average();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span> FindTheBestStudent()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
_bestStudent = Items.Max();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создадим объекты классов Student и Group<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> group = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span> {</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Smirnov&quot;</span></span><span
lang=EN-US>, GPA = 9.1},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Ivanova&quot;</span></span><span
lang=EN-US>, GPA = 6.7},</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Sokolov&quot;</span></span><span
lang=EN-US>, GPA = 7.6},</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Lebedeva&quot;</span></span><span
lang=EN-US>, GPA = 9}};</span></p>

<p class=MsoNormal>Сериализация времени выполнения применима к объектам
сериализуемых типов. <span class=a2>Сериализуемый тип</span> – это тип,
помеченный атрибутом <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serializable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span><a
style='mso-footnote-id:ftn22' href="#_ftn22" name="_ftnref22" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[22]</span></span><![endif]></span></span></a>,
у которого все поля имеют сериализуемый тип. Базовые типы платформы .NET
являются сериализуемыми. Если планируется сериализация объекта <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>group</span></span>, необходимо добавить
атрибут <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serializable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> к классам <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Group</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>.
Сериализация некоторых полей может не иметь смысла (например, эти поля
вычисляются при работе с объектом или хранят конфиденциальные данные). Для
таких полей можно применить атрибут <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>NonSerialized</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>.</p>

<p class=MsoNormal>Изменим код классов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span> с
учётом вышесказанного:</p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serializable</span></span>]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparable</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>    </span>//
неизменившиеся элементы класса не показаны<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serializable</span></span>]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
считаем, что поле _bestStudent является вычислимым<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>[</span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>NonSerialized</span></span><span
style='mso-ansi-language:RU'>]<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>private</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span><span style='mso-ansi-language:RU'> _</span><span
lang=EN-US>bestStudent</span><span style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'><span style='mso-spacerun:yes'>    </span>//
неизменившиеся элементы класса не показаны<o:p></o:p></span></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Объекты сериализуемых типов можно сохранить в поток в
различных форматах. В частности, платформа .NET поддерживает двоичный формат
при помощи класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BinaryFormatter</span></span>. Его экземплярный метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serialize()</span></span> принимает
два аргумента – поток сериализации и сериализуемый объект:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> formatter = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BinaryFormatter</span></span>();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> s = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;group.dat&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>formatter.Serialize(s, group);</span></p>

<p class=MsoNormal>Метод<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Deserialize()</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>класса<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BinaryFormatter</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'> </span>выполняет<span style='mso-ansi-language:EN-US'> </span>десериализацию<span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> formatter = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BinaryFormatter</span></span>();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> s = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.OpenRead(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;group.dat&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>group = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span>) formatter.Deserialize(s);</span></p>

<p class=MsoNormal>Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Deserialize()</span></span> размещает объект в памяти и возвращает
ссылку на него. При этом конструкторы не вызываются. Это может стать проблемой,
если нужна особая инициализация объекта и восстановление несохраненных полей.
Платформа .NET содержит атрибуты <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnSerializing</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnSerialized</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnDeserializing</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnDeserialized</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, применимые к методам
сериализуемого типа. Помеченные методы вызываются CLR автоматически до и после
сериализации или десериализации соответственно. Метод, который обозначен одним
из указанных атрибутов, должен принимать в качестве аргумента объект класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span><a
style='mso-footnote-id:ftn23' href="#_ftn23" name="_ftnref23" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[23]</span></span><![endif]></span></span></a>
и не возвращать значений. Каждый из атрибутов может применяться только к одному
методу в типе.</p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serializable</span></span>]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Collection</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnSerializing</span></span>]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private void</span></span><span lang=EN-US>
BeforeSerialization(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span> context)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>CalculateGroupGPA();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnDeserialized</span></span>]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private void</span></span><span lang=EN-US>
AfterDeserialization(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span> context)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>FindTheBestStudent</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
неизменившиеся элементы класса не показаны<o:p></o:p></span></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Атрибут <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OptionalField</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> применяется к полю и подавляет
генерацию исключения при десериализации, если помеченное поле не найдено в
потоке данных. Это позволяет сохранять «старые» объекты, затем модифицировать
тип, расширяя состав его полей, и десериализовать данные в «новые» объекты
типа.</p>

<p class=MsoNormal>Если программиста не устраивает способ организации потока
сериализуемых данных, он может повлиять на этот процесс, реализуя в
сериализуемом типе интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ISerializable</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ISerializable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US>
GetObjectData(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SerializationInfo</span></span> info,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                       </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>context</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ISerializable</span></span> позволяет выполнить
любые действия, связанные с формированием данных для сохранения. Метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetObjectData()</span></span>
вызывается CLR автоматически при выполнении сериализации. Реализация метода
подразумевает заполнение объекта <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SerializationInfo</span></span> набором данных
вида «ключ-значение», которые (обычно) соответствуют полям сохраняемого
объекта. Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SerializationInfo</span></span> содержит перегруженный метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AddValue()</span></span>,
набор методов вида <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Get</span></span><span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ПримитивныйТип</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>, а также
свойства для указания имени типа и сборки сериализуемого объекта. Если тип
реализует интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ISerializable</span></span>, он должен содержать специальный <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>private</span></span>-конструктор,
который будет вызывать CLR после выполнения десериализации. Конструктор должен
иметь параметры типа <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SerializationInfo</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span>.</p>

<p class=MsoNormal>Рассмотрим пример реализации <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ISerializable</span></span> в
классе <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>.</p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Serializable</span></span>]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IComparable</span></span>&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>&gt;, <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ISerializable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ISerializable</span></span>.GetObjectData(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SerializationInfo</span></span>
info,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                     </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StreamingContext</span></span> ctx)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>info.SetType(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span>));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>info.AddValue(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Name&quot;</span></span><span
lang=EN-US>, _name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>info.AddValue(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;GPA&quot;</span></span><span
lang=EN-US>, (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>) (_gpa*10));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private</span></span><span lang=EN-US> Student(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SerializationInfo</span></span> info, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span>
ctx)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>_name = info.GetString(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Name&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>_gpa = info.GetInt32(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;GPA&quot;</span></span><span
lang=EN-US>)/10.0;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>Student</span><span
style='mso-ansi-language:RU'>() { }<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
неизменившиеся элементы класса не показаны<o:p></o:p></span></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h1><a name="_Toc348862509">22. Сериализация контрактов данных</a></h1>

<p class=MsoNormal><span class=a2>Контракт данных</span> – это тип (класс или
структура), объект которого описывает информационный фрагмент. Подразумевается,
что этот фрагмент может быть сохранён, а затем восстановлен. Работу с
контрактами данных можно рассматривать как один из механизмов сериализации.</p>

<p class=MsoNormal>Если в качестве контракта данных используется обычный класс,
информационный фрагмент образуют открытые поля и свойства класса. Можно
пометить тип атрибутом <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataContract</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>. Тогда
информационный фрагмент будут составлять поля и свойства, имеющие атрибут <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataMember</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span><a
style='mso-footnote-id:ftn24' href="#_ftn24" name="_ftnref24" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[24]</span></span><![endif]></span></span></a>.
Видимость элементов при этом роли не играет.</p>

<p class=aCxSpFirst><span style='mso-ansi-language:RU'>[</span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DataContract</span></span><span style='mso-ansi-language:RU'>]<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>class</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DataMember</span></span>] </span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DataMember</span></span>]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public double</span></span><span lang=EN-US>
GPA { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Основным форматом хранения контрактов данных является XML.
Поэтому атрибут <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataContract</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> имеет
свойства <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Name</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Namespace</span></span>
для указания имени и пространства имён корневого XML-элемента. У атрибута <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataMember</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> есть свойство
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Name</span></span>,
а также свойства <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Order</span></span>
(порядок записи элементов контракта), <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IsRequired</span></span> (обязательный элемент
для записи), <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>EmitDefaultValue</span></span>
(нужна ли запись значения по умолчанию для элемента).</p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataContract</span></span>(Name
= </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;student&quot;</span></span><span
lang=EN-US>, Namespace = </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;bsuir.by&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DataMember</span></span>(Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>,
Order = 1)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DataMember</span></span>(Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;gpa&quot;</span></span><span lang=EN-US>,
Order = 0)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public double</span></span><span lang=EN-US>
GPA { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Если контракт является коллекцией объектов (как класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Group</span></span>),
он маркируется атрибутом <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CollectionDataContract</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>. Кроме этого,
для методов контракта данных применимы атрибуты <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnSerializing</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnSerialized</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnDeserializing</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnDeserialized</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>.</p>

<p class=MsoNormal>Если контракт планируется десериализовать в объекты потомков
своего типа, эти потомки должны быть упомянуты при помощи атрибута <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>KnownType</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>.</p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataContract</span></span>]</span></p>

<p class=aCxSpMiddle><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>KnownType</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Postgraduate</span></span>))]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> { . . . }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>class</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Postgraduate</span></span><span
style='mso-ansi-language:RU'> : </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span><span
style='mso-ansi-language:RU'> { . . . }<o:p></o:p></span></p>

<p class=MsoNormal>Для выполнения сериализации контракта данных используются
классы:</p>

<p class=MsoNormal>1. <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DataContractSerializer</span></span><span lang=EN-US> </span>–
сериализует контракт в формате XML;</p>

<p class=MsoNormal>2. <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>NetDataContractSerializer</span></span><span lang=EN-US> </span>–
сериализует данные и тип контракта;</p>

<p class=MsoNormal>3. <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DataContractJsonSerializer</span></span><span lang=EN-US> </span>–
сериализует контракт в формате JSON.</p>

<p class=MsoNormal>Рассмотрим пример сериализации контрактов данных:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> student = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Smirnov&quot;</span></span><span
lang=EN-US>, GPA = 9.1};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// конструктор требует указания типа контракта
данных<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> ds = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DataContractSerializer</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>));</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> s = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;smirnov.xml&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ds.WriteObject(s, student);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>полученный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>файл</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
smirnov.xml<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
&lt;student xmlns=&quot;bsuir.by&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>         
</span>xmlns:i=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span>&lt;gpa&gt;9.1&lt;/gpa&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span>&lt;name&gt;Smirnov&lt;/name&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// &lt;/student&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Сериализацию в формате XML можно выполнить при помощи класса
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlSerializer</span></span>
из пространства имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Xml.Serialization</span></span>.
При таком подходе сохраняются <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span>-элементы объекта. Кроме
этого, тип объекта должен быть открытым и иметь открытый конструктор без
параметров.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> student = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span> {Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Smirnov&quot;</span></span><span
lang=EN-US>, GPA = 9.1};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// при создании XmlSerializer требуется указать
сериализуемый тип<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> serializer = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlSerializer</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Student</span></span>));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>сериализация</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> stream = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.Create(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;student.xml&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>serializer.Serialize(stream, student);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>десериализация</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Stream</span></span> stream = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>File</span></span>.OpenRead(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;student.xml&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>student = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span>)
serializer.Deserialize(stream);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Настройка XML-сериализации может быть выполнена при помощи
атрибутов. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlRoot</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> применяется к
типу и задаёт корневой элемент в XML-файле. При помощи <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlElement</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> настраивается имя и
пространство имён XML-элемента. <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlAttribute</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> используется, если член класса
требуется сохранить в виде XML-атрибута. Поля и свойства, которые не должны
сохраняться, помечаются атрибутом <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlIgnore</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>. Если тип содержит коллекцию
объектов, то настройка имени этой коллекции и имени отдельного элемента
выполняется при помощи атрибутов <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlArray</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlArrayItem</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Student</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlAttribute</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;name&quot;</span></span><span lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlIgnore</span></span>]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public double</span></span><span lang=EN-US>
GPA { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlRoot</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;students&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Group</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlArray</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;list&quot;</span></span><span lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XmlArrayItem</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;student&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span>&lt;<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Student</span></span>&gt; <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span> { </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Отметим, что XML-сериализация не может сохранить
коллекции-словари. Если выполняется XML-сериализация объекта, реализующего
интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span>
(обычный или универсальный), сохраняются только те элементы, которые доступны
через перечислитель.</p>

<h1><a name="_Toc348862510">23. Состав и взаимодействие сборок</a></h1>

<p class=MsoNormal>В платформе .NET <span class=a2>сборка</span> (assembly) –
это единица развёртывания и контроля версий. Сборка состоит из одного или
нескольких <span class=a2>программных модулей</span> и, возможно, <span
class=a2>данных ресурсов</span>. Программный модуль содержит метаданные и код
на Common Intermediate Language. <span class=a2>Метаданные</span> – это
информационные таблицы с полным описанием всех типов, которые размещены в
модуле или на которые ссылается модуль. В одном из модулей метаданные хранят <span
class=a2>манифест</span> с описанием всех файлов сборки. Будем называть сборку <span
class=a2>однофайловой</span>, если она состоит из одного файла. Иначе сборка
называется <span class=a2>многофайловой</span>. Тот файл, который содержит
манифест сборки, будем называть <span class=a2>главным файлом сборки</span>. На
рис. 7 показана однофайловая сборка <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>OneFile.exe</span></span>, которая ссылается на многофайловую
сборку <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManyFiles.dll</span></span>.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_1"
 o:spid="_x0000_i1036" type="#_x0000_t75" style='width:438.75pt;height:179.25pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image008.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 7. Однофайловая и многофайловая сборки.</p>

<p class=MsoNormal>Простые приложения обычно представлены однофайловыми
сборками. При разработке сложных приложений переход к многофайловым сборкам
даёт следующие преимущества:</p>

<p class=MsoNormal>– ресурсы (текстовые строки, изображения и т. п.) можно
хранить отдельно от исполняемого кода, что позволяет изменять ресурсы без
перекомпиляции приложения;</p>

<p class=MsoNormal>– если исполняемый код приложения разделён на несколько
модулей, то модули загружаются в память только по мере надобности;</p>

<p class=MsoNormal>– скомпилированный модуль может использоваться в нескольких
сборках.</p>

<p class=MsoNormal>Рассмотрим пример создания и использования многофайловой
сборки<a style='mso-footnote-id:ftn25' href="#_ftn25" name="_ftnref25" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[25]</span></span><![endif]></span></span></a>.
Пусть требуется построить консольное приложение, в котором метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Main()</span></span> печатает
на экране строку. Предположим, что эту строку возвращает статический метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetText()</span></span>
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TextClass</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TextClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static string</span></span><span
lang=EN-US> GetText()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>message</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Файл <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextClass.cs</span></span> с исходным кодом класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TextClass</span></span>
скомпилируем в виде модуля (обратите внимание на ключ компилятора):</p>

<p class=a><span lang=EN-US>csc.exe </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>/t:module</span></span><span
lang=EN-US> TextClass.cs</span></p>

<p class=MsoNormal>После компиляции получим программный модуль <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TextClass.netmodule</span></span>. Далее,
создадим консольное приложение (файл <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass.cs</span></span>):</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Text from netmodule: &quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TextClass</span></span>.GetText());</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Соберём<span style='mso-ansi-language:EN-US'> </span>многофайловую<span
style='mso-ansi-language:EN-US'> </span>сборку<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Ключ компилятора <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>/addmodule</span></span> позволяет добавить к
сборке ссылку на внешний модуль. Этот ключ должен применяться для каждого
подключаемого модуля.</p>

<p class=a><span lang=EN-US>csc</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>exe</span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>/</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>addmodule</span></span><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>:</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>textclass</span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>netmodule</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>MainClass</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>cs</span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>В итоге получим многофайловую сборку, состоящую из двух
файлов: главного файла <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>mainclass.exe</span></span>
и файла-модуля <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>textclass.netmodule</span></span>.
Теперь можно создать новую сборку, в которой используется код из модуля <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>textclass.netmodule</span></span>,
то есть сделать модуль <span class=a2>разделяемым</span> между несколькими
сборками. Важное замечание: предполагается, что все файлы, составляющие нашу
многофайловую сборку, размещены в одном каталоге.</p>

<p class=MsoNormal>Разберём вопрос взаимодействия сборок. Как правило, крупные
программные проекты состоят из нескольких сборок, связанных ссылками. Среди
этих сборок имеется некая основная (обычно оформленная как исполняемый файл), а
другие сборки играют роль подключаемых библиотек с кодом необходимых типов (как
правило, имеют расширение <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>*.dll</span></span>).</p>

<p class=MsoNormal>Представим пример, который будет использоваться в
дальнейшем. Пусть имеется класс (в файле <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>UL.cs</span></span>), содержащий «полезную» функцию:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> UsefulLibrary</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>UsefulClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
Print()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>System.<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Useful function&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Скомпилируем данный класс как библиотеку типов (расширение <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>*.dll</span></span>):</p>

<p class=a><span lang=EN-US>csc.exe </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>/t:library</span></span><span
lang=EN-US> UL.cs</span></p>

<p class=MsoNormal>Пусть основное приложение (файл <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>main.cs</span></span>) собирается использовать
код из сборки <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>UL.dll</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using </span></span><span
lang=EN-US>System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using </span></span><span
lang=EN-US>UsefulLibrary;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>static</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'> </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>void</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
lang=EN-US>Main</span><span style='mso-ansi-language:RU'>()<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
используем класс из другой сборки<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>UsefulClass</span></span><span
lang=EN-US> a = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>UsefulClass</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>a.Print();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Ключ компилятора <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>/r</span></span> (или <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>/reference</span></span>) позволяет установить ссылку на требуемую
сборку. Скомпилируем приложение <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>main.cs</span></span>:</p>

<p class=a><span lang=EN-US>csc</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>exe</span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>/</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>r</span></span><span class=ac><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>:</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>UL</span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>dll</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>main</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>cs</span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>В Visual Studio для добавления ссылок на сборки используется
ветвь <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>References</span></span>
в дереве проекта в Solution Explorer, или команда меню <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Project | Add Reference</span></span>.</p>

<p class=MsoNormal>Создавая сборку, программист может снабдить её цифровой
подписью, версией, указанием на региональную принадлежность и другой
информацией. Эти данные внедряются в сборку при помощи атрибутов уровня сборки.
Атрибуты можно разместить в любом файле с исходным кодом, необходимо только
подключить пространство имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Reflection</span></span>. Если для разработки используется
Visual Studio, все атрибуты уровня сборки по умолчанию находятся в файле <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyInfo.cs</span></span>.
Кроме этого, в Visual Studio удобно редактировать атрибуты не напрямую, а
используя диалоговое окно свойств проекта.</p>

<p class=MsoNormal><span class=a2>Цифровая подпись</span> защищает сборку от
несанкционированного изменения. Платформа .NET использует для цифровой подписи
алгоритм RSA. Схема подписания сборки показана на рис. 8.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_5"
 o:spid="_x0000_i1035" type="#_x0000_t75" style='width:387.75pt;height:192.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image009.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 8. Подписание сборки.</p>

<p class=MsoNormal>Для того чтобы снабдить сборку цифровой подписью, необходим <span
class=a2>открытый ключ</span> и <span class=a2>закрытый ключ</span>. Утилита <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>sn.exe</span></span>, входящая
в состав .NET Framework SDK, способна сгенерировать файл с парой ключей:</p>

<p class=a><span lang=EN-US>sn</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>exe</span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>-</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>k</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
lang=EN-US>keys</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>snk</span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Чтобы подписать сборку, используется атрибут уровня сборки <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyKeyFile</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> (имя файла с
ключами нужно указать в качестве аргумента атрибута) или ключ компилятора
командной строки <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>/keyfile</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Reflection;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>[</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>assembly</span></span><span
lang=EN-US>: <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AssemblyKeyFile</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;keys.snk&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> UsefulLibrary { . . . }</span></p>

<p class=MsoNormal>Сгенерировать ключи и подписать сборку можно в Visual Studio
в окне свойств проекта (закладка <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Signing</span></span>).</p>

<p class=MsoNormal>Чтобы указать версию сборки, используется атрибут <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyVersion</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>. Номер версии
имеет формат <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Major.Minor.Build.Revision</span></span>.
Часть <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Major</span></span>
является обязательной. Любая другая часть может быть опущена (в этом случае она
полагается равной нулю). Часть <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Revision</span></span> можно задать как <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>*</span></span>, тогда компилятор генерирует её
как количество секунд, прошедших с полуночи, делённое на два. Часть <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Build</span></span> также
можно задать как <span class=af4><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>*</span></span>.
Тогда для неё будет использовано количество дней, прошедших с 1 февраля 2000
года.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Reflection;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>[</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>assembly</span></span><span
lang=EN-US>: <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AssemblyVersion</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;1.2.0.0&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> UsefulLibrary { . . . }</span></p>

<p class=MsoNormal>Для<span style='mso-ansi-language:EN-US'> </span>задания<span
style='mso-ansi-language:EN-US'> </span>региональной<span style='mso-ansi-language:
EN-US'> </span>принадлежности<span style='mso-ansi-language:EN-US'> </span>используется<span
style='mso-ansi-language:EN-US'> </span>атрибут<span style='mso-ansi-language:
EN-US'> </span>уровня<span style='mso-ansi-language:EN-US'> </span>сборки<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyCulture</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>]</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>Для определения версии и региональной принадлежности можно
использовать окно свойств проекта в Visual Studio (закладка <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Application</span></span>, кнопка <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Assembly Information</span></span>).</p>

<p class=MsoNormal>Платформа .NET разделяет сборки на <span class=a2>локальные</span>
(или <span class=a2>сборки со слабыми именами</span>) и <span class=a2>глобальные</span>
(или <span class=a2>сборки с сильными именами</span>). Если <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>UL.dll</span></span> рассматривается как
локальная сборка, то при выполнении приложения она должна находиться в том же
каталоге, что и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>main.exe</span></span><a
style='mso-footnote-id:ftn26' href="#_ftn26" name="_ftnref26" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[26]</span></span><![endif]></span></span></a>.
Локальные сборки обеспечивают простоту развёртывания приложения (все его
компоненты сосредоточены в одном месте) и изолированность компонентов. Имя
локальной сборки – <span class=a2>слабое имя</span> – это имя файла сборки без
расширения.</p>

<p class=MsoNormal>Хотя использование локальных сборок имеет свои преимущества,
иногда необходимо сделать сборку общедоступной. До появления платформы .NET
доминировал подход, при котором код общих библиотек помещался в системный
каталог простым копированием файлов при установке. Такой подход привёл к
проблеме, известной как <span class=a2>«ад DLL»</span> (DLL Hell).
Инсталлируемое приложение могло заменить общую библиотеку новой версией, при
этом другие приложения, ориентированные на старую версию библиотеки,
переставали работать. Для устранения «ада DLL» в платформе .NET используется
специальное защищённое <span class=a2>хранилище сборок</span> (Global Assembly
Cache, GAC).</p>

<p class=MsoNormal>Сборки, помещаемые в GAC, должны удовлетворять определённым
условиям. Во-первых, такие глобальные сборки должны иметь цифровую подпись. Это
исключает подмену сборок злоумышленниками. Во-вторых, для глобальных сборок
отслеживаются версии и языковые культуры. Допустимой является ситуация, когда в
GAC находятся разные версии одной и той же сборки, используемые разными
приложениями.</p>

<p class=MsoNormal>Сборка, помещённая в GAC, получает <span class=a2>сильное
имя</span>. Как раз использование сильного имени является тем признаком, по
которому среда исполнения понимает, что речь идёт не о локальной сборке, а о
сборке из GAC. Сильное имя включает имя главного файла сборки (без расширения),
версию сборки, указание о региональной принадлежности и маркер открытого ключа
сборки:</p>

<p class=MsoNormal>Рассмотрим процесс создания сборки с сильным именем на
примере сборки <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>UL.dll</span></span>.
Во-первых, сборку необходимо снабдить цифровой подписью. После подписания для
сборки можно указать версию и региональную принадлежность (это не обязательные
действия). После этого сборку можно поместить в GAC. Простейший вариант –
использовать утилиту <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>gacutil.exe</span></span>,
входящую в состав .NET Framework SDK. При использовании ключа <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>/i</span></span> сборка помещается в GAC, а
ключ <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>/u</span></span>
удаляет сборку из GAC:</p>

<p class=a><span lang=EN-US>gacutil</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>exe</span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>/</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>i</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
lang=EN-US>UL</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>dll</span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Теперь сборка <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>UL.dll</span></span> помещена в GAC. Её сильное имя (для ссылки в
программах) имеет вид:</p>

<p class=a><span class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>UL, Version=1.2.0.0, Culture=neutral, PublicKeyToken=ff824814c57facfe<o:p></o:p></span></span></p>

<h1><a name="_Toc348862511">24. Метаданные и получение информации о типах</a></h1>

<p class=MsoNormal>При создании сборки в неё помещаются метаданные, которые
являются описанием всех типов в сборке и их элементов. Программист может
работать с метаданными, используя специальный механизм, называемый <span
class=a2>отражением</span> (<span lang=EN-US style='mso-ansi-language:EN-US'>reflection</span>).
Главные элементы, которые необходимы для использования возможностей отражения –
это класс <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><a
style='mso-footnote-id:ftn27' href="#_ftn27" name="_ftnref27" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[27]</span></span><![endif]></span></span></a>
и типы из пространств имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Reflection</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Reflection.Emit</span></span>.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Type</span></span> служит для хранения информации о типе.
Существует несколько способов получить объект этого класса:</p>

<p class=MsoNormal>1. Вызвать у объекта метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetType()</span></span>. Данный метод определён
на уровне <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Object</span></span>,
а значит, присутствует у любого объекта:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Foo</span></span><span
lang=EN-US> foo = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Foo</span></span>();<span
style='mso-spacerun:yes'>        </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// Foo – </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>это</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>некий</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>класс</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t = foo.GetType();</span></p>

<p class=MsoNormal>2. Использовать статический метод <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.GetType()</span></span>,
которому передаётся имя типа в виде строки. Это имя должно быть полным, то есть
включать пространство имён и, при необходимости, имя сборки, содержащей тип:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span>.GetType(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;System.Int32&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t2 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span>.GetType(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;SomeNamespace.Foo, MyAssembly&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>3. Использовать операцию C# <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span>, аргументом которой
является тип:</p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>t</span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span><span
style='mso-ansi-language:RU'> (</span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Foo</span></span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=MsoNormal>Операцию <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span> можно применять к массивам
и универсальным шаблонам. Причём в последнем случае допускается использовать
как сконструированный тип, так и исходный тип-шаблон (обратите внимание на
синтаксис записи универсального шаблона).</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t1 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof </span></span><span
lang=EN-US>(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>[]);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t2 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof </span></span><span
lang=EN-US>(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span><span
lang=EN-US>[,]);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t3 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof </span></span><span
lang=EN-US>(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt;);<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>сконструированный</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>тип</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t4 = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof </span></span><span
lang=EN-US>(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;&gt;);<span
style='mso-spacerun:yes'>       </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>универсальный</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>тип</span></span></p>

<p class=MsoNormal>Свойства класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span> позволяют узнать имя типа,
имя базового типа, является ли тип универсальным, в какой сборке он размещается
и другую информацию. Кроме этого, <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span> имеет специальные методы,
возвращающие данные о полях типа, свойствах, событиях, методах и их параметрах.</p>

<p class=MsoNormal>Рассмотрим пример получения информации о типе. Будем
анализировать примитивный тип <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Int</span></span><span class=ab><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>32</span></span>:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Int32</span></span>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Full name = &quot;</span></span><span
lang=EN-US> + t.FullName);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Base type is = &quot;</span></span><span
lang=EN-US> + t.BaseType);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Is sealed = &quot;</span></span><span
lang=EN-US> + t.IsSealed);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Is class = &quot;</span></span><span
lang=EN-US> + t.IsClass);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span> iType </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> t.GetInterfaces())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(iType.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FieldInfo</span></span> fi </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US>
t.GetFields())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Field = &quot;</span></span><span
lang=EN-US> + fi.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>PropertyInfo</span></span> pi </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US>
t.GetProperties())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Property = &quot;</span></span><span
lang=EN-US> + pi.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MethodInfo</span></span> mi </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US>
t.GetMethods())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Method Name = &quot;</span></span><span
lang=EN-US> + mi.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Method Return Type = &quot;</span></span><span
lang=EN-US> + mi.ReturnType);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ParameterInfo</span></span> pr </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> mi.GetParameters())</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Parameter Name = &quot;</span></span><span
lang=EN-US> + pr.Name);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Type = &quot;</span></span><span
lang=EN-US> + pr.ParameterType);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Как показывает пример, информация об элементах типа хранится
в объектах классов <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>FieldInfo</span></span>, <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>PropertyInfo</span></span>, <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>MethodInfo</span></span> и т.
п. Эти классы находятся в пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Reflection</span></span>. Их иерархия
показана на рис. 9.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_6"
 o:spid="_x0000_i1034" type="#_x0000_t75" style='width:472.5pt;height:143.25pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image010.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 9. Иерархия классов для представления элементов типа.</p>

<p class=MsoNormal>Отметим, что код примера покажет данные только об открытых
элементах типа. Составом получаемой информации можно управлять, передавая в <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Get</span></span>-методы
дополнительные флаги перечисления <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Reflection.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BindingFlags</span></span> (табл. 16).</p>

<p class=ae>Таблица 16</p>

<p class=af>Флаги <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BindingFlags</span></span>, связанные с получением информации о
типе</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Флаг</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Default</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Отсутствие специальных флагов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IgnoreCase</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Игнорировать регистр имён получаемых элементов</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>DeclaredOnly</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получить элементы, объявленные непосредственно в типе
  (игнорировать унаследованные элементы)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Instance</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получить экземплярные элементы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Static</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получить статические элементы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Public</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получить открытые элементы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>NonPublic</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получить закрытые элементы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FlattenHierarchy</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получить <span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>public</span></span>
  и <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>protected</span></span>
  элементы у типа и у всех его предков</p>
  </td>
 </tr>
</table>

</div>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> t = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Int32</span></span>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> bf = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BindingFlags</span></span>.Public | <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BindingFlags</span></span>.NonPublic |</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BindingFlags</span></span>.Static | <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BindingFlags</span></span>.Instance;</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>FieldInfo</span></span><span
lang=EN-US>[] fi = t.GetFields(bf);</span></p>

<p class=MsoNormal>Пространство имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Reflection</span></span> содержит типы
для получения информации и манипулирования сборкой и модулем сборки. При помощи
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Assembly</span></span>
можно получить информацию о сборке, при помощи класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Module</span></span><span
lang=EN-US> </span>– о модуле. Основные элементы этих классов перечислены в
табл. 17 и табл. 18.</p>

<p class=ae>Таблица 17</p>

<p class=af>Основные элементы класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Assembly</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CreateInstance()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Находит по имени тип в сборке и создаёт его экземпляр</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FullName</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Строковое свойство с полным именем сборки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetAssembly()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Ищет в памяти и возвращает объект <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Assembly</span></span>, который содержит указанный тип
  (статический метод)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetCustomAttributes()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получает атрибуты сборки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetExecutingAssembly()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает сборку, которая содержит выполняемый в текущий момент
  код (статический метод)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetExportedTypes()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>public</span></span>-типы,
  определённые в сборке</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetFiles()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает файлы, из которых состоит сборка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetLoadedModules()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает все загруженные в память модули сборки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetModule()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получает указанный модуль сборки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetModules()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает все модули, являющиеся частью сборки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetName()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает объект <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>AssemblyName</span></span>
  для сборки</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetReferencedAssemblies()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает объекты <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>AssemblyName</span></span>
  для всех сборок, на которые ссылается данная сборка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetTypes()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает типы, определённые в сборке</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Load()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод, который загружает сборку по имени</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LoadFrom()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; загружает сборку из указанного файла</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>LoadModule()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Загружает внутренний модуль сборки в память</p>
  </td>
 </tr>
</table>

</div>

<p class=ae>Таблица 18</p>

<p class=af>Основные элементы класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Module</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Assembly</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство с указанием на сборку (объект <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Assembly</span></span>) модуля</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FindTypes()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получает массив классов, удовлетворяющих заданному фильтру</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>FullyQualifiedName</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Строка, содержащая полное имя и путь к модулю</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetType()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Пытается выполнить поиск указанного типа в модуле</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetTypes()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает все типы, определённые в модуле</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Name</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Строка с коротким именем модуля</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Продемонстрируем пример работы с классами <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Assembly</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Module</span></span>:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Assembly</span></span><span
lang=EN-US> assembly = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Assembly</span></span>.GetExecutingAssembly();</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(assembly.FullName);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Module</span></span> module </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US>
assembly.GetModules())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(module.FullyQualifiedName);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Type</span></span> type </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> module.GetTypes())</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(type.FullName);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<h1><a name="_Toc348862512"><span lang=EN-US style='mso-ansi-language:EN-US'>25.
</span>Позднее</a><span style='mso-bookmark:_Toc348862512'><span
style='mso-ansi-language:EN-US'> </span>связывание</span><span
style='mso-bookmark:_Toc348862512'><span style='mso-ansi-language:EN-US'> </span>и</span><span
style='mso-bookmark:_Toc348862512'><span style='mso-ansi-language:EN-US'> </span>кодогенерация</span><span
style='mso-bookmark:_Toc348862512'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h1>

<p class=MsoNormal>Механизм отражения позволяет реализовать на платформе .NET <span
class=a2>позднее связывание</span> (late binding). Этот термин обозначает
процесс динамической загрузки сборок и типов при работе приложения, создание
экземпляров типов и работу с их элементами.</p>

<p class=MsoNormal>Использование позднего связывания разберём на следующем
примере. Пусть существует класс для хранения информации о человеке, и эта
информация включает уникальный числовой идентификатор:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> Domain</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> Id { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> Name { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Пусть имеется интерфейс, который описывает операции чтения и
записи данных определённого человека из некоего хранилища:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> Domain</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public interface</span></span><span lang=EN-US>
<span class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IRepository</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Person</span></span> Load(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> id);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US> Save(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span> person);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Класс<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Person</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span>интерфейс<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IRepository</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>размещаются<span
style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:EN-US'>
</span>сборке<span style='mso-ansi-language:EN-US'> </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Domain.dll</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Создадим<span
style='mso-ansi-language:EN-US'> </span>сборку<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>Data.dll</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>ссылающуюся<span style='mso-ansi-language:
EN-US'> </span>на<span style='mso-ansi-language:EN-US'> </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Domain.dll</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span>предоставляющую<span style='mso-ansi-language:EN-US'> </span>реализацию<span
style='mso-ansi-language:EN-US'> </span>интерфейса<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IRepository</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>.<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.IO;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Runtime.Serialization;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> Domain;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> Data</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XmlRepository</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IRepository</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span> Load(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> id)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>var</span></span><span lang=EN-US> ds = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataContractSerializer</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span>));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>using</span></span><span lang=EN-US> (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span>
s = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>File</span></span>.OpenRead(CreateName(id)))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Person</span></span>)
ds.ReadObject(s);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
Save(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Person</span></span> person)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>var</span></span><span lang=EN-US> ds = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DataContractSerializer</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span>));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>using</span></span><span lang=EN-US> (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stream</span></span>
s = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>File</span></span>.OpenWrite(CreateName(person.Id)))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>ds.WriteObject(s, person);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private string</span></span><span lang=EN-US>
CreateName(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> id)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
lang=EN-US>id</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>ToString</span><span style='mso-ansi-language:RU'>() + </span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;.</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>xml</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Теперь создадим консольное приложение <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainApp.exe</span></span>, которое записывает и
читает объекты <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span>. Этот приложение ссылается на сборку <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Domain.dll</span></span>, а
со сборкой <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Data.dll</span></span>
будет работать опосредованно, без прямых ссылок. Такая архитектура позволит
подменять механизм сохранения объектов <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Person</span></span>, заменяя сборку <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Data.dll</span></span> другой
реализацией интерфейса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IRepository</span></span>.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_8"
 o:spid="_x0000_i1033" type="#_x0000_t75" style='width:321.75pt;height:171.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image011.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 10. Архитектура примера для работы с объектами <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Person</span></span>.</p>

<p class=MsoNormal>Применим позднее связывание для работы с типами из сборки <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Data.dll</span></span>.
Первый этап позднего связывания – загрузка в память сборки с типом –
выполняется при помощи метода <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Assembly</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.Load()</span></span>. Для указания имени
сборки можно использовать простую строку или объект класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyName</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// имя сборки обычно хранят в файле
конфигурации<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> assemblyName = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AssemblyName</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Data&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>try</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Assembly</span></span> assembly = <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Assembly</span></span>.Load(assemblyName);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// здесь поместим код создания объекта<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>catch</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>FileNotFoundException</span></span>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Data.dll was not found&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>После загрузки сборки создадим объект требуемого типа. Для
этого можно воспользоваться статическим методом <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Activator</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.CreateInstance()</span></span>
или экземплярным методом класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Assembly</span></span> с тем же именем:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// имя типа обычно хранят в файле конфигурации<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US> type = assembly.GetType(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Data.XmlRepository&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> repository = (<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IRepository</span></span>) <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Activator</span></span>.CreateInstance(type);</span></p>

<p class=MsoNormal>Методы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CreateInstance()</span></span> имеют множество перегрузок.
Например, существует версия метода, принимающая массив объектов – аргументы
конструктора создаваемого типа.</p>

<p class=MsoNormal>В нашем примере известно, что созданный объект реализует
интерфейс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IRepository</span></span>,
поэтому можно вызывать методы объекта обычным способом:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> person = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Person</span></span> {Id = 12, Name = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;John Doe&quot;</span></span><span
lang=EN-US>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US>repository.Save(person);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Person</span></span><span
lang=EN-US> clone = repository.Load(12);</span></p>

<p class=MsoNormal>Если при создании приложения нет информации об интерфейсе
объекта, методы объекта можно вызвать альтернативными способами. Например,
класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MethodInfo</span></span>
содержит экземплярный метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Invoke()</span></span>. Его аргументы – целевой объект вызова и
массив аргументов метода:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// модификация двух предыдущих фрагментов кода<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>type</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>assembly</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>GetType</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Data</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlRepository</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> repository = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Activator</span></span>.CreateInstance(type);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>MethodInfo</span></span><span
lang=EN-US> mi = type.GetMethod(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Load&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> person = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Person</span></span>) mi.Invoke(repository, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new object</span></span><span lang=EN-US>[]
{12});</span></p>

<p class=MsoNormal>Вызов метода при помощи отражения – медленная операция. Если
так планируется вызывать метод несколько раз, выгоднее создать объект делегата,
инкапсулирующий метод:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>MethodInfo</span></span><span
lang=EN-US> mi = type.GetMethod(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Load&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> load = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>, <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Person</span></span>&gt;)
<span class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Delegate</span></span>.CreateDelegate(</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>typeof</span></span><span lang=EN-US> (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Person</span></span>&gt;), </span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>тип</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>делегата</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>repository</span><span
style='mso-ansi-language:RU'>,<span style='mso-spacerun:yes'>                
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// целевой объект</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                </span></span><span lang=EN-US>mi</span><span
style='mso-ansi-language:RU'>);<span
style='mso-spacerun:yes'>                        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
метаинформация метода</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Person</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>person</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>load</span><span
style='mso-ansi-language:RU'>(12);<o:p></o:p></span></p>

<p class=MsoNormal>Механизм отражения позволяет не только исследовать готовые
типы и выполнять для них позднее связывание, но и динамически создавать типы.
Платформа .NET имеет средства генерации метаданных и инструкций языка CIL,
сосредоточенные в пространстве имён <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Reflection.Emit</span></span>. Рассмотрим простой пример –
создание сборки и класса с единственным методом<a style='mso-footnote-id:ftn28'
href="#_ftn28" name="_ftnref28" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[28]</span></span><![endif]></span></span></a>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 1. Создадим сборку<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 1a. Для этого получим домен (о них будет
рассказано позднее)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span><span
lang=EN-US> domain = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AppDomain</span></span>.CurrentDomain;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//
1b. </span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Сформируем</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>имя</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>сборки</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyName</span></span><span
lang=EN-US> name = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AssemblyName</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Library&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 1c. Получаем сборку, которую затем
собираемся сохранять<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyBuilder</span></span><span
lang=EN-US> ab = domain.DefineDynamicAssembly(name,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AssemblyBuilderAccess</span></span>.RunAndSave);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// 2.
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>В</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>новой</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>сборке</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>определим</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>модуль</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ModuleBuilder</span></span><span
lang=EN-US> mb = ab.DefineDynamicModule(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Main&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Library.dll&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 3. В модуле создадим класс Widget с уровнем
доступа public<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TypeBuilder</span></span><span
lang=EN-US> tb = mb.DefineType(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Widget&quot;</span></span><span
lang=EN-US>, <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TypeAttributes</span></span>.Public);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 4. В класс добавим метод SayHello() без
параметров<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>MethodBuilder</span></span><span
lang=EN-US> method = tb.DefineMethod(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;SayHello&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                       </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>MethodAttributes</span></span></span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Public</span><span style='mso-ansi-language:RU'>,<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                                       </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span style='mso-ansi-language:
RU'>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span style='mso-ansi-language:
RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 5. Формируем тело метода при помощи
инструкций CIL<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ILGenerator</span></span><span
lang=EN-US> gen = method.GetILGenerator();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>gen.EmitWriteLine(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Hello world&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>gen</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Emit</span><span style='mso-ansi-language:RU'>(</span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OpCodes</span></span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Ret</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 6. Завершаем создание класса<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>t</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>tb</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>CreateType</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 7. Сохраняем полученную сборку<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>ab</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Save</span><span style='mso-ansi-language:RU'>(</span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Library</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>.</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>dll</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// 8. Работаем с нашим классом, используя
позднее связывание<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> o = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Activator</span></span>.CreateInstance(t);</span></p>

<p class=aCxSpLast><span lang=EN-US>t.GetMethod(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;SayHello&quot;</span></span><span lang=EN-US>).Invoke(o, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>null</span></span><span lang=EN-US>); </span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// Hello world</span></span></p>

<p class=MsoNormal>Ещё одно средство динамического создания кода предоставляют <span
class=a2>деревья выражений</span>. Они описывают код в виде древовидной
структуры. Каждый узел в дереве представляет выражение (например, вызов метода
или бинарную операцию) и является объектом класса, унаследованного от <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Expression</span></span>
(пространство имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Linq.Expressions</span></span>).
Рис 11 демонстрирует некоторые классы-выражения.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_20"
 o:spid="_x0000_i1032" type="#_x0000_t75" style='width:468.75pt;height:146.25pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image012.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 11. Классы, унаследованные от <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Expression</span></span>.</p>

<p class=MsoNormal>Универсальный класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Expression</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> позволяет создать
дерево выражений на основе лямбда-выражения:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US>&gt; lambda = n =&gt; n &lt; 5;<span
style='mso-spacerun:yes'>              </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>обычная</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>лямбда</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Expression</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>bool</span></span><span lang=EN-US>&gt;&gt; tree = n =&gt; n &lt;
5;<span style='mso-spacerun:yes'>    </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>дерево</span></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Expression</span></span> содержит статические методы, которые
конструируют узлы дерева выражений особых типов:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// построим вручную дерево выражений для лямбды
n =&gt; n &lt; 5<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParameterExpression</span></span><span
lang=EN-US> n = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Expression</span></span>.Parameter(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>), </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;n&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConstantExpression</span></span><span
lang=EN-US> five = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Expression</span></span>.Constant(5, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BinaryExpression</span></span><span
lang=EN-US> compare = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Expression</span></span>.LessThan(n, five);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Expression</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>bool</span></span><span lang=EN-US>&gt;&gt; tree =</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>            
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Expression</span></span>.Lambda&lt;<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Func</span></span>&lt;</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US>&gt;&gt;(compare, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {n});</span></p>

<p class=MsoNormal>У созданного дерева выражений можно исследовать структуру,
изменять элементы и компилировать его в инструкции CIL:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Expression</span></span><span
lang=EN-US>&lt;<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Func</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>bool</span></span><span lang=EN-US>&gt;&gt; tree = n =&gt; n &lt;
5;</span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// декомпозиция дерева выражений<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>param</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>tree</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Parameters</span><span
style='mso-ansi-language:RU'>[0];<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> op = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BinaryExpression</span></span>) tree.Body;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> left = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ParameterExpression</span></span>) op.Left;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> right = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ConstantExpression</span></span>) op.Right;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;{0} =&gt; {1} {2}
{3}&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                  </span>param.Name, left.Name,
op.NodeType, right.Value);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>компиляция</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>дерева</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>и</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>вызов</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>лямбды</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US>&gt; lambda = tree.Compile();</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>lambda</span><span
style='mso-ansi-language:RU'>(10));<o:p></o:p></span></p>

<h1><a name="_Toc348862513">26. Атрибуты</a></h1>

<p class=MsoNormal>Платформа .NET позволяет расширять метаданные типов и
сборок, используя систему атрибутов. Каждый <span class=a2>атрибут</span> (<span
lang=EN-US style='mso-ansi-language:EN-US'>attribute</span>) описывает
дополнительную информацию, сохраняемую в метаданных для <span class=a2>цели
атрибута</span> (attribute target) – сборки, модуля, типа, элементов типа,
параметров метода. С точки зрения программиста атрибуту соответствует <span
class=a2>класса атрибута</span> – это класс, наследуемый от <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span>.</p>

<p class=MsoNormal>Рассмотрим основные аспекты работы с атрибутами. Для создания
атрибута нужно написать класс, удовлетворяющий перечисленным ниже требованиям:</p>

<p class=MsoNormal>1. Класс должен прямо или косвенно наследоваться от класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span>.</p>

<p class=MsoNormal>2. Тип открытых полей, свойств и параметров конструктора
класса ограничен следующим набором: числовые типы (кроме <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>decimal</span></span>), <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>char</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span>,
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span>,
перечисления; одномерные массивы указанных типов.</p>

<p class=MsoNormal>3. Имя класса должно заканчиваться суффиксом <span
class=af4><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span> (это
необязательное требование).</p>

<p class=MsoNormal>Приведём<span style='mso-ansi-language:EN-US'> </span>пример<span
style='mso-ansi-language:EN-US'> </span>класса<span style='mso-ansi-language:
EN-US'> </span>атрибута<span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AuthorAttribute</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Name { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private set</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
CreationDate { </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>set</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US>
AuthorAttribute(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> name)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Name = name;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для применения атрибута язык C# поддерживает следующий
синтаксис: имя класса атрибута записывается в квадратных скобках перед тем
элементом, к которому он относится. При этом разрешено указывать имя атрибута
без суффикса <span class=af4><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span>.
Применение атрибута условно соответствует созданию объекта. Поэтому после имени
атрибута указываются в круглых скобках аргументы конструктора атрибута. Если у
атрибута конструктор без параметров, круглые скобки можно не писать. Наряду с
аргументами конструктора можно указать <span class=a2>именованные параметры</span>,
предназначенные для задания значения открытого поля или свойства. Для этого
используется синтаксис <span class=af4><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>имя-элемента</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'> = </span></span><span class=af4><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>значение</span></span>. Именованные параметры
всегда записываются в конце списка аргументов конструктора. Ниже<span
style='mso-ansi-language:EN-US'> </span>приведены<span style='mso-ansi-language:
EN-US'> </span>примеры<span style='mso-ansi-language:EN-US'> </span>применения<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AuthorAttribute</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Author</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Brian Kernighan&quot;</span></span><span
lang=EN-US>, CreationDate = </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;01.01.2012&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ColorPlugin</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Author</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Dennis Ritchie&quot;</span></span><span lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
Process() { }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для настройки создаваемого пользовательского атрибута можно
использовать атрибут <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AttributeUsage</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>. Конструктор <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AttributeUsage</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> имеет
единственный параметр – набор элементов перечисления <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AttributeTargets</span></span>,
определяющих цель атрибута. Булево свойство <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AllowMultiple</span></span> определяет, может
ли атрибут быть применён к программному элементу более одного раза. Булево
свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Inherited</span></span>
указывает, будет ли атрибут проецироваться на потомков программного элемента
(по умолчанию значение свойства равно <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span>).</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// атрибут Author можно многократно применить к
классу или методу<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AttributeUsage</span></span>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AttributeTargets</span></span>.Class | <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AttributeTargets</span></span>.Method,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>AllowMultiple = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AuthorAttribute</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
элементы класса для краткости не приводятся<o:p></o:p></span></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Синтаксис применения атрибутов позволяет указать в
квадратных скобках несколько атрибутов через запятую. Если возникает
неоднозначность трактовки цели атрибута, то нужно указать перед именем атрибута
специальный префикс – <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>assembly</span></span>, <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>module</span></span>, <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>field</span></span>, <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>event</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>method</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>param</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>property</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span>,
<span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>type</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// применение атрибута к сборке<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>[</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>assembly</span></span><span style='mso-ansi-language:RU'>: </span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AssemblyKeyFile</span></span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>keys</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>snk</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>)]<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>многократное</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>применение</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>атрибута</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Author</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Brian Kernighan&quot;</span></span><span
lang=EN-US>), <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Author</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Dennis Ritchie&quot;</span></span><span lang=EN-US>)]</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>class</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ColorPlugin</span></span><span
style='mso-ansi-language:RU'> { }<o:p></o:p></span></p>

<p class=MsoNormal>Опишем возможности получения информации о применённых
атрибутах. Метод <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Attribute</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.GetCustomAttributes()</span></span> возвращает все атрибуты
некоторого элемента в виде массива. Метод<span style='mso-ansi-language:EN-US'>
</span><span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>.GetCustomAttribute()</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>получает<span style='mso-ansi-language:
EN-US'> </span>атрибут<span style='mso-ansi-language:EN-US'> </span>заданного<span
style='mso-ansi-language:EN-US'> </span>типа<span lang=EN-US style='mso-ansi-language:
EN-US'>:<o:p></o:p></span></p>

<p class=a><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Attribute</span></span><span lang=EN-US>
GetCustomAttribute(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MemberInfo</span></span> element, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Type</span></span> attributeType)</span></p>

<p class=MsoNormal>При помощи параметра <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>element</span></span> задаётся элемент, у
которого надо получить атрибут. Второй параметр – это тип получаемого атрибута.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// пример получения атрибута<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>author</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Attribute</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>GetCustomAttribute</span><span
style='mso-ansi-language:RU'>(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span style='mso-ansi-language:
RU'>(</span><span class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ColorPlugin</span></span><span
style='mso-ansi-language:RU'>),<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                                          </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>typeof</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AuthorAttribute</span></span>));</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (author != </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(((<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AuthorAttribute</span></span>) author).Name);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Платформа .NET предоставляет для использования обширный
набор атрибутов, некоторая часть которых представлена в табл. 19.</p>

<p class=ae>Таблица 19</p>

<p class=af>Некоторые атрибуты, применяемые в платформе .NET</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Атрибут</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Цель применения</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>AttributeUsage</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Класс</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Задаёт область применения класса-атрибута</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>CallerFilePath</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'>,<o:p></o:p></span></p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>CallerLineNumber</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'>,<o:p></o:p></span></p>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>CallerMemberName</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Опциональный параметр</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Позволяют получить в качестве значений опциональных параметров
  информацию о месте вызова метода в исходном коде программы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Conditional</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Компилятор может игнорировать вызовы помеченного метода при
  заданном условии</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>DllImport</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Импорт функций из DLL</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>MTAThread</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Main()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Для приложения используется модель COM <span lang=EN-US
  style='mso-ansi-language:EN-US'>Multithreaded</span><span lang=EN-US> </span><span
  lang=EN-US style='mso-ansi-language:EN-US'>apartment</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>NonSerialized</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Поле</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Указывает, что поле не будет сериализовано</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Obsolete</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Кроме<span style='mso-ansi-language:EN-US'> </span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>param</span></span><span lang=EN-US
  style='mso-ansi-language:EN-US'>, </span><span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>assembly</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=af1><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>module</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'>, </span><span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>return</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Информирует, что в будущих реализациях данный элемент может
  отсутствовать</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>ParamArray</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Параметр</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Позволяет одиночному параметру быть обработанным как набор
  параметров <span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>params</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Serializable</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Класс, структура, перечисление, делегат</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Указывает, что все поля типа могут быть сериализованы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>STAThread</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Метод <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Main()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Для приложения используется модель COM Single-threaded apartment</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>StructLayout</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Класс, структура</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Задаёт схему размещения данных класса или структуры в памяти (<span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Auto</span></span>, <span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Explicit</span></span>,
  <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>Sequential</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>[</span></span><span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>ThreadStatic</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>]</span></span><span lang=EN-US style='mso-ansi-language:
  EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статическое поле</p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>В каждом потоке будет использоваться собственная копия данного
  статического поля</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Рассмотрим единичный пример использования стандартных
атрибутов. Атрибуты применяются для настройки взаимодействия программ платформы
.NET и библиотек на неуправляемом коде. Атрибут <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DllImport</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> предназначен для импортирования
функций из <span lang=EN-US style='mso-ansi-language:EN-US'>DLL</span>,
написанных на неуправляемом коде. В следующей программе показан импорт
системной функции <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>MessageBoxA()</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>System</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Runtime</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>InteropServices</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DllImport</span></span>(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;user32.dll&quot;</span></span><span lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static extern int</span></span><span
lang=EN-US> MessageBoxA(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> hWnd, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> text,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                         </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> caption, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>uint</span></span><span lang=EN-US> type);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>MessageBoxA(0, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Hello World&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Unmanaged DLL&quot;</span></span><span
lang=EN-US>, 0);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для использования атрибута <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DllImport</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> требуется подключить пространство
имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Runtime.InteropServices</span></span>.
Кроме этого, необходимо объявить импортируемую функцию статической и пометить её
модификатором <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>extern</span></span>. Атрибут <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DllImport</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> допускает использование
дополнительных аргументов, подробное описание которых можно найти в документации
MSDN.</p>

<p class=MsoNormal>Исполняемая среда .NET выполняет корректную передачу
аргументов примитивных типов между управляемым и неуправляемым кодом. Для
правильной передачи сложных аргументов требуется использование специального
атрибута <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StructLayout</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span> при
объявлении пользовательского типа. Например, пусть выполняется экспорт
системной функции <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetLocalTime()</span></span>:</p>

<p class=aCxSpFirst><span style='mso-ansi-language:RU'>[</span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DllImport</span></span><span style='mso-ansi-language:RU'>(</span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>kernel</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>32.</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>dll</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>)]<o:p></o:p></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static extern void</span></span><span
lang=EN-US> GetLocalTime(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SystemTime</span></span> st);</span></p>

<p class=MsoNormal>В качестве параметра функция использует объект класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SystemTime</span></span>.
Этот класс должен быть описан следующим образом:</p>

<p class=aCxSpFirst><span style='mso-ansi-language:RU'>[</span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>StructLayout</span></span><span style='mso-ansi-language:RU'>(</span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>LayoutKind</span></span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Sequential</span><span style='mso-ansi-language:
RU'>)]<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SystemTime</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wYear;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wMonth;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wDayOfWeek;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wDay;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wHour;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wMinute;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public ushort </span></span><span lang=EN-US>wSecond;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'> </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ushort</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span lang=EN-US>wMilliseconds</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Атрибут <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StructLayout</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> с аргументом <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>LayoutKind</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Sequential</span></span>
указывает, что поля объекта должны быть расположены в памяти в точности так,
как это записано в объявлении класса. В противном случае при работе с системной
функцией вероятно возникновение ошибок.</p>

<h1><a name="_Toc348862514">27. Динамическое связывание</a></h1>

<p class=MsoNormal>Определение значения операции, основывающееся на типе или
значении составных частей выражения (аргументов, операндов, получателей) в
языке C# обычно происходит на этапе компиляции и именуется <span class=a2>статическим
связыванием</span> (static binding). Если этот процесс осуществляется при
выполнении программы, то он называется <span class=a2>динамическим связыванием</span>
(dynamic binding). Язык C# поддерживает динамическое связывание, начиная с
четвёртой версии. Цель динамического связывания – позволить программам на C#
взаимодействовать с <span class=a2>динамическими объектами</span>, то есть с
объектами, которые не подчиняются обычным правилам системы типов C#. Примерами
таких объектов являются:</p>

<p class=MsoNormal>– объекты динамических языков (IronPython, IronRuby,
Jscript);</p>

<p class=MsoNormal>– «расширяемые» объекты, которые позволяют добавлять новые
свойства во время выполнения программы (Internet Explorer DOM);</p>

<p class=MsoNormal>– объекты COM (например, в объектной модели Microsoft
Office).</p>

<p class=MsoNormal>Для указания на необходимость динамического связывания в
языке C# используется особый тип – <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>dynamic</span></span>. У объекта такого типа
можно записать вызов любого метода или свойства, это не влияет на компиляцию.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Foo</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
Print(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> s)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(s);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>этот</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>код</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>компилируется</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>,<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// но при выполнении третья строка генерирует
исключение<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> obj = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> Foo();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>obj.Print(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Hello world&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span lang=EN-US>obj</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Property</span><span style='mso-ansi-language:
RU'> = 10;<span style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
RuntimeBinderException</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Тип <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>dynamic</span></span> может использоваться при объявлении локальной
переменной, формального параметра или возвращаемого значения метода, элемента
типа (поля, свойства), сконструированного универсального шаблона. Определено
неявное преобразование <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>dynamic</span></span> и других типов друг в друга.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// метод с dynamic-параметрами и возвращаемым
значением<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public dynamic</span></span><span
lang=EN-US> Div(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> x, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> y)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>x</span><span
style='mso-ansi-language:RU'>/</span><span lang=EN-US>y</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// неявные преобразования<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>i</span><span
style='mso-ansi-language:RU'> = 7;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> d = i;</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> j = d;</span></p>

<p class=MsoNormal>В качестве примера использования <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span>
рассмотрим класс, реализующий <span class=a2>перечисляемый слаботипизированный
кортеж</span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IterableTuple</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private readonly</span></span><span lang=EN-US>
<span class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>List</span></span>&lt;</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US>&gt; _storage;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US>
IterableTuple(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>params dynamic</span></span><span
lang=EN-US>[] args)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>_storage = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>dynamic</span></span><span lang=EN-US>&gt;(args);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IterableTuple</span></span> Create(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>params dynamic</span></span><span lang=EN-US>[] args)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IterableTuple</span></span>(args);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public dynamic this</span></span><span
lang=EN-US>[</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> i]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US> _storage[i];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerator</span></span> GetEnumerator()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US>
_storage.GetEnumerator();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пример</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>использования</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> IterableTuple<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> tuple = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IterableTuple</span></span>.Create(1.5, 12, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;string&quot;</span></span><span
lang=EN-US>, 69);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> item </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> tuple)</span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>item</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Компилятор заменяет объявление <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span> на
объявление <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span>,
поэтому с точки зрения CLR эти типы эквиваленты. Работу с <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span>-объектом
компилятор организует, используя класс <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Microsoft.CSharp.RuntimeBinder.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Binder</span></span>
(сборка <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Microsoft.CSharp.dll</span></span>).
Способ нахождения элементов динамического объекта зависит от его конкретного
типа:</p>

<p class=MsoNormal>1. Обычные объекты .NET – элементы определяются при помощи
механизма отражения, работа с элементами происходит при помощи позднего
связывания.</p>

<p class=MsoNormal>2. Объект, реализующий интерфейс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDynamicMetaObjectProvider</span></span>,
– сам объект запрашивается о том, содержит ли он заданный элемент. В случае
успеха работа с элементом делегируется объекту.</p>

<p class=MsoNormal>3. COM-объекты – работа происходит через интерфейс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDispatch</span></span>.</p>

<p class=MsoNormal>Интерфейс <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IDynamicMetaObjectProvider</span></span>
позволяет разработчикам создавать типы, обладающие динамическим поведением.
Обычно данный интерфейс не реализуется напрямую, а выполняется наследование от
класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DynamicObject</span></span>
(интерфейс и класс находятся в пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Dynamic</span></span>). В качестве
примера использования <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DynamicObject</span></span> приведём класс, обеспечивающий
динамический доступ к атрибутам XML-элемента:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XExtensions</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static dynamic</span></span><span
lang=EN-US> DynamicAttributes(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>this</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span> e)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XWrapper</span></span>(e);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XWrapper</span></span> : <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DynamicObject</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private readonly</span></span><span lang=EN-US>
<span class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span> _element;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> XWrapper(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span> e)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span>_</span><span lang=EN-US>element</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>e</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
метод вызывается при попытке прочитать значение свойства<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public
override bool</span></span><span lang=EN-US> TryGetMember(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetMemberBinder</span></span>
binder,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                          </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>out object</span></span><span lang=EN-US>
result)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>result =
_element.Attribute(binder.Name).Value;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
метод вызывается при попытке установить значение свойства<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public
override bool</span></span><span lang=EN-US> TrySetMember(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SetMemberBinder</span></span>
binder,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                          </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> value)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>           
</span>_element.SetAttributeValue(binder.Name, value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пример</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>работы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>с</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
XWrapper<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span><span
lang=EN-US> x = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span>.Parse(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>@&quot;&lt;Label
Text=&quot;&quot;Hello&quot;&quot; Id=&quot;&quot;5&quot;&quot;/&gt;&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> da = x.DynamicAttributes();</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(da.Id);<span style='mso-spacerun:yes'>           </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// 5</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>da.Text = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Foo&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(x.ToString());<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// &lt;Label
Text=&quot;Foo&quot; Id=&quot;5&quot; /&gt;</span></span></p>

<p class=MsoNormal>Класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Dynamic.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span> позволяет при
выполнении программы добавлять и удалять элементы своего экземпляра:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public sealed class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span> : <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDynamicMetaObjectProvider</span></span>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                    </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IDictionary</span></span></span><span style='mso-ansi-language:
RU'>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
style='mso-ansi-language:RU'>, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
style='mso-ansi-language:RU'>&gt;,<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                                    </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>INotifyPropertyChanged</span></span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'><o:p></o:p></span></span></p>

<p class=MsoNormal>Благодаря динамической типизации работа с пользовательскими
элементами <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span>
происходит как работа с обычными элементами объекта. Ниже приведён пример
расширения <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span>
двумя свойствами и методом (в виде делегата).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> sample = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>sample.Caption = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;The caption&quot;</span></span><span lang=EN-US>;<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>добавляем</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>свойство</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> Caption</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>sample</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Number</span><span style='mso-ansi-language:RU'> =
10;<span style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'>   </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
и числовое свойство Number</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>sample.Increment = (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span>)
(() =&gt; { sample.Number++; });</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>работаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>с</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>объектом</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> sample<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(sample.Caption);<span
style='mso-spacerun:yes'>              </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// The caption</span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(sample.Caption.GetType());<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// System.String</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>sample.Increment();</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(sample.Number);<span
style='mso-spacerun:yes'>               </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// 11</span></span></p>

<p class=MsoNormal>Объект<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>явно<span style='mso-ansi-language:
EN-US'> </span>реализует<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDictionary</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>, </span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&gt;</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>Это позволяет инспектировать элементы объекта при выполнении
программы и при необходимости удалять их.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// этот метод преобразует ExpandoObject в
XElement<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XElement</span></span> ExpandoToXml(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span lang=EN-US> node, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> nodeName)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> xmlNode = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>XElement</span></span>(nodeName);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>foreach</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> property </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>in</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IDictionary</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>string</span></span><span lang=EN-US>, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>object</span></span><span lang=EN-US>&gt;) node)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US>
(property.Value </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>is</span></span><span
lang=EN-US> ExpandoObject)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>           
</span>xmlNode.Add(ExpandoToXml(property.Value, property.Key));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>else if</span></span><span lang=EN-US>
(property.Value.GetType() == </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>dynamic</span></span><span lang=EN-US>&gt;))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>foreach</span></span><span lang=EN-US> (</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>dynamic</span></span><span lang=EN-US> el </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>List</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span lang=EN-US>&gt;)
property.Value)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>xmlNode.Add(ExpandoToXml(el,
property.Key));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>       </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>else<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>xmlNode.Add(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XElement</span></span>(property.Key,
property.Value));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>return xmlNode;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>пример</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>работы</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>с</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>
ExpandoToXml()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> contact = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Name = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Patrick Hines&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Phone = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;206-555-0144&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Address = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ExpandoObject</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Address.Street = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;123 Main St&quot;</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Address.City = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Mercer Island&quot;</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Address.State = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;WA&quot;</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>contact.Address.Postal = </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;68402&quot;</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>dynamic</span></span><span
lang=EN-US> res = ExpandoToXml(contact, </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Contact&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(res);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>будет</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>выведен</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>следующий</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> <span
lang=EN-US>XML-</span></span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>фрагмент</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// &lt;Contact&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// <span
style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'> </span>&lt;Name&gt;Patrick Hines&lt;/Name&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// <span
style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'> </span>&lt;Phone&gt;206-555-0144&lt;/Phone&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// <span
style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'> </span>&lt;Address&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span>&lt;Street&gt;123 Main St&lt;/Street&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span>&lt;City&gt;Mercer Island&lt;/City&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'> </span>&lt;State&gt;WA&lt;/State&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>//<span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'> </span>&lt;Postal&gt;68402&lt;/Postal&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// <span
style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'> </span>&lt;/Address&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// &lt;/Contact&gt;<o:p></o:p></span></span></p>

<h1><a name="_Toc348862515"><span lang=EN-US style='mso-ansi-language:EN-US'>28.
</span>Файлы</a><span style='mso-bookmark:_Toc348862515'><span
style='mso-ansi-language:EN-US'> </span>конфигурации</span><span
style='mso-bookmark:_Toc348862515'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h1>

<p class=MsoNormal>Конфигурирование применяется для решения двух основных
задач. Во-первых, параметры конфигурации позволяют настроить поведение CLR при
выполнении кода приложения. Во-вторых, конфигурация может хранить
пользовательские данные приложения.</p>

<p class=MsoNormal>Платформа .NET предлагает унифицированный подход к
конфигурированию, основанный на использовании <span class=a2>конфигурационных
XML-файлов</span>. Существует один глобальный файл конфигурации с параметрами,
относящимися к платформе в целом. Этот файл называется <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>machine.config</span></span> и располагается в
каталоге установки платформы .NET. Любая сборка может иметь локальный
конфигурационный файл. Он должен носить имя файла сборки с добавлением
расширения <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>.config</span></span>
и располагаться в одном каталоге со сборкой (то есть файл конфигурации для <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>main.exe</span></span> должен
называться <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>main.exe.config</span></span><a
style='mso-footnote-id:ftn29' href="#_ftn29" name="_ftnref29" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[29]</span></span><![endif]></span></span></a>).
Параметры, описанные в локальных конфигурационных файлах, «накладываются» на
параметры из файла <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>machine.config</span></span>.</p>

<p class=MsoNormal>Проанализируем общую схему любого файла конфигурации.
Корневым XML-элементом файла является элемент <span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>configuration</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>.
Он может включать следующие дочерние элементы:</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configSections</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span> –
описывает разделы конфигурации (в том числе пользовательские);</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>appSettings</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span> –
пользовательские параметры конфигурации;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>connectionStrings</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span> –
строки подключения к источникам данных;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>startup</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span> – параметры
запуска CLR (поддерживаемые версии);</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>runtime</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span> –
параметры времени выполнения (регулируют способ загрузки сборок и работу
сборщика мусора);</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>system</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>.</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>diagnostics</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
– совокупность диагностических параметров, которые задают способ отладки,
перенаправляют сообщения отладки и т. д.;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>system</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>.</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>net</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
– настройка параметров работы с сетью;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>system</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>.</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>serviceModel</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
– настройка элементов технологии WCF;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>system</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>.</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>web</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
– параметры конфигурации приложений ASP.NET.</p>

<p class=MsoNormal>Рассмотрим способы описания в файле конфигурации
пользовательских данных. В простейшем случае для этого используется раздел <span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>appSettings</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>,
который может содержать следующие элементы:</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>add</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=XML><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>key</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>=&quot;</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>name</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot; </span></span><span
class=XML><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>value</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>=&quot;</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>the</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>value</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;/&gt;</span></span>
– добавляет новый ключ и значение в коллекцию пользовательских конфигурационных
данных;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>remove</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=XML><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>key</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>=&quot;</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>name</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;/&gt;</span></span>
– удаляет существующий ключ и значение из коллекции конфигурационных данных;</p>

<p class=MsoNormal><span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>clear</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>/&gt;</span></span> –
очищает коллекцию конфигурационных данных.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;?</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xml</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> </span></span><span class=XML><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>version</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;1.0&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>encoding</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;utf-8&quot;
?&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configuration</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>appSettings</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>add</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>key</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;company&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>value</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;Acme,
Ltd&quot;/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>add</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>key</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;year&quot; </span></span><span class=XML><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>value</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;2012&quot;/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>appSettings</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configuration</span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Разработчик может создать собственный раздел
конфигурационного файла. Такой раздел должен быть зарегистрирован в секции <span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>configSections</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>.
При регистрации раздела задаётся его <span class=a2>обработчик</span> – класс,
который будет отвечать за превращение содержимого раздела в данные. В
зависимости от типа хранимых данных можно воспользоваться одним из существующих
обработчиков либо построить собственный обработчик.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;?</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>xml</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> </span></span><span class=XML><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>version</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;1.0&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>encoding</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;utf-8&quot;
?&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configuration</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>configSections</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>section</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>name</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;custom&quot; </span></span><span class=XML><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>type</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;Common.CustomConfig, Common&quot;/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>configSections</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span></span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>&lt;!-- </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>пользовательская</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>секция</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> --&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>custom</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>copyright</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>company</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;Acme, Ltd&quot; </span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>year</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;2012&quot;/&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span></span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;/</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>custom</span></span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configuration</span></span><span class=ac><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Если планируется использование собственного обработчика
конфигурационного раздела, следует создать класс, производный от <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationSection</span></span><a
style='mso-footnote-id:ftn30' href="#_ftn30" name="_ftnref30" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[30]</span></span><![endif]></span></span></a>.
В классе определяются открытые свойства, соответствующие XML-атрибутам или
вложенным элементам конфигурации. Этим свойствам назначается специальный
атрибут <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationProperty</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>. Следующий
код показывает пример пользовательского обработчика <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CustomConfig</span></span>.</p>

<p class=aCxSpFirst><a name="OLE_LINK8"></a><a name="OLE_LINK7"><span
style='mso-bookmark:OLE_LINK8'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>namespace</span></span><span
lang=EN-US> Common</span></span></a></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CustomConfig</span></span> : <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationSection</span></span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationProperty</span></span>(</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;copyright&quot;</span></span><span
lang=EN-US>, IsRequired = </span></span></span><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
lang=EN-US>)]</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Element</span></span> Copyright</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Element</span></span>) </span></span></span><span style='mso-bookmark:
OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>base</span></span><span lang=EN-US>[</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;copyright&quot;</span></span><span
lang=EN-US>]; }</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public class</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Element</span></span> : <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationElement</span></span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationProperty</span></span>(</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;company&quot;</span></span><span
lang=EN-US>, IsRequired = </span></span></span><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
lang=EN-US>)]</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Company</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> (</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>) </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>[</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;company&quot;</span></span><span
lang=EN-US>]; }</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US> { </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>[</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;company&quot;</span></span><span
lang=EN-US>] = </span></span></span><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>value</span></span><span
lang=EN-US>; }</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationProperty</span></span>(</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;year&quot;</span></span><span lang=EN-US>,
IsRequired = </span></span></span><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
lang=EN-US>)]</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public int</span></span><span lang=EN-US> Year</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>{</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>     </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US> { </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> (</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>) </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>[</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;year&quot;</span></span><span lang=EN-US>];
}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>set</span></span><span lang=EN-US> { </span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>base</span></span><span lang=EN-US>[</span></span></span><span
style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:OLE_LINK8'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;year&quot;</span></span><span lang=EN-US>]
= </span></span></span><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>value</span></span><span
lang=EN-US>; }</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>}</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK7'><span
style='mso-bookmark:OLE_LINK8'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>}</span></span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK7'><span style='mso-bookmark:
OLE_LINK8'><span lang=EN-US>}</span></span></span></p>

<span style='mso-bookmark:OLE_LINK8'></span><span style='mso-bookmark:OLE_LINK7'></span>

<p class=MsoNormal>Для<span style='mso-ansi-language:EN-US'> </span>программного<span
style='mso-ansi-language:EN-US'> </span>доступа<span style='mso-ansi-language:
EN-US'> </span>к<span style='mso-ansi-language:EN-US'> </span>конфигурационным<span
style='mso-ansi-language:EN-US'> </span>данным<span style='mso-ansi-language:
EN-US'> </span>текущего<span style='mso-ansi-language:EN-US'> </span>приложения<span
style='mso-ansi-language:EN-US'> </span>используется<span style='mso-ansi-language:
EN-US'> </span>статический<span style='mso-ansi-language:EN-US'> </span>класс<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ConfigurationManager</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>из<span style='mso-ansi-language:
EN-US'> </span>пространства<span style='mso-ansi-language:EN-US'> </span>имён<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>System.Configuration</span></span><a
style='mso-footnote-id:ftn31' href="#_ftn31" name="_ftnref31" title=""><span
class=MsoFootnoteReference><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span lang=EN-US style='font-size:14.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
RU;mso-bidi-language:AR-SA'>[31]</span></span><![endif]></span></span></span></a><span
lang=EN-US style='mso-ansi-language:EN-US'> (</span>сборка<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>System.Configuration.dll</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>). </span>Класс имеет следующие
элементы:</p>

<p class=MsoNormal>1. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppSettings</span></span>
– коллекция-словарь пользовательских параметров;</p>

<p class=MsoNormal>2. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConnectionStrings</span></span>
– словарь строк подключения к источникам данных;</p>

<p class=MsoNormal>3. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetSection()</span></span>
– извлекает указанный раздел конфигурации;</p>

<p class=MsoNormal>4. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>OpenExeConfiguration()</span></span>
– открывает файл конфигурации указанной сборки в виде объекта <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Configuration</span></span>;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>5. </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>OpenMachineConfiguration()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> – </span>открывает<span
style='mso-ansi-language:EN-US'> </span>файл<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>machine.config</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>;<o:p></o:p></span></p>

<p class=MsoNormal>6. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>RefreshSection()</span></span>
– перечитывает указанный раздел конфигурации.</p>

<p class=MsoNormal>Покажем пример работы с коллекцией данных <span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&lt;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>appSettings</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>
и пользовательским разделом конфигурации при помощи <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationManager</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> name = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ConfigurationManager</span></span>.AppSettings[</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;company&quot;</span></span><span
lang=EN-US>];</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> s = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CustomConfig</span></span>)
ConfigurationManager.GetSection(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;custom&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> company = s.Copyright.Company;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> year = s.Copyright.Year;</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Copyright © {0} by
{1}&quot;</span></span><span lang=EN-US>, year, company);</span></p>

<p class=MsoNormal>Метод<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConfigurationManager</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>.OpenExeConfiguration()</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>позволяет<span style='mso-ansi-language:
EN-US'> </span>загрузить<span style='mso-ansi-language:EN-US'> </span>конфигурацию<span
style='mso-ansi-language:EN-US'> </span>заданной<span style='mso-ansi-language:
EN-US'> </span>сборки<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>виде<span style='mso-ansi-language:
EN-US'> </span>объекта<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Configuration</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Это класс содержит
коллекции, описывающие секции конфигурационного файла, а также методы для
записи конфигурационного файла.</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>получаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>конфигурацию</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>сборки</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> common.exe<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> cfg = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ConfigurationManager</span></span>.OpenExeConfiguration(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;common.exe&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// находим секцию и изменяем данные в ней<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> section = (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CustomConfig</span></span>) cfg.Sections[</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;custom&quot;</span></span><span
lang=EN-US>];</span></p>

<p class=aCxSpMiddle><span lang=EN-US>section.Copyright.Year = 2013;</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>обновляем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>конфигурацию</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpLast><span lang=EN-US>cfg.Save();</span></p>

<p class=MsoNormal>При работе в Visual Studio можно создать так называемые <span
class=a2>пользовательские настройки</span>. Для этого используется окно свойств
проекта (<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Project
| Properties | Settings</span></span>). Для каждого параметра указывается имя,
тип и область видимости&nbsp;– глобальная или локальная (для конкретного
пользователя).</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_21"
 o:spid="_x0000_i1031" type="#_x0000_t75" style='width:483.75pt;height:256.5pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image013.png" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 12. Редактирование пользовательских настроек.</p>

<p class=MsoNormal>Visual Studio автоматически генерирует для работы с пользовательскими
настройками класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Settings</span></span>, размещённый в подпространстве имён <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Properties</span></span>.
Параметры настройки доступны через свойство <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Settings</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.Default</span></span>. Если у параметра локальная
область видимости, его можно не только прочитать, но и изменить, а затем
сохранить.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Settings</span></span>.Default.Company);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Settings</span></span>.Default.Year);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Settings</span></span><span
lang=EN-US>.Default.Year = 2013;</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Settings</span></span><span
lang=EN-US>.Default.Save();</span></p>

<h1><a name="_Toc348862516">29. Диагностика и мониторинг</a></h1>

<p class=MsoNormal>Рассмотрим некоторые средства языка C# и платформы .NET,
облегчающие диагностику проблем и мониторинг поведения приложения.</p>

<p class=MsoNormal>Описание средств диагностики начнём с <span class=a2>условной
компиляции</span>, выполняемой при помощи специальных директив препроцессора.
Директива <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>#</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>define</span></span> служит для перевода <span
class=a2>символа условной компиляции</span> в состояние «определён». Символом
условной компиляции может служить любой идентификатор или ключевое слово, за
исключением <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span>
или <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>false</span></span>.
Директива <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>#</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>undef</span></span> переключает символ условной
компиляции в состояние «не определён». Обе директивы должны располагаться в
самом начале файла с исходным кодом и могут повторяться произвольное количество
раз.</p>

<p class=MsoNormal>Директивы <span class=ac><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>#</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span> и <span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>endif</span></span>
позволяют задать в исходном коде регион, который компилируется, только если
символ условной компиляции, указанный после <span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span>,
определён.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>#define</span></span><span
lang=EN-US> TESTMODE</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Program</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>#if</span></span><span
lang=EN-US> TESTMODE</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;In test mode!&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>endif</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Внутри региона <span class=ac><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>#</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span> – <span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>endif</span></span>
можно применять директивы <span class=ac><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>#</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>else</span></span>, <span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>elif</span></span>
(это эквивалент <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>#</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>else</span></span><span class=ac><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> #</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span>),
а символы условной компиляции после <span class=ac><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>#</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span>
комбинировать при помощи операций <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&amp;&amp;</span></span>, <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>||</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>!</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>#define</span></span><span
lang=EN-US> TESTMODE</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>#define</span></span><span
lang=EN-US> V2</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> TestType = </span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>#if</span></span><span
lang=EN-US> V2 &amp;&amp; TESTMODE</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>MyCompany.<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GadgetV2</span></span>;</span></p>

<p class=aCxSpMiddle><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>else</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>MyCompany</span><span
style='mso-ansi-language:RU'>.</span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Gadget</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpLast><span class=ac><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>#</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>endif</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=MsoNormal>Заметим, что символ условной компиляции можно определить не
только с помощью <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>#</span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>define</span></span>, но и указав ключ
компилятора командной строки <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>/define</span></span> или используя окно свойств проекта в Visual
Studio (в этих случаях символ считается определённым не в отдельном файле, а во
всех файлах проекта). Visual Studio назначает в отладочной конфигурации проекта
символы условной компиляции <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DEBUG</span></span> и <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TRACE</span></span>, а в выпускной конфигурации – только символ <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TRACE</span></span>.</p>

<p class=MsoNormal>Метод класса или структуры, который возвращает значение <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>void</span></span>,
может быть помечен атрибутом <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Conditional</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span> с указанием символа условной
компиляции. Если символ не определён, компилятор исключит из кода все вызовы
помеченного метода.</p>

<p class=aCxSpFirst><span lang=EN-US>[<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Conditional</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;TESTMODE&quot;</span></span><span
lang=EN-US>)]</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>private void</span></span><span
lang=EN-US> WriteInLog(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> message)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(message);</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Атрибутом<span style='mso-ansi-language:EN-US'> </span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Conditional</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>]</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>может<span style='mso-ansi-language:
EN-US'> </span>быть<span style='mso-ansi-language:EN-US'> </span>помечен<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>класс<span style='mso-ansi-language:EN-US'> </span>атрибута<span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>В этом случае помеченный
атрибут применяется к своей цели, только если указанный символ условной
компиляции определён.</p>

<p class=MsoNormal>При мониторинге работы программы полезным оказывается
возможность вывода и фиксации различных диагностических сообщений. Для этой
цели можно применить статические классы <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Debug</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span> из
пространства имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Diagnostics</span></span>.
Эти классы похожи, но все методы класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Debug</span></span> помечены атрибутом <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Conditional</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>(</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DEBUG</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>)]</span></span>, а все
методы класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Trace</span></span> – атрибутом <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Conditional</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>(</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TRACE</span></span><span
class=ad><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>)]</span></span>. Классы <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Debug</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span>
содержат статические методы вывода сообщений <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Write()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WriteLine()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WriteIf()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Fail()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Assert()</span></span>. В классе <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span>
определены дополнительные методы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TraceInformation()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TraceWarning()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TraceError()</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// примеры вызова методов у классов Debug и
Trace<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Debug</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Debug message&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Debug</span></span><span
lang=EN-US>.WriteIf(5 &gt; 2, </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Correct
condition&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Debug</span></span><span
lang=EN-US>.Fail(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Error in code&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Debug</span></span><span
lang=EN-US>.Assert(3 &lt; 2, </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Error
in condition&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span><span
lang=EN-US>.TraceInformation(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Info&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>Классы<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Debug</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Trace</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>
</span>имеют<span style='mso-ansi-language:EN-US'> </span>свойство<span
style='mso-ansi-language:EN-US'> </span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Listeners</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>содержащее<span
style='mso-ansi-language:EN-US'> </span>коллекцию<span style='mso-ansi-language:
EN-US'> </span><span class=a2>слушателей</span><span lang=EN-US
style='mso-ansi-language:EN-US'> – </span>объектов<span style='mso-ansi-language:
EN-US'> </span>классов<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>производных<span
style='mso-ansi-language:EN-US'> </span>от<span style='mso-ansi-language:EN-US'>
</span><span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TraceListener</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Слушатели ответственны за
обработку содержимого, генерируемого методами вывода сообщений. По умолчанию
коллекция <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Listeners</span></span>
включает одного слушателя – объект класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DefaultTraceListener</span></span>. Этот
слушатель записывает сообщения в окно отладчика Visual Studio, а при вызове
метода <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Fail()</span></span>
или нарушении условия в методе <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Assert()</span></span> выводит диалоговое окно для подтверждения
выполнения программы. Данное поведение можно изменить, удалив слушатель или
добавив один или несколько собственных слушателей. Слушатель можно создать,
унаследовав от класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TraceListener</span></span> или воспользоваться одним из готовых
классов:</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextWriteTraceListener</span></span> – пишет в поток, или в <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TextWriter</span></span>,
или в файл. Имеет<span style='mso-ansi-language:EN-US'> </span>подклассы<span
style='mso-ansi-language:EN-US'> </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ConsoleTraceListener</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DelimitedListTraceListener</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlWriterTraceListener</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>EventSchemaTraceListener</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EventLogTraceListener</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> – </span>пишет<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>журнал<span
style='mso-ansi-language:EN-US'> </span>событий<span style='mso-ansi-language:
EN-US'> <span lang=EN-US>Windows. </span></span>При этом сообщения, выводимые методами
<span class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>TraceWarning</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>()</span></span> и <span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>TraceError</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>, выводятся как
предупреждения и ошибки соответственно.</p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EventProviderTraceListener</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> – </span>пишет<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>подсистему<span
lang=EN-US style='mso-ansi-language:EN-US'> ETW </span>в<span lang=EN-US
style='mso-ansi-language:EN-US'> Windows Vista.<o:p></o:p></span></p>

<p class=MsoNormal><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>WebPageTraceListener</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> – </span>пишет<span style='mso-ansi-language:
EN-US'> </span>на<span style='mso-ansi-language:EN-US'> </span>веб<span
lang=EN-US style='mso-ansi-language:EN-US'>-</span>страницу<span lang=EN-US
style='mso-ansi-language:EN-US'> ASP.NET.<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// удаляем слушатель по умолчанию<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Listeners</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Clear</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// добавляем слушатель для записи в конец файла<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span><span
lang=EN-US>.Listeners.Add(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TextWriterTraceListener</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;trace.txt&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>настраиваем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>журнал</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>событий</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> Windows<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (!<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>EventLog</span></span>.SourceExists(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;DemoApp&quot;</span></span><span
lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>EventLog</span></span>.CreateEventSource(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;DemoApp&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Application&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>и</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>добавляем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>соответствующий</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>слушатель</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span><span
lang=EN-US>.Listeners.Add(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>EventLogTraceListener</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;DemoApp&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// пишем несколько сообщений в файл и журнал
событий<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span><span
lang=EN-US>.WriteLine(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;message&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Trace</span></span><span
lang=EN-US>.TraceError(</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;error&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=MsoNormal>В классе <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TraceListener</span></span> определено свойство
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Filter</span></span>,
которое можно установить для фильтрации сообщений. Кроме этого, имеется
несколько свойств для управления внешним видом выводимых сообщений.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> listener = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TextWriterTraceListener</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;trace.txt&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>listener.Filter = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SourceFilter</span></span>(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Program&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span lang=EN-US>listener</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>IndentSize</span><span style='mso-ansi-language:
RU'> = 4;<o:p></o:p></span></p>

<p class=MsoNormal>Для слушателей, которые пишут информацию в кэшируемый поток
(например, слушатель <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TextWriteTraceListener</span></span>), рекомендуется перед
окончанием работы приложения вызывать методы <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Close()</span></span> или <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Fl</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>u</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>sh()</span></span>. Такие же
методы есть у классов <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Debug</span></span> и <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Trace</span></span>. Если у этих классов
установить свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AutoFl</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>u</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>sh</span></span> в <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span>, то метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Fl</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>u</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>sh()</span></span> будет вызываться после
каждого сообщения.</p>

<p class=MsoNormal>Отметим, что настройка слушателей может быть выполнена не
только программно, но и декларативно – с использованием конфигурационного файла
приложения (секция <span class=ac><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&lt;</span></span><span class=ad><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>system</span></span><span class=ad><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>.</span></span><span
class=ad><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>diagnostics</span></span><span
class=ac><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&gt;</span></span>):</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configuration</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>system.diagnostics</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>trace</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>autoflush</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;true&quot; </span></span><span class=XML><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>indentsize</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>=&quot;2&quot;&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>listeners</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>        </span>&lt;</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>add</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=XML><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>name</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>=&quot;lst&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>             </span></span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>type</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;System.Diagnostics.TextWriterTraceListener,<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>                   </span>System, Version=1.0.3300.0,
Culture=neutral,<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>                  
</span>PublicKeyToken=b77a5c561934e089&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>             </span></span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>initializeData</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;MyListener.log&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>             </span></span></span><span class=XML><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>traceOutputOptions</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>=&quot;ProcessId,
Timestamp&quot; /&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>      </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>listeners</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>    </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>trace</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>  </span>&lt;/</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>system.diagnostics</span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;/</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>configuration</span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal>Ещё один полезный класс из пространства имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Diagnostics</span></span> – класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stopwatch</span></span>.
Он предоставляет набор методов и средств, которые можно использовать для
точного измерения затраченного времени. В типовом сценарии использования у
экземпляра <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stopwatch</span></span>
вызывается метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Start()</span></span>,
затем – метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Stop()</span></span>,
а затраченное время проверяется при помощи свойства <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Elapsed</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// замерим скорость подсчёта факториала 10000<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>sw</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Stopwatch</span></span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>sw.Start();</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span><span
lang=EN-US> factorial = 1;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> i = 2; i &lt; 10000; i++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>factorial *= i;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>sw.Stop();</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(sw.Elapsed);<span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'> </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// 00:00:00.0909346</span></span></p>

<h1><a name="_Toc348862517">30. Процессы и домены</a></h1>

<p class=MsoNormal>Любому запущенному приложению в операционной системе
соответствует некий <span class=a2>процесс</span>. Процесс образует границы
приложения, выделяя для приложения изолированное адресное пространство и
поддерживая один или несколько потоков выполнения. Для работы с процессами в
платформе .NET имеется класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Diagnostics.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Process</span></span>. Используя статические и
экземплярные элементы этого класса можно получить информацию о текущем
процессе, а также обо всех процессах системы.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Process</span></span><span
lang=EN-US> current = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Process</span></span>.GetCurrentProcess();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Process</span></span> p </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Process</span></span>.GetProcesses())</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;{0} {1} {2}&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                       </span>p.Id, p.ProcessName,
p.StartTime);</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Process</span></span> позволяет управлять процессами (при наличии
соответствующих привилегий). В следующем примере запускается приложение
«Блокнот», которое завершается через 5 секунд.</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Process</span></span><span
lang=EN-US> p = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Process</span></span>.Start(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;notepad.exe&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Sleep</span><span
style='mso-ansi-language:RU'>(5000);<o:p></o:p></span></p>

<p class=aCxSpLast><span lang=EN-US>p</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Kill</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=MsoNormal>Платформа .NET вводит дополнительный уровень изоляции кода,
называемый <span class=a2>доменом приложения</span>. Домены существуют внутри
процессов и содержат загруженные сборки (можно создать сборку, разделяемую
между доменами). Любой процесс запускает при старте домен по умолчанию, однако
домены могут создаваться и уничтожаться в ходе работы в рамках процесса. Домены
обеспечивают приемлемый уровень изоляции кода, но их создание менее затратное,
чем создание отдельных процессов. Кроме того, домен можно уничтожить, не
нарушая целостность работы всего процесса.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_9"
 o:spid="_x0000_i1030" type="#_x0000_t75" style='width:354.75pt;height:336pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image014.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 13. Структура .NET-процесса с двумя доменами.</p>

<p class=MsoNormal>Домены приложений инкапсулированы в объектах класса <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span>.
Статическое свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CurrentDomain</span></span>
позволяет получить информацию о текущем домене, а статические методы наподобие <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CreateDomain()</span></span> –
создать новый домен в рамках текущего процесса. После создания домена в него
можно программно загрузить сборки, используя экземплярный метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Load()</span></span>. Выгрузить сборки из
домена нельзя, можно выгрузить весь домен:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>newDomain</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>CreateDomain</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>New</span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'> </span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Domain</span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>newDomain.Load(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;assemblyName&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span><span
lang=EN-US>.Unload(newDomain);</span></p>

<p class=MsoNormal>Событие <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>UnhandledException</span></span> объекта <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span>
генерируется при возникновении в домене необработанного исключения:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AppDomain</span></span><span
lang=EN-US> domain = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AppDomain</span></span>.CurrentDomain;</span></p>

<p class=aCxSpMiddle><span lang=EN-US>domain.UnhandledException += </span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>         
</span>(sender, args) =&gt; <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(args.ExceptionObject);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// необработанное исключение генерирует событие
UnhandledException<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>x</span><span
style='mso-ansi-language:RU'> = 0;<o:p></o:p></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>y</span><span
style='mso-ansi-language:RU'> = 10/</span><span lang=EN-US>x</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=MsoNormal>Домены содержат методы для создания экземпляров объектов
требуемых типов (например, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CreateInstance(</span></span>)). Однако доступ к созданным экземплярам
нетривиален – фактически, это межпрограммное взаимодействие, для которого
существуют специальные технологии.</p>

<h1><a name="_Toc348862518">31. Основы многопоточного программирования</a></h1>

<p class=MsoNormal>Платформа .NET даёт полноценную поддержку для создания
многопоточных приложений. Исполняющая среда имеет особый модуль, ответственный
за организацию многопоточности, но в основном работа модуля опирается на
функции многопоточности операционной системы. В этом параграфе рассматриваются
базовые приёмы создания многопоточных приложений.</p>

<p class=MsoNormal>Основные классы, предназначенные для поддержки
многопоточности, сосредоточены в пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Threading</span></span>. На платформе
.NET каждый <span class=a2>поток выполнения</span> (thread) представлен
объектом класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>. Для организации собственного потока
необходимо создать объект этого класса. Класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span> имеет четыре перегруженные
версии конструктора:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span><span lang=EN-US>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ThreadStart</span></span> start);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span><span lang=EN-US>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ThreadStart</span></span> start, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US> maxStackSize);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span><span lang=EN-US>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ParameterizedThreadStart</span></span> start);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public </span></span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span><span lang=EN-US>(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ParameterizedThreadStart</span></span> start, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>
maxStackSize);</span></p>

<p class=MsoNormal>В качестве первого аргумента конструктору передаётся
делегат, инкапсулирующий метод, выполняемый в потоке. Доступно два типа
делегатов: второй позволяет при запуске метода передать ему данные в виде
объекта:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public delegate void</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadStart</span></span>();</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public delegate void</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ParameterizedThreadStart</span></span>(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US> obj);</span></p>

<p class=MsoNormal>Дополнительный параметр конструктора класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span><span
lang=EN-US> </span>может использоваться для указания максимального размера
стека, выделяемого потоку<a style='mso-footnote-id:ftn32' href="#_ftn32"
name="_ftnref32" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[32]</span></span><![endif]></span></span></a>.</p>

<p class=MsoNormal>Создание потока не подразумевает его автоматического запуска.
Для запуска потока требуется вызвать метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Start()</span></span> (перегруженная версия
метода получает объект, передаваемый как аргумент методу потока).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> th = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span>(DoSomeWork);</span></p>

<p class=aCxSpLast><span lang=EN-US>th</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Start</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=MsoNormal>Рассмотрим основные свойства класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>:</p>

<p class=MsoNormal>1. Статическое свойство <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CurrentThread</span></span> возвращает объект,
представляющий текущий поток.</p>

<p class=MsoNormal>2. Свойство <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Name</span></span> служит для назначения потоку имени.</p>

<p class=MsoNormal>3. Целочисленное свойство для чтения <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ManagedThreadId</span></span> возвращает
уникальный числовой идентификатор управляемого потока.</p>

<p class=MsoNormal>4. Свойство для чтения <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadState</span></span>, значением которого
являются элементы одноимённого перечисления, позволяет получить текущее
состояние потока.</p>

<p class=MsoNormal>5. Булево свойство для чтения <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IsAlive</span></span> позволяет определить,
выполняется ли поток.</p>

<p class=MsoNormal>6. Свойство <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Priority</span></span> управляет приоритетом выполнения потока
относительно текущего процесса. Значением этого свойства являются элементы
перечисления <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ThreadPriority</span></span>: <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Lowest</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BelowNormal</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Normal</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AboveNormal</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Highest</span></span>.</p>

<p class=MsoNormal>7. Булево свойство <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IsBackground</span></span> позволяет сделать
поток фоновым. Среда исполнения .NET разделяет все потоки на <span class=a2>фоновые</span>
и <span class=a2>основные</span>. Процесс не может завершиться, пока не
завершены все его основные потоки. В то же время, завершение процесса
автоматически прерывает все фоновые потоки<a style='mso-footnote-id:ftn33'
href="#_ftn33" name="_ftnref33" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[33]</span></span><![endif]></span></span></a>.</p>

<p class=MsoNormal>8. Свойства <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CurrentCulture</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CurrentUICulture</span></span> имеют тип <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CultureInfo</span></span>
и задают текущую языковую культуру.</p>

<p class=MsoNormal>Следующий пример демонстрирует настройку свойств потока.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> th = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span>(DoSomeWork)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>             </span>Name = </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Example Thread&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>             </span>Priority = <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadPriority</span></span>.BelowNormal,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>     
</span><span style='mso-spacerun:yes'>       </span>IsBackground = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>             </span>CurrentCulture = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CultureInfo</span></span>(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;ru-RU&quot;</span></span><span
lang=EN-US>)</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>        
</span></span><span style='mso-ansi-language:RU'>};<o:p></o:p></span></p>

<p class=MsoNormal>Кроме свойств, класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span> содержит методы для
управления потоком. Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Suspend()</span></span> вызывает приостановку потока, метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Resume()</span></span>
возобновляет работу потока<a style='mso-footnote-id:ftn34' href="#_ftn34"
name="_ftnref34" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[34]</span></span><![endif]></span></span></a>.
Статический метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Sleep()</span></span>
приостанавливает выполнение текущего потока на указанное количество миллисекунд
или значение <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TimeSpan</span></span>. Статический метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Yield()</span></span> передаёт управление
следующему ожидающему потоку системы. Метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Join()</span></span> позволяет дождаться
завершения работы того потока, у которого вызывается. Модификация данного
метода блокирует выполнение текущего потока на указанное количество времени.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> th = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span>(DoSomeWork);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>th</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Start</span><span style='mso-ansi-language:RU'>();<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
создали и запустили поток</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>th</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Join</span><span style='mso-ansi-language:RU'>();<span
style='mso-spacerun:yes'>     </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
ждём, пока поток отработает</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>th</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Start</span><span style='mso-ansi-language:RU'>();<span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
запустили поток заново</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// если дождались завершения за секунду, </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>res</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> = </span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>true</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>res</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>th</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Join</span><span
style='mso-ansi-language:RU'>(1000);<o:p></o:p></span></p>

<p class=MsoNormal>Рис. 14 демонстрирует временную диаграмму работы потоков.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_10"
 o:spid="_x0000_i1029" type="#_x0000_t75" style='width:234.75pt;height:268.5pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image015.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 14. Временная диаграмма работы потоков.</p>

<p class=MsoNormal>Для завершения работы выбранного потока используется метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Abort()</span></span>. Данный
метод генерирует специальное исключение <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadAbortException</span></span>. Особенность
исключения состоит в том, что его невозможно подавить при помощи <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>catch</span></span>-блока.
Исключение может быть отслежено тем потоком, который кто-то собирается
уничтожить, а при помощи статического метода потока <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ResetAbort()</span></span> запрос на
уничтожение можно отклонить.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> ThreadProc()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>while</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>true</span></span><span lang=EN-US>)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>try<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Do some work...&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>.Sleep(1000);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>catch</span></span><span lang=EN-US> (<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadAbortException</span></span>
e)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span style='mso-ansi-language:
RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
отлавливаем попытку уничтожения и отменяем её<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>                </span></span><span class=ab><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span><span lang=EN-US>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Somebody tries to kill me!&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>.ResetAbort();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
запускаем поток и ждём три секунды<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> th = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span>(ThreadProc);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>th</span><span style='mso-ansi-language:RU'>.</span><span lang=EN-US>Start</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Sleep</span><span
style='mso-ansi-language:RU'>(3000);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
пытаемся прервать работу потока th и ждём его завершения<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>th</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Abort</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>th</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Join</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
... но не дождёмся, так как поток сам себя &quot;воскресил&quot;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>На рис. 15 показана диаграмма состояний потока с указанием
значения свойства <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadState</span></span>.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_11"
 o:spid="_x0000_i1028" type="#_x0000_t75" style='width:401.25pt;height:243pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image016.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 15. Диаграмма состояний потока.</p>

<p class=MsoNormal>Создание отдельного потока – это довольно «затратная»
операция с точки зрения расхода времени и памяти. Для уменьшения издержек,
связанных с созданием потоков, платформа .NET поддерживает специальный
механизм, называемый <span class=a2>пул потоков</span>. Пул состоит из двух
основных элементов: <span class=a2>очереди методов</span> и <span class=a2>рабочих
потоков</span>. Характеристикой пула является его <span class=a2>ёмкость</span>
– максимальное число рабочих потоков. При работе с пулом метод сначала
помещается в очередь. Если у пула есть свободные рабочие потоки, метод
извлекается из очереди и направляется свободному потоку для выполнения. Если
свободных потоков нет, но ёмкость пула не достигнута, для обслуживания метода
формируется новый рабочий поток. Однако этот поток создаётся с задержкой в
полсекунды. Если за это время освободится какой-либо из рабочих потоков, то он
будет назначен на выполнение метода, а новый рабочий поток создан не будет.
Важным нюансом является то, что несколько первых рабочих потоков в пуле
создаётся без полусекундной задержки.</p>

<p class=MsoNormal>Для работы с пулом используется статический класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadPool</span></span>.
Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SetMaxThreads()</span></span>
позволяет изменить ёмкость пула. Метод <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SetMinThreads()</span></span> устанавливает
количество рабочих потоков, создаваемых без задержки. Для помещения метода в
очередь пула служит метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>QueueUserWorkItem()</span></span>. Он принимает делегат типа <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitCallback</span></span><a
style='mso-footnote-id:ftn35' href="#_ftn35" name="_ftnref35" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[35]</span></span><![endif]></span></span></a>
и, возможно, аргумент инкапсулируемого метода.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadPool</span></span>.QueueUserWorkItem(Go);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadPool</span></span>.QueueUserWorkItem(Go,
123);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.ReadLine();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>private static void</span></span><span
lang=EN-US> Go(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> data)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Hello from the thread pool! </span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'> + </span><span lang=EN-US>data</span><span style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для выполнения в отдельном потоке повторяющегося метода
можно применить класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Timer</span></span> из пространства имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Threading</span></span>. Конструктор
таймера позволяет указать, через какой промежуток времени метод таймера должен
выполниться первый раз, а также задать периодичность выполнения (эти величины
можно затем изменить при помощи метода <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Change()</span></span>).</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Threading;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static bool</span></span><span
lang=EN-US> TickNext = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> timer = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Timer</span></span>(TickTock, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span><span lang=EN-US>, 1000, 2000);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Press &lt;Enter&gt; to terminate...&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.ReadLine();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static void</span></span><span
lang=EN-US> TickTock(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> state)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(TickNext ? </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Tick&quot;</span></span><span lang=EN-US>
: </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Tock&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>TickNext</span><span style='mso-ansi-language:RU'> = !</span><span
lang=EN-US>TickNext</span><span style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Заметим, что класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Timer</span></span> работает, используя пул
потоков.</p>

<h1><a name="_Toc348862519">32. Синхронизация потоков</a></h1>

<p class=MsoNormal>При использовании многопоточности естественным образом
возникает проблема <span class=a2>синхронизации потоков</span>, то есть
координации их действий для получения предсказуемого результата. В этом
параграфе рассматриваются основные средства синхронизации потоков, доступные на
платформе .<span lang=EN-US style='mso-ansi-language:EN-US'>NET</span>.</p>

<h2>32.1. Критические секции</h2>

<p class=MsoNormal>Рассмотрим следующий класс:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadUnsafe</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static int</span></span><span
lang=EN-US> x, y;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US> Go()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (y != 0)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(x/y);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>y = 0;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Этот класс небезопасен с точки зрения многопоточного доступа
к данным. Если вызвать метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Go()</span></span> в разных потоках одновременно, может возникнуть
ошибка деления на ноль, так как поле <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>y</span></span> будет обнулено в одном потоке
как раз между проверкой условия <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>y != 0</span></span> и вызовом <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.WriteLine()</span></span> в другом потоке.
Чтобы сделать код потокобезопасным, необходимо гарантировать выполнение
операторов, составляющих тело метода <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Go()</span></span>, только одним потоком в
любой момент времени. Такие блоки кода называются <span class=a2>критическими
секциями</span>.</p>

<p class=MsoNormal>Для организации критических секций платформа .NET предлагает
статический класс <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Threading.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Monitor</span></span>.
Метод <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Monitor</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Enter()</span></span>
определяет вход в критическую секцию, а метод <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Monitor</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.Exit()</span></span> – выход из секции. Вход и
выход должны выполняться в одном и том же потоке. Аргументами методов является
объект-идентификатор критической секции.</p>

<p class=MsoNormal>Изменим метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Go()</span></span>, чтобы сделать его потокобезопасным:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>class</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadSafe</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
объект locker будет идентификатором критической секции<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>private
static readonly object</span></span><span lang=EN-US> locker = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new object</span></span><span lang=EN-US>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static int</span></span><span
lang=EN-US> x, y;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US> Go()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Monitor</span></span>.Enter(locker);<span
style='mso-spacerun:yes'>   </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>вход</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>в</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>критическую</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>секцию</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (y != 0)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(x/y);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>y = 0;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Monitor</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Exit</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>locker</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// выход из критической секции</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Рис. 16 демонстрирует поведение двух потоков, работающих с
одной критической секцией.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_18"
 o:spid="_x0000_i1027" type="#_x0000_t75" style='width:366pt;height:251.25pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image017.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 16. Два потока работают с одной критической секцией.</p>

<p class=MsoNormal>Метод <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Monitor</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.Enter()</span></span> имеет перегруженную версию, с <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ref</span></span>-параметром
типа <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span>.
Если вход в критическую секцию был выполнен успешно, этот параметр возвращается
как <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>true</span></span>.
Если организовать критическую секцию не удалось (например, по причине
недостатка памяти), параметр возвращается как <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>false</span></span>, а метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enter()</span></span> выбрасывает исключение.</p>

<p class=MsoNormal>Язык C# содержит оператор <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>lock</span></span>, маскирующий вызовы методов <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Monitor</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Enter()</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Monitor</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.Exit()</span></span>.
Синтаксис оператора <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>lock</span></span> следующий:</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>lock</span></span><span style='mso-ansi-language:
RU'> (</span><span class=af4><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>выражение</span></span><span style='mso-ansi-language:
RU'>) </span><span class=af4><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>вложенный-оператор</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=MsoNormal>Здесь <span class=af4><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>выражение</span></span> должно иметь ссылочный тип и задаёт
идентификатор критической секции. Часто в качестве выражения записывают поле
или переменную, на которую накладывается блокировка. Оператор <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>lock</span></span> вида <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>lock</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> (x)</span></span>
эквивалентен следующему коду:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>bool</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>lockWasTaken</span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>false</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>try<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Monitor</span></span>.Enter(x, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ref</span></span><span lang=EN-US>
lockWasTaken);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// здесь размещается вложенный оператор lock<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>finally<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US>
(lockWasTaken)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Monitor</span></span>.Exit(x);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Перепишем метод <span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Go</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span> класса <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadSafe</span></span>,
используя оператор <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>lock</span></span>:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public void</span></span><span
lang=EN-US> Go()</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>lock</span></span><span lang=EN-US> (locker)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US> (y != 0)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(x/y);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>y</span><span
style='mso-ansi-language:RU'> = 0;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Threading.</span></span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Mutex</span></span> (<span class=a2>мьютекс</span>)
подобен классу <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Monitor</span></span>, но позволяет организовать критическую секцию
для нескольких процессов. Применяя <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Mutex</span></span>, нужно вызвать метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitOne()</span></span> для
входа в критическую секцию, а метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ReleaseMutex()</span></span> – для выхода из неё (выход может быть
произведён только в том же потоке выполнения, что и вход).</p>

<p class=MsoNormal>Типичный пример использования мьютекса – создание
приложения, которое можно запустить только в одном экземпляре:</p>

<p class=aCxSpFirst style='margin-top:6.0pt;mso-add-space:auto'><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>using</span></span><span lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Threading;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OneAtATimePlease</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
имя мьютекса должно быть уникально для компьютера<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> mutex = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Mutex</span></span>(</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>false</span></span><span lang=EN-US>, </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;RandomString&quot;</span></span><span lang=EN-US>))</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
пытаемся войти в критическую секцию в течение 3 сек.</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
ожидаем 3 секунды на случай, если другой экземпляр</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>       </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
приложения в процессе завершения работы</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>if</span></span><span style='mso-ansi-language:RU'> (!</span><span
lang=EN-US>mutex</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WaitOne</span><span style='mso-ansi-language:RU'>(</span><span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TimeSpan</span></span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>FromSeconds</span><span style='mso-ansi-language:
RU'>(3), </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>false</span></span><span
style='mso-ansi-language:RU'>))<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Another instance is running&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>RunProgram();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static void</span></span><span
lang=EN-US> RunProgram()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Running (press Enter to exit)&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ReadLine</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal><span class=a2>Семафор</span> – это объект синхронизации,
позволяющий войти в заданный участок кода не более чем N потокам (N – <span
class=a2>ёмкость семафора</span>). Аналогией семафора является охранник у входа
в клуб с фиксированным количеством мест. Новые посетители попадают в
заполненный клуб, только если из него кто-то ушёл. Семафор с ёмкостью, равной
единице, аналогичен монитору или мьютексу, однако получение и снятие блокировки
в случае семафора может выполняться из разных потоков.</p>

<p class=MsoNormal>Для организации семафоров платформа .NET предлагает классы <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Semaphore</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SemaphoreSlim</span></span>
из пространства имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Threading</span></span>.
Первый класс применяется для синхронизации между процессами, второй работает
только в рамках одного процесса. Метод <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Wait()</span></span> этих классов выполняет
получение блокировки, а метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Release()</span></span> – снятие блокировки.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Threading;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>TheClub</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ёмкость</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>семафора</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>равна</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'> 2<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>SemaphoreSlim</span></span> s = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>SemaphoreSlim</span></span>(2);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>for</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> i = 1; i
&lt;= 4; i++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>(Enter).Start(i);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static void</span></span><span
lang=EN-US> Enter(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> id)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(id + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot; wants to enter&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>s.Wait();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(id + </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot; is in!&quot;</span></span><span
lang=EN-US>);<span style='mso-spacerun:yes'>     </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>только</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>два</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>потока</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Sleep</span><span
style='mso-ansi-language:RU'>(1000 * (</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
style='mso-ansi-language:RU'>) </span><span lang=EN-US>id</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>         </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// могут одновременно</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(id + </span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;
is leaving&quot;</span></span><span lang=EN-US>); </span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>выполнять</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>этот</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>код</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>s.Release();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_22"
 o:spid="_x0000_i1026" type="#_x0000_t75" style='width:6in;height:210pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image018.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 17. Демонстрация работы семафора в классе <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TheClub</span></span>.</p>

<p class=MsoNormal>Иногда ресурс нужно блокировать так, чтобы читать его могли
несколько потоков, а записывать – только один. Для этих целей предназначен
класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReaderWriterLockSlim</span></span>.
Его экземплярные методы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EnterReadLock()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ExitReadLock()</span></span> задают секцию
чтения ресурса, а методы <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EnterWriteLock()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ExitWriteLock()</span></span> – секцию записи
ресурса. В следующем примере при помощи <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ReaderWriterLockSlim</span></span> построен
класс, реализующий простой кэш с поддержкой многопоточности:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SynchronizedCache</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Dictionary</span></span>&lt;</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>&gt; cache =</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                    </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Dictionary</span></span>&lt;</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US>&gt;();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ReaderWriterLockSlim</span></span> locker =</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                    </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ReaderWriterLockSlim</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public string</span></span><span lang=EN-US>
Read(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> key)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>locker</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>EnterReadLock</span><span
style='mso-ansi-language:RU'>();<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// секция чтения началась</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>try</span></span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return</span></span><span lang=EN-US style='mso-ansi-language:RU'> </span><span
lang=EN-US>cache</span><span style='mso-ansi-language:RU'>[</span><span
lang=EN-US>key</span><span style='mso-ansi-language:RU'>];<span
style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// читать могут несколько потоков</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>finally</span></span><span
class=ac><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span lang=EN-US>locker</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ExitReadLock</span><span
style='mso-ansi-language:RU'>(); </span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>// секция чтения закончилась</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US> Add(</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> key, </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US> value)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>locker.EnterWriteLock();<span style='mso-spacerun:yes'>       </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>секция</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>записи</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>началась</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>try<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>cache.Add(key, value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>finally<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>locker</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>ExitWriteLock</span><span
style='mso-ansi-language:RU'>();<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// секция запись закончилась</span></span><span style='mso-ansi-language:
RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public bool</span></span><span lang=EN-US>
AddWithTimeout(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> key, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> value, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> timeout)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>if</span></span><span lang=EN-US>
(locker.TryEnterWriteLock(timeout))<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>таймаут</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>входа</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>try<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>cache.Add(key, value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>finally<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                </span>locker.ExitWriteLock();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>return true</span></span><span lang=EN-US>;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>return</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>false</span></span><span style='mso-ansi-language:
RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h2>32.2. Синхронизация на основе подачи сигналов</h2>

<p class=MsoNormal>При использовании <span class=a2>синхронизации на основе
подачи сигналов</span> один поток получает уведомления от другого потока.
Обычно уведомления используются для возобновления работы заблокированного
потока. Для реализации данного подхода платформа .NET предлагает классы <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AutoResetEvent</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManualResetEvent</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManualResetEventSlim</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CountdownEvent</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Barrier</span></span>
(все они размещены в пространстве имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Threading</span></span>).</p>

<p class=MsoNormal>Классы<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AutoResetEvent</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManualResetEvent</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManualResetEventSlim</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> </span>унаследованы<span
style='mso-ansi-language:EN-US'> </span>от<span style='mso-ansi-language:EN-US'>
</span>класса<span style='mso-ansi-language:EN-US'> </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>EventWaitHandle</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Имея доступ к объекту <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>EventWaitHandle</span></span>,
поток может вызвать его метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>WaitOne()</span></span>, чтобы остановиться и ждать сигнала. Для
отправки сигнала применяется вызов метода <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Set()</span></span>. Если используются <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManualResetEvent</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ManualResetEventSlim</span></span>,
все ожидающие потоки освобождаются и продолжают выполнение. При использовании <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AutoResetEvent</span></span>
ожидающие потоки освобождаются и запускаются последовательно, на манер очереди.
Аналогией для <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AutoResetEvent</span></span> является турникет, пропускающий людей
по одному, а <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ManualResetEvent</span></span> подобен воротам, которые или
закрыты, или открыты.</p>

<p class=a6><span style='mso-no-proof:yes'><v:shape id="Рисунок_x0020_23"
 o:spid="_x0000_i1025" type="#_x0000_t75" style='width:336pt;height:231pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="metoda1.files/image019.wmz" o:title=""/>
</v:shape></span></p>

<p class=a6>Рис. 18. Пример работы с объектом <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AutoResetEvent</span></span>.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CountdownEvent</span></span> позволяет организовать счётчик
уведомлений. Конструктор класса принимает в качестве аргумента начальное
значение счётчика. Вызов экземплярного метода <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Signal()</span></span> уменьшает значение
счётчика на единицу. Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Wait()</span></span> блокирует поток, пока счётчик не станет равным
нулю.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>private static</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CountdownEvent</span></span> counter = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>CountdownEvent</span></span>(3);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(SaySomething).Start(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;I am thread 1&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(SaySomething).Start(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;I am thread 2&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(SaySomething).Start(</span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;I am thread 3&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// ждём, пока метод Signal() не вызовется три
раза<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>counter.Wait();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;All threads have finished speaking!&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>private static void</span></span><span
lang=EN-US> SaySomething(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US> thing)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span>.Sleep(1000);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(thing);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>counter</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>Signal</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Объект класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Barrier</span></span> организует для нескольких
потоков точку встречи во времени. Чтобы использовать <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Barrier</span></span>, нужно
вызвать его конструктор, передав количество встречающихся потоков. Затем
отдельные потоки вызывают экземплярный метод <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Barrier</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.SignalAndWait()</span></span>, чтобы
приостановиться и продолжить выполнение после совместной встречи.</p>

<p class=MsoNormal>В следующем примере каждый из трёх потоков печатает числа от
0 до 4, синхронизируя работу со своими «коллегами»:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>using</span></span><span
lang=EN-US> System.Threading;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BarrierExample</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static readonly</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Barrier</span></span> _barrier = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Barrier</span></span>(3);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(Speak).Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(Speak).Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(Speak).Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>вывод</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>: 0 0 0 1 1 1 2 2 2 3 3 3 4 4 4<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.ReadLine();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static void</span></span><span
lang=EN-US> Speak()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>for</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> i = 0; i
&lt; 5; i++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(i
+ </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot; &quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span style='mso-ansi-language:
RU'>_</span><span lang=EN-US>barrier</span><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>SignalAndWait</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h2>32.3. Неблокирующие средства синхронизации</h2>

<p class=MsoNormal><span class=a2>Неблокирующие средства синхронизации</span>
позволяют осуществлять совместный доступ к простым ресурсам нескольких потоков
без блокировки, паузы или ожидания. Коротко рассмотрим неблокирующие средства
синхронизации, которые предлагает платформа .NET.</p>

<p class=MsoNormal>Для оптимизации выполнения программы центральный процессор
иногда применяет перестановку инструкций программы или их кэширование. Чтобы
отменить подобную оптимизацию следует разместить в исходном коде <span
class=a2>барьеры памяти</span>. Процессор не способен изменить порядок команд,
чтобы инструкции до барьера, выполнялись после инструкций за барьером. Для
установки барьера памяти нужно вызвать статический метод <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.MemoryBarrier()</span></span>.
Язык C# содержит специальный модификатор <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>volatile</span></span>, применяемый при
объявлении поля. Инструкции записи данных в такое не переставляются процессором
в целях оптимизации.</p>

<p class=MsoNormal>Статический класс <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Threading.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Interlocked</span></span>
имеет методы для инкремента, декремента и сложения аргументов типа <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span>
или <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>long</span></span>,
а также методы присваивания значений числовым и ссылочным переменным. Каждый
метод гарантировано выполняется как <span class=a2>атомарная операция</span>,
без блокировки текущего потока выполнения.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> x = 10, y = 20;</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Interlocked</span></span><span
lang=EN-US>.Add(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ref</span></span><span
lang=EN-US> x, y);<span style='mso-spacerun:yes'>                    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// x = x + y</span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Interlocked</span></span><span
lang=EN-US>.Increment(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ref</span></span><span
lang=EN-US> x);<span style='mso-spacerun:yes'>                 </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// x++</span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Interlocked</span></span><span
lang=EN-US>.Exchange(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ref</span></span><span
lang=EN-US> x, y);<span style='mso-spacerun:yes'>               </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// x = y</span></span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Interlocked</span></span><span
lang=EN-US>.CompareExchange(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ref</span></span><span
lang=EN-US> x, 50, y);<span style='mso-spacerun:yes'>    </span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// if (x == y) x = 50</span></span></p>

<h2>32.4. Разделение данных между потоками</h2>

<p class=MsoNormal>Если некий метод запускается в нескольких потоках, только
локальные переменные метода будут уникальными для потока. Поля объектов по
умолчанию разделяются между всеми потоками. В пространстве имён <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System</span></span> определён атрибут <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>[</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadStatic</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>]</span></span>, применяемый
к статическим полям. Если поле помечено таким атрибутом, то каждый поток будет
содержать свой экземпляр поля. Для <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>[</span></span><span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadStatic</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>]</span></span>-полей не рекомендуется делать
инициализацию при объявлении, так как код инициализации выполнится только в
одном потоке.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>SomeClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static int</span></span><span
lang=EN-US> SharedField = 25;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>[<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ThreadStatic</span></span>]</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static int</span></span><span
lang=EN-US> NonSharedField;</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Для создания неразделяемых статических полей можно
использовать тип <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ThreadLocal</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>. Перегруженный
конструктор <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadLocal</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
принимает функцию инициализации поля. Значение поля хранится в свойстве <span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Value</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Slot</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static readonly</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span> rnd = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Random</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static int</span></span><span
lang=EN-US> Shared = 25;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private static</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ThreadLocal</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt; NonShared =</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                   </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ThreadLocal</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>&gt;(() =&gt;
rnd.Next(1, 20));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> PrintData()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Thread: {0} Shared: {1} NonShared:
{2}&quot;</span></span><span lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>.CurrentThread.Name,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span>Shared,
NonShared.Value);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>MainClass</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public static void</span></span><span
lang=EN-US> Main()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>для</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>тестирования</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>запускаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>три</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>потока</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>      </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Slot</span></span>.PrintData)
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;First&quot;</span></span><span
lang=EN-US>}.Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Slot</span></span>.PrintData)
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Second&quot;</span></span><span
lang=EN-US>}.Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>(<span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Slot</span></span>.PrintData)
{Name = </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Third&quot;</span></span><span
lang=EN-US>}.Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.ReadLine();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>}</span></p>

<p class=aCxSpLast><span lang=EN-US>}</span></p>

<p class=MsoNormal>Отметим<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>что<span
style='mso-ansi-language:EN-US'> </span>класс<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>
</span>имеет<span style='mso-ansi-language:EN-US'> </span>статические<span
style='mso-ansi-language:EN-US'> </span>методы<span style='mso-ansi-language:
EN-US'> </span><span class=a3><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>AllocateDataSlot()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>AllocateNamedDataSlot()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>GetNamedDataSlot()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>FreeNamedDataSlot()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>GetData()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>SetData()</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>которые<span
style='mso-ansi-language:EN-US'> </span>предназначены<span style='mso-ansi-language:
EN-US'> </span>для<span style='mso-ansi-language:EN-US'> </span>работы<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span><span class=a2>локальными</span><span class=a2><span style='mso-ansi-language:
EN-US'> </span>хранилищами</span><span class=a2><span style='mso-ansi-language:
EN-US'> </span>данных</span><span style='mso-ansi-language:EN-US'> </span>потока<span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Эти локальные хранилища
могут рассматриваться как альтернатива неразделяемым статическим полям.</p>

<p class=MsoNormal>Распространённый шаблон при разработке многопоточных
приложений – <span class=a2>неизменяемый объект</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>immutable</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>object</span>). После создания такой
объект допускает только чтение своих полей, но не запись. Приведём пример
класса, объекты которого являются неизменяемыми:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>class</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ProgressStatus</span></span><span
style='mso-ansi-language:RU'><o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public
readonly</span></span><span lang=EN-US> </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> PercentComplete;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public readonly</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US>
StatusMessage;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span lang=EN-US>
ProgressStatus(</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> percentComplete, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
lang=EN-US> statusMessage)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>PercentComplete</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>percentComplete</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span lang=EN-US>StatusMessage</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>statusMessage</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Достоинство неизменяемых объектов с точки зрения
многопоточности заключается в том, что работа с ними требует коротких
блокировок, обычно обрамляющих операции присваивания объектов:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>public class</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WorkWithImmutable</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private readonly object</span></span><span
lang=EN-US> _locker = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new object</span></span><span
lang=EN-US>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>private</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ProgressStatus</span></span> _status;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public void</span></span><span lang=EN-US>
SetFields()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>создаём</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>и</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>настраиваем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>временный</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>объект</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> status = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ProgressStatus</span></span>(50, </span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;Working on it&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// переносим информацию, используя короткую
блокировку<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>lock</span></span><span
style='mso-ansi-language:RU'> (_</span><span lang=EN-US>locker</span><span
style='mso-ansi-language:RU'>) _</span><span lang=EN-US>status</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>status</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>ReadInfo</span><span
style='mso-ansi-language:RU'>()<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
используя короткую блокировку, создаём временную копию<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span></span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ProgressStatus</span></span><span
lang=EN-US> statusCopy;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>lock</span></span><span lang=EN-US> (_locker)
statusCopy = _status;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>работаем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>с</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>копией</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> pc =
statusCopy.PercentComplete;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>string</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>msg</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>statusCopy</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>StatusMessage</span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h1><a name="_Toc348862520">33. Выполнение асинхронных операций при помощи
задач</a></h1>

<p class=MsoNormal>Поток, рассматриваемый как объект класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>, – это
низкоуровневый инструмент для организации параллельной работы, и, будучи
таковым, он обладает рядом ограничений. В частности, у потоков отсутствует
механизм <span class=a2>продолжений</span>, когда после завершения метода,
работающего в потоке, в этом же потоке автоматически запускается другой
заданный метод. Затруднено получение значения функции, выполняющейся в
отдельном потоке. Наконец, необдуманное создание множества потоков ведёт к
повышенному расходу памяти и замедлению работы приложения. <span class=a2>Задача</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>task</span>) – это сущность,
в целом подобная потоку. Однако, являясь абстракцией более высокого уровня, она
призвана устранить указанные выше ограничения потоков. Концепция задач была
представлена в четвёртой версии платформы .<span lang=EN-US style='mso-ansi-language:
EN-US'>NET</span>.</p>

<h2>33.1. Базовые сведения о задачах</h2>

<p class=MsoNormal>Для описания задач используются объекты классов <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Result</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span>, размещённых в пространстве
имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Threading.Tasks</span></span>.
Табл. 20 содержит информацию об элементах класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span>.</p>

<p class=ae>Таблица 20</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>AsyncState</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Объект, заданный при создании задачи (аргумент <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Action</span></span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&lt;</span></span><span
  class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>object</span></span><span class=af3><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>&gt;</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Con</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>figureAwait</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Настраивает объект ожидания, используемый для текущей задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>ContinueWith()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Используются для указания метода, выполняемого после завершения
  текущей задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CreationOptions</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Опции, указанные при создании задачи (тип <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>TaskCreationOptions</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CurrentId</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статическое свойство типа <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>int</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>?</span></span>, которое возвращает целочисленный
  идентификатор текущей задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>D</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>elay</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; позволяет создать задачу с указанной
  задержкой старта</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Dispose()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Освобождение ресурсов, связанных с задачей</p>
  </td>
 </tr>
</table>

</div>

<p class=ae>Окончание табл. 20</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Exception</span></span></p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает объект типа <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>AggregateException</span></span>,
  который соответствует исключению, прервавшему выполнение задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Factory</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Доступ к фабрике, содержащей методы создания <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Task</span></span> и <span class=af2><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>Task</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&lt;T&gt;</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-ansi-language:
  EN-US'>GetAwaiter</span></span><span class=af3><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получает объект ожидания для текущей задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Id</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Целочисленный идентификатор задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsCanceled</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Булево свойство, указывающее, была ли задача отменена</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsCompleted</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство равно <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если задача успешно завершилась</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsFaulted</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство равно <span class=af1><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если задача сгенерировала исключение</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Run()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; выполняет создание и запуск задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>RunSynchronously()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Запуск задачи синхронно</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Start()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Запуск задачи асинхронно</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Status</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает текущий статус задачи (объект типа <span class=af2><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>TaskStatus</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Wait()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Приостанавливает текущий поток до завершения задачи</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>WaitAll()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; приостанавливает текущий поток до завершения
  всех указанных задач</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>WaitAny()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; приостанавливает текущий поток до завершения
  любой из указанных задач</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>W</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>hen</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>All()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; создаёт задачу, которая будет выполнена после
  выполнения всех указанных задач</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>W</span></span><span
  class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman";mso-ansi-language:EN-US'>hen</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>Any()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод; создаёт задачу, которая будет выполнена после
  выполнения любой из указанных задач</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Простейший способ создания и запуска задачи – вызов
статического метода <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Task</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.Run()</span></span>. Этот метод принимает в качестве аргумента объект
типа <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span>.</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US
style='mso-ansi-language:RU'> </span><span lang=EN-US>task</span><span
style='mso-ansi-language:RU'> = </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Run</span><span
style='mso-ansi-language:RU'>(() =&gt; </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Hello</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:RU'>));<o:p></o:p></span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TaskFactory</span></span><span lang=EN-US> </span>содержит набор методов,
соответствующих некоторым сценариям использования задач – <span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>StartNew</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>, <span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>FromAsync</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>()</span></span>, <span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>ContinueWhenAll</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>, <span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>ContinueWhenAny</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>()</span></span>. Экземпляр <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TaskFactory</span></span><span
lang=EN-US> </span>доступен через статическое свойство <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Factory</span></span>. Вызов <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Run</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>()</span></span> – это сокращение для <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Factory</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>StartNew</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>аналог</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>предыдущего</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>примера</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span><span
lang=EN-US> action = () =&gt; <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Hello&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Factory.StartNew(action);</span></p>

<p class=MsoNormal>Для создания задачи можно использовать один из перегруженных
конструкторов класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Task</span></span>. При этом указывается аргумент типа <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span>
– метод, выполняемый в задаче. Если необходимо выполнить метод с параметром,
используется <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Action</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;</span></span><span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span> и дополнительный аргумент
типа <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span>.</p>

<p class=aCxSpFirst><a name="OLE_LINK11"></a><a name="OLE_LINK10"><span
style='mso-bookmark:OLE_LINK11'><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span><span
lang=EN-US> action = () =&gt; <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span></span></a><span
style='mso-bookmark:OLE_LINK10'><span style='mso-bookmark:OLE_LINK11'><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Hello&quot;</span></span><span
lang=EN-US>);</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span><span
lang=EN-US>&lt;</span></span></span><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
lang=EN-US>&gt; method = x =&gt; {</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span lang=EN-US><span
style='mso-spacerun:yes'>                       </span><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>  </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>.Sleep(1000);</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span lang=EN-US><span
style='mso-spacerun:yes'>                             </span><span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span>.WriteLine(x.ToString());</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  </span>};</span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task1 = </span></span></span><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>(action);</span></span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task2 = </span></span></span><span style='mso-bookmark:OLE_LINK10'><span
style='mso-bookmark:OLE_LINK11'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>(method, 25);</span></span></span></p>

<span style='mso-bookmark:OLE_LINK11'></span><span style='mso-bookmark:OLE_LINK10'></span>

<p class=MsoNormal>Перегруженные конструкторы класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
lang=EN-US> </span>принимают опциональные аргументы типа <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CancellationToken</span></span><span
lang=EN-US> </span>и <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TaskCreationOptions</span></span>. Перечисление <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TaskCreationOptions</span></span>
задаёт вид задачи (например, <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>LongRunning</span></span> – долгая задача). Структура <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CancellationToken</span></span>
применяется для прерывания задачи (это так называемый <span class=a2>токен
отмены</span>).</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> task1 = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Task</span></span>(action, <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>TaskCreationOptions</span></span>.LongRunning);</span></p>

<p class=MsoNormal>Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Start()</span></span> запускает задачу, вернее, помещает её в
очередь запуска <span class=a2>планировщика задач</span>. По умолчанию
применяется планировщик на основе пула потоков, но существует возможность
использовать пользовательский планировщик<a style='mso-footnote-id:ftn36'
href="#_ftn36" name="_ftnref36" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[36]</span></span><![endif]></span></span></a>.
Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>RunSynchronously()</span></span>
выполняет задачу синхронно (в терминах используемого планировщика задач).</p>

<p class=aCxSpFirst><a name="OLE_LINK15"></a><a name="OLE_LINK14"><span
style='mso-bookmark:OLE_LINK15'><span lang=EN-US>task</span></span></a><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
style='mso-ansi-language:RU'>1.</span><span lang=EN-US>Start</span></span></span><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
style='mso-ansi-language:RU'>();<span style='mso-spacerun:yes'>               
</span></span></span></span><span style='mso-bookmark:OLE_LINK14'><span
style='mso-bookmark:OLE_LINK15'><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>// асинхронный запуск</span></span></span></span><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
style='mso-ansi-language:RU'><o:p></o:p></span></span></span></p>

<p class=aCxSpLast><span style='mso-bookmark:OLE_LINK14'><span
style='mso-bookmark:OLE_LINK15'><span lang=EN-US>task</span></span></span><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
style='mso-ansi-language:RU'>2.</span><span lang=EN-US>RunSynchronously</span></span></span><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
style='mso-ansi-language:RU'>();<span style='mso-spacerun:yes'>     </span></span></span></span><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// синхронный запуск</span></span></span></span><span
style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:OLE_LINK15'><span
style='mso-ansi-language:RU'><o:p></o:p></span></span></span></p>

<span style='mso-bookmark:OLE_LINK15'></span><span style='mso-bookmark:OLE_LINK14'></span>

<p class=MsoNormal>Методы класса <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span><span lang=EN-US> </span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Wait()</span></span>, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitAll()</span></span> и <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitAny()</span></span>
останавливают основной поток до завершения задачи (или задач). Перегруженные
версии методов позволяют указать период ожидания завершения и токен отмены.</p>

<p class=aCxSpFirst><span lang=EN-US>task1.Wait(1000);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
lang=EN-US>.WaitAll(task1, task2);</span></p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Task</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Result</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span>
наследуется от <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Task</span></span> и описывает задачу, возвращающую значение типа <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>T</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Result</span></span>. Дополнительно к элементам
базового класса, <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Task</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T</span></span><span class=a3><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Result</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span> объявляет
свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Result</span></span>
для хранения вычисленного значения. Конструкторы класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Result</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span> принимают аргументы типа <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Result</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>, T</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Result</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span> (опционально – аргументы
типа <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CancellationToken</span></span>
и <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TaskCreationOptions</span></span>).</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>&gt; func = () =&gt; {</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                       </span><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>  </span><span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Thread</span></span>.Sleep(2000);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                        </span><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> 100;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span><span style='mso-spacerun:yes'>            </span><span
style='mso-spacerun:yes'>  </span>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>&lt;</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US>&gt;(func);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(task.Status);<span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// Created</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>task.Start();</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
lang=EN-US>.WriteLine(task.Status);<span style='mso-spacerun:yes'>       
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// WaitingToRun</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>task.Wait();</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>task</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Result</span><span
style='mso-ansi-language:RU'>);<span style='mso-spacerun:yes'>        </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>// 100</span></span><span style='mso-ansi-language:RU'><o:p></o:p></span></p>

<h2>33.2. Обработка исключений и отмена выполнения задач</h2>

<p class=MsoNormal>В отличие от потоков, задачи легко распространяют
исключения. Если код внутри задачи генерирует необработанное исключение (задача
<span class=a2>отказывает</span>), это исключение автоматически повторно
сгенерируется при вызове метода <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Wait()</span></span> или при доступе к свойству <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Result</span></span> класса <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>Result</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&gt;</span></span>. <span lang=EN-US
style='mso-ansi-language:EN-US'>CLR</span><span lang=EN-US> </span>помещает
исключение в оболочку <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AggregateException</span></span>.
При параллельном возникновении нескольких исключений все они собираются в
единое исключение <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AggregateException</span></span> и доступны в свойстве-коллекции <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>InnerExceptions</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Run(() =&gt; { </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>throw</span></span><span lang=EN-US> </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Exception</span></span>(); });</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>try</span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>task.Wait();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>catch</span></span><span
lang=EN-US> (<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AggregateException</span></span> ex)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> message =
ex.InnerException.Message;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>message</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>При работе с задачами применяется особый подход для отмены
их выполнения. Структура типа <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CancellationToken</span></span> (токен отмены)
– это своеобразный маркер того, что задачу можно отменить. Токен отмены
принимает в качестве аргумента, в частности, конструктор задачи. Класс <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CancellationTokenSource</span></span>
содержит свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Token</span></span>
для получения токенов отмены и метод <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Cancel()</span></span> для отмены выполнения
всех задач, использующих общий токен.</p>

<p class=MsoNormal>В следующем фрагменте кода демонстрируется типичный сценарий
использования токенов отмены: вначале создаётся объект <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>CancellationTokenSource</span></span>,
затем его токен назначается нескольким задачам, а потом вызывается метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Cancel()</span></span>,
прерывающий выполнение всех этих задач:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> tokenSource = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>CancellationTokenSource</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>используем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>один</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>токен</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>в</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>двух</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>задачах</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>(SomeMethod, tokenSource.Token).Start();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>(OtherMethod, tokenSource.Token).Start();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// в нужный момент отменяем обе задачи<o:p></o:p></span></span></p>

<p class=aCxSpLast><span lang=EN-US>tokenSource</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>Cancel</span><span style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<h2>33.3. Продолжения</h2>

<p class=MsoNormal><span class=a2>Продолжение</span> сообщает задаче, что после
её завершения она должна продолжить делать что-то другое. Первый способ
организации продолжения заключается в использовании экземплярного метода задачи
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ContinueWith()</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Run(() =&gt; <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Task..&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task2 = task1.ContinueWith(t =&gt; <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;continuation&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=MsoNormal>После того как задача <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>task1</span></span> (<span class=a2>предшественник</span>)
завершается, отказывает или отменяется, задача <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>task2</span></span> (<span class=a2>продолжение</span>)
запускается. Аргумент <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>t</span></span>,
переданный лямбда-выражению продолжения – это ссылка на предшествующую задачу<a
style='mso-footnote-id:ftn37' href="#_ftn37" name="_ftnref37" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]><span
class=MsoFootnoteReference><span style='font-size:14.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[37]</span></span><![endif]></span></span></a>.</p>

<p class=MsoNormal>Выполнение продолжения можно запланировать на основе
завершения множества предшествующих задач при помощи статических методов <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.WhenAll()</span></span> и <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.WhenAny()</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task1 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Run(() =&gt; <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;X&quot;</span></span><span lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> task2 = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Run(() =&gt; <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Y&quot;</span></span><span lang=EN-US>));</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> continuation = <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span>.WhenAll(task1,
task2)</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                       </span>.ContinueWith(t =&gt; <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Console</span></span>.Write(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;Done&quot;</span></span><span
lang=EN-US>));</span></p>

<p class=MsoNormal>Второй способ организации продолжения заключается в использовании
объекта ожидания. <span class=a2>Объект ожидания</span> – это любой объект, имеющий
методы <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>OnCompleted()</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetResult()</span></span>
и булево свойство <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IsCompleted</span></span>.
Вызов метода <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>GetAwaiter()</span></span>
на задаче возвращает объект ожидания. Метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>OnCompleted()</span></span> принимает в
качестве аргумента делегат, содержащий код продолжения. Метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>GetResult()</span></span> возвращает результат
работы предшественника (или <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>void</span></span>).</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// задача подсчёта простых чисел (используется
LINQ)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>&gt; prime = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Run(() =&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(2, 3000000 - 2).Count(n
=&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(2, (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>) <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Math</span></span>.Sqrt(n) - 1).All(i =&gt; n%i &gt; 0)));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// получаем объект продолжения<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span lang=EN-US>awaiter</span><span
style='mso-ansi-language:RU'> = </span><span lang=EN-US>prime</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>GetAwaiter</span><span
style='mso-ansi-language:RU'>();<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// указываем, что делать после окончания
предшественника<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>awaiter</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>OnCompleted</span><span style='mso-ansi-language:
RU'>(() =&gt;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>        </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
получаем результат вычислений предшественника<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US> result = awaiter.GetResult();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(result);</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span style='mso-ansi-language:RU'>});<o:p></o:p></span></p>

<h2>33.4. Асинхронные функции в <span lang=EN-US style='mso-ansi-language:EN-US'>C</span>#</h2>

<p class=MsoNormal>Для поддержки асинхронного программирования в версии <span
lang=EN-US style='mso-ansi-language:EN-US'>C</span># 5.0 появилась операция <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span>.
Синтаксис этой операции следующий:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=af4><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>результат</span></span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=af4><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>выражение</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpLast><span class=af4><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>оператор(ы)</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=MsoNormal>Компилятор разворачивает приведённую выше конструкцию в такой
функциональный эквивалент:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> awaiter = </span><span class=af4><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>выражение</span></span><span
lang=EN-US>.GetAwaiter();</span></p>

<p class=aCxSpMiddle><span lang=EN-US>awaiter.OnCompleted(()=&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>      
</span><span style='mso-spacerun:yes'> </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span><span style='mso-spacerun:yes'>   </span>var </span><span class=af4><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>результат</span></span><span
lang=EN-US> = awaiter.GetResult();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=af4><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>оператор</span></span><span
class=af4><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>(</span></span><span
class=af4><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ы</span></span><span class=af4><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>)</span></span><span
lang=EN-US>;</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Операция <span class=ac><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>await</span></span><span lang=EN-US> </span>применима
и к выражению, не возвращающему значения:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span><span
lang=EN-US style='mso-ansi-language:RU'> </span><span class=af4><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>выражение</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpLast><span class=af4><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>оператор(ы)</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=MsoNormal>Выражение, на котором применяется <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span>, обычно
является задачей. Тем не менее, компилятор удовлетворит любой объект ожидания
(определение данного понятия приведено выше). Операция <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span><span
lang=EN-US> </span>может применяться только внутри метода (или
лямбда-выражения) со специальным модификатором <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>async</span></span>. Метод должен возвращать <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>void</span></span><span
lang=EN-US> </span>либо тип <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span><span lang=EN-US> </span>или <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;TResult&gt;</span></span>.</p>

<p class=MsoNormal>Методы с модификатором <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>async</span></span><span lang=EN-US> </span>называются
<span class=a2>асинхронными функциями</span>. Встретив выражение <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span>,
процесс выполнения (обычно) производит возврат в вызывающий код – почти как
оператор <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>yield</span></span><span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>return</span></span><span lang=EN-US> </span>в
итераторе. Но перед возвратом исполняющая среда присоединяет к ожидающей задаче
признак продолжения, гарантирующий, что когда задача завершается, управление
перейдёт обратно в метод и продолжится с места, в котором оно его оставило.</p>

<p class=MsoNormal>Рассмотрим несколько примеров использования операции <span
class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>await</span></span>.
Пусть имеется обычный метод, выполняющий чтение содержимого сайта. Для этого
используется класс <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Net.</span></span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WebClient</span></span>
и его метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DownloadString()</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>private</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>void</span></span><span
lang=EN-US> ReadFromWeb()</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><a name="OLE_LINK16"></a><a name="OLE_LINK13"></a><a
name="OLE_LINK12"><span style='mso-bookmark:OLE_LINK13'><span style='mso-bookmark:
OLE_LINK16'><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> web = </span></span></span></a><span
style='mso-bookmark:OLE_LINK12'><span style='mso-bookmark:OLE_LINK13'><span
style='mso-bookmark:OLE_LINK16'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WebClient</span></span>();</span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK12'><span
style='mso-bookmark:OLE_LINK13'><span style='mso-bookmark:OLE_LINK16'><span
class=a3><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span></span></span></span></span><span
style='mso-bookmark:OLE_LINK12'><span style='mso-bookmark:OLE_LINK13'><span
style='mso-bookmark:OLE_LINK16'><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> text = web.DownloadString(</span></span></span></span><span
style='mso-bookmark:OLE_LINK12'><span style='mso-bookmark:OLE_LINK13'><span
style='mso-bookmark:OLE_LINK16'><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;http://msdn.com&quot;</span></span><span
lang=EN-US>);</span></span></span></span></p>

<p class=aCxSpMiddle><span style='mso-bookmark:OLE_LINK12'><span
style='mso-bookmark:OLE_LINK13'><span style='mso-bookmark:OLE_LINK16'><span
lang=EN-US><span style='mso-spacerun:yes'>    </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span></span></span></span></span><span
style='mso-bookmark:OLE_LINK12'><span style='mso-bookmark:OLE_LINK13'><span
style='mso-bookmark:OLE_LINK16'><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>WriteLine</span></span></span></span><span style='mso-bookmark:OLE_LINK12'><span
style='mso-bookmark:OLE_LINK13'><span style='mso-bookmark:OLE_LINK16'><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>text</span></span></span></span><span
style='mso-bookmark:OLE_LINK12'><span style='mso-bookmark:OLE_LINK13'><span
style='mso-bookmark:OLE_LINK16'><span style='mso-ansi-language:RU'>.</span><span
lang=EN-US>Length</span></span></span></span><span style='mso-bookmark:OLE_LINK12'><span
style='mso-bookmark:OLE_LINK13'><span style='mso-bookmark:OLE_LINK16'><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></span></span></span></p>

<span style='mso-bookmark:OLE_LINK16'></span><span style='mso-bookmark:OLE_LINK13'></span><span
style='mso-bookmark:OLE_LINK12'></span>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Вызов метода <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ReadFromWeb()</span></span> задержит основной поток выполнения на
несколько миллисекунд (или даже секунд – зависит от скорости сети). К счастью,
создатели класса <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>WebClient</span></span> включили в него метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>DownloadString</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>TaskAsync</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>()</span></span>. Этот метод
создаёт <span class=a2>задачу</span> <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;</span></span><span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&gt;</span></span> для чтения
сайта и возвращает управление. Данный факт позволяет нам превратить метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadFromWeb()</span></span> в
асинхронную функцию, которая не блокирует при вызове основной поток.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>private</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>async</span></span><span
lang=EN-US> </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>void</span></span><span
lang=EN-US> ReadFromWeb()</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> web = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>WebClient</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> text = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>await</span></span><span lang=EN-US>
web.DownloadStringTaskAsync(</span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;http://msdn.com&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>text</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Length</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>В стандартных классах платформы .<span lang=EN-US
style='mso-ansi-language:EN-US'>NET</span><span lang=EN-US> </span>многие
методы, выполняющие долгие операции, получили поддержку в виде асинхронных
аналогов. Обычно эти новые методы можно распознать по суффиксу <span class=af4><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Async</span></span> в названии (например, метод
для чтения <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadLineAsync()</span></span>
из класса <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamReader</span></span>).
Этот факт позволяет перенести идеи предыдущего примера на другие подобные
ситуации.</p>

<p class=MsoNormal>Следующий пример показывает, что модификатор <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>async</span></span><span
lang=EN-US> </span>применим не только к именованным методам, но и к лямбда-выражениям:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>unnamed</span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>async</span></span><span
style='mso-ansi-language:RU'> () =&gt;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>           </span>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>               </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>//
</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Task</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.</span></span><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Delay</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>() - асинхронный аналог </span></span><span class=aa><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'>Thread</span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>.</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>Sleep</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>()<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>               </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>await</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Task</span></span>.Delay(1000);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>               </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Done&quot;</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpLast><span lang=EN-US><span style='mso-spacerun:yes'>          
</span></span><span style='mso-ansi-language:RU'>};<o:p></o:p></span></p>

<h1><a name="_Toc348862521">34. Платформа параллельных вычислений</a></h1>

<p class=MsoNormal><span class=a2>Платформа параллельных вычислений</span>
(Parallel Framework, PFX) – это набор типов и технологий, являющийся частью
платформы .NET. <span lang=EN-US style='mso-ansi-language:EN-US'>PFX</span>
предназначена для повышения производительности разработчиков за счёт средств,
упрощающих добавление параллелизма в приложения. <span lang=EN-US
style='mso-ansi-language:EN-US'>PFX</span> динамически масштабирует степень
параллелизма для наиболее эффективного использования всех доступных
процессорных ядер.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>PFX</span>
обеспечивает три уровня организации параллелизма:</p>

<p class=MsoNormal>1. <span class=a2>Параллелизм на уровне задач</span>. Частью
<span lang=EN-US style='mso-ansi-language:EN-US'>PFX</span><span lang=EN-US> </span>является
<span class=a2>библиотека параллельных задач</span> (Task Parallel Library,
TPL). Эта библиотека представляет собой набор типов в пространствах имён <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Threading.Tasks</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Threading</span></span>.
<span lang=EN-US style='mso-ansi-language:EN-US'>TPL</span> обеспечивает
высокоуровневую работу с пулом потоков, позволяя явно структурировать
параллельно исполняющийся код с помощью легковесных задач. Планировщик
библиотеки выполняет диспетчеризацию задач, а также предоставляет единообразный
механизм отмены задач и обработки исключительных ситуаций. Работа с задачами
рассмотрена в предыдущем параграфе.</p>

<p class=MsoNormal>2. <span class=a2>Параллелизм при императивной обработке
данных</span>. <span lang=EN-US style='mso-ansi-language:EN-US'>PFX</span>
содержит параллельные реализации основных итеративных операторов, таких как
циклы <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span>
и <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span>.
При этом выполнение автоматически распределяется на все процессорные ядра вычислительной
системы.</p>

<p class=MsoNormal>3. <span class=a2>Параллелизм при декларативной обработке
данных</span> реализуется при помощи параллельного интегрированного языка
запросов (PLINQ). PLINQ выполняет запросы <span lang=EN-US style='mso-ansi-language:
EN-US'>LINQ</span><span lang=EN-US> </span>параллельно, обеспечивая
масштабируемость и загрузку процессорных ядер.</p>

<h2>34.1. Параллелизм при императивной обработке данных</h2>

<p class=MsoNormal>Класс <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Threading.Tasks.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span>
позволяет распараллеливать циклы и последовательность блоков кода. Эта
функциональность реализована как набор статических методов <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>For()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ForEach()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Invoke()</span></span>.</p>

<p class=MsoNormal>Методы <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.For()</span></span> и <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.ForEach()</span></span>
являются параллельными аналогами циклов <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>for</span></span> и <span class=ac><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span>. Их
использование корректно в случае независимости итераций цикла, то есть, если ни
в одной итерации не используется результаты работы предыдущих итераций.</p>

<p class=MsoNormal>Существует несколько перегруженных вариантов метода <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.For()</span></span>, однако
любой из них подразумевает указание начального и конечного значения счётчика
(типа <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span>
или <span class=ac><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>long</span></span>)
и тела цикла в виде объекта делегата. В качестве примера использования <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>.For()</span></span> приведём
код, перемножающий две квадратные матрицы (<span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>m1</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>m2</span></span> – исходные матрицы, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>result</span></span> – их
произведение, <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>size</span></span>
– размер матриц):</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span
lang=EN-US>.For(0, size, i =&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>        
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>             </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>for</span></span><span lang=EN-US> (</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US> j = 0; j &lt; size; j++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>             </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                 </span>result[i, j] = 0;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                 </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>for</span></span><span lang=EN-US> (</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>int</span></span><span lang=EN-US> k = 0; k &lt; size; k++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                 </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                     </span>result[i, j] += m1[i, k] *
m2[k, j];</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                 </span></span><span style='mso-ansi-language:
RU'>}<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>             </span>}<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>         </span>});<o:p></o:p></span></p>

<p class=MsoNormal>Метод <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Parallel</span></span><span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>.ForEach()</span></span> имеет множество перегрузок. Простейший
вариант предполагает указание коллекции, реализующей <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, и
объекта <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>,
описывающего тело цикла:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span
lang=EN-US>.ForEach(<span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Directory</span></span>.GetFiles(path, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;*.jpg&quot;</span></span><span
lang=EN-US>),</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                 </span>image</span><span
style='mso-ansi-language:RU'> =&gt; </span><span lang=EN-US>Process</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>image</span><span
style='mso-ansi-language:RU'>));<o:p></o:p></span></p>

<p class=MsoNormal>Статический метод <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.Invoke()</span></span> позволяет
распараллелить исполнение блоков операторов. Часто в приложениях существуют
такие последовательности операторов, для которых не имеет значения порядок
выполнения операторов внутри них. В таких случаях вместо последовательного
выполнения операторов друг за другом допустимо их параллельное выполнение,
позволяющее сократить время решения задачи. В базовом варианте метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Invoke()</span></span> имеет параметр-список
объектов <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span>:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// используем Invoke() для параллельной
загрузки файлов<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Parallel</span></span><span
lang=EN-US>.Invoke(</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>() =&gt; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WebClient</span></span>().DownloadFile(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;http://www.linqpad.net&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                  </span><span
style='mso-spacerun:yes'>                   </span><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'> </span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;lp.html&quot;</span></span><span
lang=EN-US>),</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>() =&gt; </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WebClient</span></span>().DownloadFile(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;http://www.jaoo.dk&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpLast><span lang=EN-US><span
style='mso-spacerun:yes'>                                      </span><span
style='mso-spacerun:yes'> </span></span><span class=ad><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>jaoo</span></span><span class=ad><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'>.</span></span><span class=ad><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>html</span></span><span
class=ad><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU'>&quot;</span></span><span style='mso-ansi-language:
RU'>));<o:p></o:p></span></p>

<p class=MsoNormal>Заметим, что каждый из методов <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>For()</span></span>, <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ForEach()</span></span> и <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Invoke()</span></span> может принимать аргумент
типа <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelOptions</span></span>
для настройки поведения метода.</p>

<h2>34.2. Параллелизм при декларативной обработке данных</h2>

<p class=MsoNormal><span class=a2>PLINQ</span> (Parallel Language Integrated
Query) – реализация LINQ, в которой запросы выполняются параллельно. PLINQ
поддерживает большинство операторов LINQ to Objects и имеет минимальное влияние
на имеющуюся модель LINQ.</p>

<p class=MsoNormal>Начнём рассмотрение PLINQ со следующего примера. Найдём все
простые числа от 3 до 100000, используя простой алгоритм с операторами LINQ:</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> numbers = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(3, 100000 - 3);</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> parallelQuery =</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>   </span></span></span><span lang=EN-US><span
style='mso-spacerun:yes'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span><span
lang=EN-US> n </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> numbers.AsParallel()</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>   </span></span></span><span lang=EN-US><span
style='mso-spacerun:yes'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>where</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Enumerable</span></span>.Range(2, (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>) <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Math</span></span>.Sqrt(n)).All(i =&gt; n%i &gt; 0)</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'><span
style='mso-spacerun:yes'>   </span></span></span><span lang=EN-US><span
style='mso-spacerun:yes'> </span></span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>select</span></span><span
lang=EN-US> n;</span></p>

<p class=aCxSpLast><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> primes = parallelQuery.ToArray();</span></p>

<p class=MsoNormal>В приведённом фрагменте кода использовался метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsParallel()</span></span>.
Это метод расширения из статического класса <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Linq.</span></span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelEnumerable</span></span>.
Метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsParallel()</span></span>
конвертирует коллекцию <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IEnumerable</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> в коллекцию <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelQuery</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>.
Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelEnumerable</span></span>
имеет набор методов расширения для <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ParallelQuery</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, соответствующих
операторам LINQ, но использующих для выполнения механизм задач.</p>

<p class=MsoNormal>Кроме <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AsParallel()</span></span>, класс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ParallelEnumerable</span></span> содержит ещё
несколько особых методов:</p>

<p class=MsoNormal>1. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsSequential()</span></span>
– конвертирует объект <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ParallelQuery</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> в коллекцию <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> так,
что все запросы выполняются последовательно.</p>

<p class=MsoNormal>2. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsOrdered()</span></span>
– при параллельной обработке заставляет сохранять в <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelQuery</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
порядок элементов (это замедляет обработку).</p>

<p class=MsoNormal>3. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsUnordered()</span></span>
– при параллельной обработке позволяет игнорировать в <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelQuery</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>
порядок элементов (отмена вызова <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AsOrdered()</span></span>).</p>

<p class=MsoNormal>4. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WithCancellation()</span></span>
– устанавливает для <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ParallelQuery</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> указанное значение
токена отмены.</p>

<p class=MsoNormal>5. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WithDegreeOfParallelism()</span></span>
– указывает для <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>ParallelQuery</span></span><span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, на сколько
параллельных частей нужно разбивать коллекцию для обработки.</p>

<p class=MsoNormal>6. <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WithExecutionMode()</span></span>
– задаёт опции выполнения параллельных запросов в виде перечисления <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ParallelExecutionMode</span></span>.</p>

<p class=MsoNormal>Приведём ещё один пример использования PLINQ. Будем
вычислять времени отклика от шести заданных сайтов. При этом явно установим
степень параллелизма. В примере используется класс <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Ping</span></span> из
пространства имён <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Net.NetworkInformation</span></span>.</p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> siteNames = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US>[] {</span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;www.tut.by&quot;</span></span><span
lang=EN-US>, </span><span class=ad><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&quot;habrahabr.ru&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>                     </span></span><span class=ad><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&quot;www.takeonit.com&quot;</span></span><span lang=EN-US>, </span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;stackoverflow.com&quot;</span></span><span
lang=EN-US>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> pings = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>from</span></span><span
lang=EN-US> site </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> siteNames.AsParallel()</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                                 
</span>.WithDegreeOfParallelism(6)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>let</span></span><span lang=EN-US> p = </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> <span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Ping</span></span>().Send(site)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>select</span></span><span lang=EN-US> </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>new</span></span><span lang=EN-US> {site, Time = p.RoundtripTime};</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>foreach</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> ping </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
lang=EN-US> pings)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Site {0} has ping {1}&quot;</span></span><span
lang=EN-US>,</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                      </span>ping</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>site</span><span
style='mso-ansi-language:RU'>, </span><span lang=EN-US>ping</span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Time</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h2>34.3. Коллекции, поддерживающие параллелизм</h2>

<p class=MsoNormal>Библиотека параллельных расширений содержит набор классов,
представляющих коллекции с различным уровнем поддержки параллелизма. Указанные
классы сосредоточены в пространстве имён <span class=a3><span style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Collections.Concurrent</span></span>.</p>

<p class=MsoNormal>Класс <span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BlockingCollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> является реализацией
шаблона «поставщик-потребитель». Этот класс реализует интерфейсы <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IEnumerable</span></span><span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, <span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ICollection</span></span>,
<span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IDisposable</span></span>
и имеет собственные элементы, описанные в табл. 21.</p>

<p class=ae>Таблица 21</p>

<p class=af>Элементы класса <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BlockingCollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Имя элемента</p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;mso-border-left-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afa>Описание</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Add()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Добавляет элемент в коллекцию</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>AddToAny()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод, который добавляет элемент в любую из
  указанных <span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>BlockingCollection</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&lt;T&gt;</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CompleteAdding()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>После вызова этого метода добавление элементов невозможно</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>GetConsumingEnumerable()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает перечислитель, который перебирает элементы с их
  одновременным удалением из коллекции</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>Take()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Получает элемент и удаляет его из коллекции. Если коллекция
  пуста, и у коллекции был вызван метод <span class=af3><span style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>CompleteAdding()</span></span>,
  генерируется исключение</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TakeFromAny()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод, который получает элемент из любой указанной <span
  class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  mso-bidi-font-family:"Times New Roman"'>BlockingCollection</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&lt;T&gt;</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TryAdd()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Пытается добавить элемент в коллекцию, в случае успеха
  возвращает <span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>.
  Дополнительно может быть задан временной интервал и токен отмены</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TryAddToAny()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод, который пытается добавить элемент в любую из
  указанных коллекций</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TryTake()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Пытается получить элемент (с удалением из коллекции), в случае
  успеха возвращает <span class=af1><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>TryTakeFromAny()</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Статический метод, который пытается получить элемент из любой
  указанной <span class=af2><span lang=EN-US style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>BlockingCollection</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&lt;T&gt;</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>BoundedCapacity</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Свойство возвращает максимальное число элементов, которое можно
  добавить в коллекцию без блокировки поставщика (данный параметр может быть задан
  при вызове конструктора <span class=af2><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>BlockingCollection</span></span><span
  class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
  "Times New Roman"'>&lt;T&gt;</span></span>)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsAddingCompleted</span></span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если вызывался <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CompleteAdding()</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:
  solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb><span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>IsCompleted</span></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=afb>Возвращает <span class=af1><span lang=EN-US style='font-size:
  11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman"'>true</span></span>,
  если вызывался <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;mso-bidi-font-family:"Times New Roman"'>CompleteAdding()</span></span>,
  и коллекция пуста</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>Продемонстрируем работу с <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BlockingCollection</span></span><span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span>, используя десять задач
в качестве поставщика и одну в качестве потребителя:</p>

<p class=aCxSpFirst><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BlockingCollection</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US>&gt; bc = </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>new</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BlockingCollection</span></span>&lt;</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US>&gt;();</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> producer = 0; producer &lt; 10; producer++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Factory.StartNew(() =&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Random</span></span> rand = </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>new</span></span><span lang=EN-US> <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Random</span></span>();</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>for</span></span><span lang=EN-US> (</span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>int</span></span><span lang=EN-US> i = 0; i
&lt; 5; i++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span>.Sleep(200);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>            </span>bc.Add(rand.Next(100));</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>});</span></p>

<p class=aCxSpMiddle><span lang=EN-US>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>var</span></span><span
lang=EN-US> consumer = <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Task</span></span>.Factory.StartNew(() =&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>               </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                   </span></span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>foreach</span></span><span lang=EN-US> (</span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>var</span></span><span lang=EN-US> item </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>in</span></span><span lang=EN-US> bc.GetConsumingEnumerable())</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                   </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                       </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(item);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                   </span>}</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>               </span>});</span></p>

<p class=aCxSpLast><span lang=EN-US>consumer.Wait();</span></p>

<p class=MsoNormal>Классы<span style='mso-ansi-language:EN-US'> </span><span
class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConcurrentQueue</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>, </span><span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ConcurrentStack</span></span><span class=a3><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, </span><span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConcurrentBag</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span><span class=ab><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ConcurrentDictionary</span></span><span
class=a3><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>&lt;T&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> – </span>это<span style='mso-ansi-language:
EN-US'> </span>потокобезопасные<span style='mso-ansi-language:EN-US'> </span>классы<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>представления<span style='mso-ansi-language:EN-US'> </span>очереди<span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>стека<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>неупорядоченного<span
style='mso-ansi-language:EN-US'> </span>набора<span style='mso-ansi-language:
EN-US'> </span>объектов<span style='mso-ansi-language:EN-US'> </span>и<span
style='mso-ansi-language:EN-US'> </span>словаря<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Предполагается, что данные классы
будут использоваться в качестве ресурсов, разделяемых между потоками, вместо
обычных классов-коллекций. Отличительная особенность данных коллекций – наличие
<span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Try</span></span>-методов
для получения (изменения) элементов. Такие методы удобны, так как исключают
предварительные проверки существования и необходимость использования в
клиентском коде секции <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>lock</span></span>.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// используем объект типа ConcurrentStack&lt;T&gt;<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>T item;</span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>if</span></span><span
lang=EN-US> (concurrentStack.TryPop(</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>out</span></span><span
lang=EN-US> item))<span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'> </span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>// </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>пытаемся</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>извлечь</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>элемент</span></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'>{<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><span
style='mso-spacerun:yes'>    </span></span><span lang=EN-US>UseData</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>item</span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<h1><a name="_Toc348862522">35. Асинхронный вызов методов</a></h1>

<p class=MsoNormal>Платформа .NET содержит средства для поддержки асинхронного
вызова методов. При <span class=a2>асинхронном вызове</span> поток выполнения
разделяется на две части: в одной выполняется метод, а в другой – процесс
программы. Асинхронный вызов служит альтернативой использованию многопоточности
явным образом<a style='mso-footnote-id:ftn38' href="#_ftn38" name="_ftnref38"
title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:14.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[38]</span></span><![endif]></span></span></a>.</p>

<p class=MsoNormal>Асинхронный вызов всегда выполняется посредством объекта
некоторого делегата. Любой такой объект содержит два специальных метода для
асинхронных вызовов – <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BeginInvoke()</span></span>
и <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>EndInvoke()</span></span>.
Эти методы генерируются во время выполнения программы, так как их сигнатура
зависит от делегата. Внимание: объект группового делегата нельзя вызвать
асинхронно.</p>

<p class=MsoNormal>Метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BeginInvoke()</span></span> обеспечивает асинхронный запуск. Кроме
параметров, указанных при описании делегата, метод <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>BeginInvoke()</span></span> имеет два
дополнительных параметра. Первый дополнительный параметр указывает на <span
class=a2>функцию завершения</span>, выполняемую после окончания асинхронного
метода. Второй дополнительный параметр – это объект, при помощи которого
функции завершения может быть передана некоторая информация. Метод <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BeginInvoke()</span></span>
возвращает объект, реализующий интерфейс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span>. При помощи этого объекта
становится возможным различать асинхронные вызовы одного и того же метода.</p>

<p class=MsoNormal>Приведём<span style='mso-ansi-language:EN-US'> </span>описание<span
style='mso-ansi-language:EN-US'> </span>интерфейса<span style='mso-ansi-language:
EN-US'> </span><span class=ab><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IAsyncResult</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>:<o:p></o:p></span></p>

<p class=aCxSpFirst><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>interface</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span lang=EN-US>
AsyncState{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WaitHandle</span></span> AsyncWaitHandle{ </span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>get</span></span><span lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>
CompletedSynchronously{ </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span></span><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>bool</span></span><span lang=EN-US>
IsCompleted{ </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>get</span></span><span
lang=EN-US>; }</span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Поле <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>IsCompleted</span></span> позволяет узнать, завершилась ли работа
асинхронного метода. В поле <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>AsyncWaitHandle</span></span> хранится объект типа <span class=ab><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitHandle</span></span>.
Программист может вызывать методы объекта <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>WaitHandle</span></span> для контроля над
потоком выполнения асинхронного метода. Объект <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AsyncState</span></span> хранит последний
аргумент, указанный при вызове <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>BeginInvoke()</span></span>.</p>

<p class=MsoNormal>Делегат для функции завершения описан следующим образом:</p>

<p class=a><span class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public delegate void</span></span><span
lang=EN-US> <span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>AsyncCallback</span></span>(<span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span>
ar);</span></p>

<p class=MsoNormal>Как видим, функции завершения передаётся единственный
аргумент – объект, реализующий интерфейс <span class=ab><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span>.</p>

<p class=MsoNormal>Рассмотрим пример асинхронного вызова метода, который
вычисляет и печатает факториал целого числа. Ни функции завершения, ни
возвращаемое методом <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BeginInvoke()</span></span>
значение не используются. Подобный подход при работе с асинхронными методами
называется <span class=a2>«выстрелил и забыл»</span> (fire and forget).</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// создадим лямбду, чтобы вычислять факториал<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Func</span></span><span
style='mso-ansi-language:RU'>&lt;</span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>uint</span></span><span
style='mso-ansi-language:RU'>, </span><span class=ab><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span><span
style='mso-ansi-language:RU'>&gt; </span><span lang=EN-US>factorial</span><span
style='mso-ansi-language:RU'> = </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
style='mso-ansi-language:RU'>;<o:p></o:p></span></p>

<p class=aCxSpMiddle><span lang=EN-US>factorial = n =&gt; (n == 0) ? 1 : n * factorial(n
- 1);</span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>создадим</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>лямбду</span></span><span class=aa><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>, </span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>чтобы</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>печатать</span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi;mso-ansi-language:EN-US'> </span></span><span class=aa><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>факториал</span></span><span
class=aa><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'><o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Action</span></span><span
lang=EN-US>&lt;</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>uint</span></span><span
lang=EN-US>&gt; print = n =&gt; <span class=ab><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(factorial(n));</span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// запустим метод асинхронно, игнорируя
дополнительные параметры<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span lang=EN-US>print</span><span style='mso-ansi-language:
RU'>.</span><span lang=EN-US>BeginInvoke</span><span style='mso-ansi-language:
RU'>(8000, </span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
style='mso-ansi-language:RU'>, </span><span class=ac><span lang=EN-US
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>null</span></span><span
style='mso-ansi-language:RU'>);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span style='mso-ansi-language:RU'><o:p>&nbsp;</o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// эмулируем работу (факториал увидим где-то на
третьей итерации)<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>for</span></span><span
lang=EN-US> (</span><span class=ac><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>int</span></span><span
lang=EN-US> i = 1; i &lt; 10; i++)</span></p>

<p class=aCxSpMiddle><span lang=EN-US>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Console</span></span>.Write(</span><span
class=ad><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&quot;Do some work...&quot;</span></span><span
lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span class=ab><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Thread</span></span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Sleep</span><span
style='mso-ansi-language:RU'>(3000);<o:p></o:p></span></p>

<p class=aCxSpLast><span style='mso-ansi-language:RU'>}<o:p></o:p></span></p>

<p class=MsoNormal>Модифицируем предыдущий пример. Будем передавать в <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BeginInvoke()</span></span>
функцию завершения и дополнительный аргумент.</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// объект print не изменился<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// функция завершения будет выводить время
выполнения метода<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>AsyncCallback</span></span><span
lang=EN-US> timer = ar =&gt;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span>{</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                              </span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span lang=EN-US> dt = (<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span>) ar.AsyncState;</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                              </span><span class=ab><span
style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span>.WriteLine(<span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span>.Now - dt);</span></p>

<p class=aCxSpMiddle><span lang=EN-US><span
style='mso-spacerun:yes'>                          </span>};</span></p>

<p class=aCxSpMiddle><span lang=EN-US>print.BeginInvoke(8000, timer, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span>.Now);</span></p>

<p class=aCxSpLast><span lang=EN-US>print.BeginInvoke(1000, timer, <span
class=ab><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>DateTime</span></span>.Now);</span></p>

<p class=MsoNormal>В разобранных примерах использовались асинхронные методы,
которые не возвращают значения. В приложении может возникнуть необходимость в
асинхронных методах-функциях. Для получения результата работы асинхронной
функции предназначен метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EndInvoke()</span></span>. Параметры <span class=a3><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>EndInvoke()</span></span> определяются на
основе параметров метода, инкапсулированного делегатом. Во-первых, <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>EndInvoke()</span></span>
является функцией, тип которой совпадает с типом инкапсулируемого метода.
Во-вторых, метод <span class=a3><span style='font-size:12.0pt;mso-bidi-font-size:
14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>EndInvoke()</span></span>
содержит все <span class=ac><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>out</span></span> и <span class=ac><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ref</span></span> параметры делегата, а
последний параметр имеет тип <span class=ab><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span>. При вызове метода <span
class=a3><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>EndInvoke()</span></span>
основной поток выполнения приостанавливается до завершения работы
соответствующего асинхронного метода.</p>

<p class=MsoNormal>Используем метод <span class=a3><span style='font-size:12.0pt;
mso-bidi-font-size:14.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>EndInvoke()</span></span> при вычислении и печати факториала:</p>

<p class=aCxSpFirst><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// объект factorial определён в первом примере<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// так как отслеживаем окончание работы
методов,<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=aa><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'>// </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>сохраняем</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>результат</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> </span></span><span
class=aa><span style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>вызова</span></span><span class=aa><span style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US'> <span
lang=EN-US>BeginInvoke()<o:p></o:p></span></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span><span
lang=EN-US> ar1 = factorial.BeginInvoke(8000, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span><span lang=EN-US>, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>IAsyncResult</span></span><span
lang=EN-US> ar2 = factorial.BeginInvoke(1000, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span><span lang=EN-US>, </span><span class=ac><span
lang=EN-US style='mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>null</span></span><span lang=EN-US>);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Thread</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>Sleep</span><span
style='mso-ansi-language:RU'>(2000);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// получаем результат второго вызова и печатаем
его<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span><span
lang=EN-US> res1 = factorial.EndInvoke(ar2);</span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>res</span><span
style='mso-ansi-language:RU'>1);<o:p></o:p></span></p>

<p class=aCxSpMiddle><span class=aa><span style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>// получаем и печатаем результат первого вызова<o:p></o:p></span></span></p>

<p class=aCxSpMiddle><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>BigInteger</span></span><span
lang=EN-US> res2 = factorial.EndInvoke(ar1);</span></p>

<p class=aCxSpLast><span class=ab><span lang=EN-US style='mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Console</span></span><span
style='mso-ansi-language:RU'>.</span><span lang=EN-US>WriteLine</span><span
style='mso-ansi-language:RU'>(</span><span lang=EN-US>res</span><span
style='mso-ansi-language:RU'>2);<o:p></o:p></span></p>

<p class=MsoNormal>В заключение заметим, что технически асинхронный вызов
методов реализуется средой исполнения при помощи пула потоков.</p>

<span style='font-size:14.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc348862523">Литература</a></h1>

<p class=MsoNormal>1. Албахари, Дж. <span lang=EN-US style='mso-ansi-language:
EN-US'>C</span># 5.0. Справочник. Полное описание языка: Пер. с англ. / Дж.
Албахари, Б. Албахари. – 5-е изд. – М.: ООО «И.Д. Вильямс», 2013. – 1008 с.:
ил.</p>

<p class=MsoNormal>2. Нэш, Т. C# 2010: ускоренный курс для профессионалов / Т.
Нэш. – М. : Издательский дом «Вильямс», 2010. – 592 с.</p>

<p class=MsoNormal>3. Троелсен, Э. Язык программирования <span lang=EN-US
style='mso-ansi-language:EN-US'>C</span># 5.0 и платформа .<span lang=EN-US
style='mso-ansi-language:EN-US'>NET</span> 4.5 / Э.&nbsp;Троелсен. – 6-е изд. –
М.: ООО «И.Д. Вильямс», 2013. – 1312 с.: ил.</p>

<p class=MsoNormal>4. Рихтер, Дж. CLR via C#. Программирование на платформе
Microsoft .NET Framework 4.5 на языке C# / Дж. Рихтер. – 4-е изд. – Спб.:
Питер, 2013. – 896 с.: ил.</p>

<p class=MsoNormal>5. Фримен, А. LINQ: язык интегрированных запросов в C# 2010
для профессионалов / А. Фримен, Дж. С. Раттц-мл. – М. : Издательский дом
«Вильямс», 2011. – 656 с. </p>

<p class=MsoNormal>6. Хейлсберг, А. Язык программирования C#. Классика
Computers Science. / А. Хейлсберг, М. Торгерсен, С. Вилтамут, П. Голд. – 4-е
изд. – Спб.: Питер, 2012. – 784 с.: ил.</p>

<p class=MsoNormal>7. Цвалина, К. Инфраструктура программных проектов:
соглашения, идиомы и шаблоны для многократно используемых библиотек .NET. :
Пер. с англ. / К. Цвалина. – М.: ООО «И.Д. Вильямс», 2011. – 416 с.: ил.</p>

</div>

<div style='mso-element:footnote-list'><![if !supportFootnotes]><br clear=all>

<hr align=left size=1 width="33%">

<![endif]>

<div style='mso-element:footnote' id=ftn1>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn1' href="#_ftnref1"
name="_ftn1" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[1]</span></span><![endif]></span></span></a>
Классы <span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TimeZone</span></span><span
lang=EN-US> </span>и <span class=af2><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TimeZoneInfo</span></span> предоставляют информацию, касающуюся
названий часовых поясов, смещений <span lang=EN-US style='mso-ansi-language:
EN-US'>UTC</span> и правил перехода на летнее время.</p>

</div>

<div style='mso-element:footnote' id=ftn2>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn2' href="#_ftnref2"
name="_ftn2" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[2]</span></span><![endif]></span></span></a>
Некоторые символы Unicode представлены двумя 16-битными суррогатными символами.</p>

</div>

<div style='mso-element:footnote' id=ftn3>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn3' href="#_ftnref3"
name="_ftn3" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[3]</span></span><![endif]></span></span></a>
Подробнее см. <span class=MsoHyperlink>ru.wikipedia.org/wiki/Регулярные_выражения</span>.</p>

</div>

<div style='mso-element:footnote' id=ftn4>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn4' href="#_ftnref4"
name="_ftn4" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[4]</span></span><![endif]></span></span></a>
Классы <span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CultureInfo</span></span>,
<span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>NumberFormatInfo</span></span>,
<span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>DateTimeFormatInfo</span></span>
определены в пространстве имён <span class=af3><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Globalization</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn5>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn5' href="#_ftnref5"
name="_ftn5" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[5]</span></span><![endif]></span></span></a>
Тип <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>string</span></span>
не перегружает операции сравнения, так как результат может измениться в
зависимости от текущих региональных стандартов.</p>

</div>

<div style='mso-element:footnote' id=ftn6>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn6' href="#_ftnref6"
name="_ftn6" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[6]</span></span><![endif]></span></span></a>
Компилятор C# генерирует код, принудительно запускающий сборку мусора при
окончании работы программы.</p>

</div>

<div style='mso-element:footnote' id=ftn7>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn7' href="#_ftnref7"
name="_ftn7" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[7]</span></span><![endif]></span></span></a>
Если бы использовалось <span class=af1><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>foreach</span></span><span class=af3><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'> (</span></span><span class=af1><span lang=EN-US style='font-size:
11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>var</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'> s </span></span><span class=af1><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>in</span></span><span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> shop)</span></span>, то типом
<span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>s</span></span>
был бы <span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>object</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn8>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn8' href="#_ftnref8"
name="_ftn8" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[8]</span></span><![endif]></span></span></a>
В пространстве имён <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections</span></span>
имеется слаботипизированный аналог класса <span class=af2><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>List</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> – класс <span
class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ArrayList</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn9>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn9' href="#_ftnref9"
name="_ftn9" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[9]</span></span><![endif]></span></span></a>
<span class=a4>В пространстве имён </span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Collections</span></span><span class=a4>
имеются слаботипизированные аналоги классов </span><span class=af2><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Queue</span></span><span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span><span
class=a4> и </span><span class=af2><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Stack</span></span><span class=af3><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>&lt;T&gt;</span></span><span class=a4> – классы </span><span
class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Queue</span></span><span
class=a4> и </span><span class=af2><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>Stack</span></span><span class=a4>.<o:p></o:p></span></p>

</div>

<div style='mso-element:footnote' id=ftn10>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn10' href="#_ftnref10"
name="_ftn10" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[10]</span></span><![endif]></span></span></a>
В пространстве имён <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections</span></span>
имеется слаботипизированный аналог класса <span class=af2><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Dictionary</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;TKey,TValue&gt;</span></span> – класс <span
class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Hashtable</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn11>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn11' href="#_ftnref11"
name="_ftn11" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[11]</span></span><![endif]></span></span></a>
В пространстве имён <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Collections</span></span>
имеется слаботипизированный аналог класса <span class=af2><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>Collection</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>&lt;T&gt;</span></span> – класс <span
class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>CollectionBase</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn12>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn12' href="#_ftnref12"
name="_ftn12" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[12]</span></span><![endif]></span></span></a>
Для использования <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Linq</span></span>
необходимо подключить сборку <span class=af3><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Core.dll</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn13>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn13' href="#_ftnref13"
name="_ftn13" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[13]</span></span><![endif]></span></span></a>
Все операторы LINQ имеют модификаторы <span class=af1><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>public</span></span><span class=af1><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>static</span></span>.
Для краткости эти модификаторы не указываются.</p>

</div>

<div style='mso-element:footnote' id=ftn14>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn14' href="#_ftnref14"
name="_ftn14" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[14]</span></span><![endif]></span></span></a>
Чтобы использовать указанные классы, подключите сборки <span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.IO.Compression.dll</span></span> и <span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.IO.Compression.FileSystem.dll</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn15>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn15' href="#_ftnref15"
name="_ftn15" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[15]</span></span><![endif]></span></span></a>
Подробно о принципах использования асинхронных методов буден рассказано далее.</p>

</div>

<div style='mso-element:footnote' id=ftn16>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn16' href="#_ftnref16"
name="_ftn16" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[16]</span></span><![endif]></span></span></a>
Данный шаблон частично разбирается в параграфе «Асинхронный вызов методов».</p>

</div>

<div style='mso-element:footnote' id=ftn17>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn17' href="#_ftnref17"
name="_ftn17" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[17]</span></span><![endif]></span></span></a>
Заметим, что класс <span class=af2><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>FileStream</span></span> уже обладает некоторой поддержкой
буферизации.</p>

</div>

<div style='mso-element:footnote' id=ftn18>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn18' href="#_ftnref18"
name="_ftn18" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[18]</span></span><![endif]></span></span></a>
Подробности и примеры можно найти на сайте <a href="http://json.org">json.org</a>.</p>

</div>

<div style='mso-element:footnote' id=ftn19>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn19' href="#_ftnref19"
name="_ftn19" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[19]</span></span><![endif]></span></span></a>
Запись <span class=af9><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>+ XName
name</span></span> означает наличие перегруженной версии метода с параметром <span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>name</span></span> типа <span
class=ab><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>XName</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn20>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn20' href="#_ftnref20"
name="_ftn20" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[20]</span></span><![endif]></span></span></a>
Запись <span class=af9><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>+ params</span></span>
означает наличие перегруженной версии метода с параметром типа <span class=af1><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>params</span></span><span
class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=af1><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>[]</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn21>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn21' href="#_ftnref21"
name="_ftn21" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[21]</span></span><![endif]></span></span></a>
У класса <span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>XmlReader</span></span>
имеются также специфичные методы чтения конкретного содержимого XML-документа
(например, <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadContentAsInt()</span></span>,
<span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>ReadAttributeValue()</span></span>).</p>

</div>

<div style='mso-element:footnote' id=ftn22>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn22' href="#_ftnref22"
name="_ftn22" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[22]</span></span><![endif]></span></span></a>
Подробно о синтаксисе применения атрибутов и операторе <span class=af1><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>typeof</span></span>
рассказывается далее.</p>

</div>

<div style='mso-element:footnote' id=ftn23>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn23' href="#_ftnref23"
name="_ftn23" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[23]</span></span><![endif]></span></span></a>
Класс <span class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>StreamingContext</span></span>
описывает контекст потока сериализации. Основным свойством класса является <span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>State</span></span>,
принимающее значения из перечисления <span class=af2><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>StreamingContextStates</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn24>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn24' href="#_ftnref24"
name="_ftn24" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[24]</span></span><![endif]></span></span></a>
Эти атрибуты размещены в пространстве имён <span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>System.Runtime.Serialization</span></span> и
одноимённой сборке.</p>

</div>

<div style='mso-element:footnote' id=ftn25>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn25' href="#_ftnref25"
name="_ftn25" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[25]</span></span><![endif]></span></span></a>
Visual Studio не позволяет работать с многофайловыми сборками, поэтому файлы
примера нужно компилировать, используя компилятор командной строки <span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>csc.exe</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn26>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn26' href="#_ftnref26"
name="_ftn26" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[26]</span></span><![endif]></span></span></a>
Технология <span class=a2>зондирования</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>probing</span>) позволяет размещать зависимые
сборки в подкаталогах.</p>

</div>

<div style='mso-element:footnote' id=ftn27>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn27' href="#_ftnref27"
name="_ftn27" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[27]</span></span><![endif]></span></span></a>
Профиль приложений <span lang=EN-US style='mso-ansi-language:EN-US'>Metro</span><span
lang=EN-US> </span>скрывает большинство элементов класса <span class=af2><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>Type</span></span> и
открывает их в классе <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>System.Reflection.</span></span><span
class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>TypeInfo</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn28>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn28' href="#_ftnref28"
name="_ftn28" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[28]</span></span><![endif]></span></span></a>
Для генерации отдельных методов можно использовать класс <span class=af2><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>DynamicMethod</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn29>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn29' href="#_ftnref29"
name="_ftn29" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[29]</span></span><![endif]></span></span></a>
В случае веб-приложения файл конфигурации всегда называется <span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>web.config</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn30>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn30' href="#_ftnref30"
name="_ftn30" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[30]</span></span><![endif]></span></span></a>
Подробную информацию о стандартных классах, используемых в механизме
конфигурации, содержит серия статей по адресу <a
href="http://www.codeproject.com/Articles/16466/Unraveling-the-Mysteries-of-NET-2-0-Configuration">codeproject.com/Articles/16466/Unraveling-the-Mysteries-of-NET-2-0-Configuration</a>.</p>

</div>

<div style='mso-element:footnote' id=ftn31>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn31' href="#_ftnref31"
name="_ftn31" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[31]</span></span><![endif]></span></span></a>
В веб-приложениях используется <span class=af3><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>System.Web.Configuration.</span></span><span class=af2><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>WebConfigurationManager</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn32>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn32' href="#_ftnref32"
name="_ftn32" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[32]</span></span><![endif]></span></span></a>
Любой созданный поток резервирует примерно один мегабайт памяти под свои нужды.</p>

</div>

<div style='mso-element:footnote' id=ftn33>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn33' href="#_ftnref33"
name="_ftn33" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[33]</span></span><![endif]></span></span></a>
Прекращение работы фонового потока не гарантируется выполнение его блоков <span
class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>finally</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn34>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn34' href="#_ftnref34"
name="_ftn34" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[34]</span></span><![endif]></span></span></a>
Оба метода – <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Suspend()</span></span>
и <span class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>Resume()</span></span>
– помечены как устаревшие. Использовать их не рекомендуется.</p>

</div>

<div style='mso-element:footnote' id=ftn35>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn35' href="#_ftnref35"
name="_ftn35" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[35]</span></span><![endif]></span></span></a>
<span class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>public</span></span><span
class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:RU'> </span></span><span class=af1><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>delegate</span></span><span class=af1><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-ansi-language:RU'> </span></span><span
class=af1><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>void</span></span><span
class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=af2><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi'>WaitCallback</span></span><span
class=af3><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'>(</span></span><span
class=ac><span lang=EN-US style='mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>object</span></span><span class=af3><span
lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:
"Times New Roman";mso-bidi-theme-font:minor-bidi'> </span></span><span
class=af3><span lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US'>state</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>);</span></span></p>

</div>

<div style='mso-element:footnote' id=ftn36>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn36' href="#_ftnref36"
name="_ftn36" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[36]</span></span><![endif]></span></span></a>
По адресу <a href="http://code.msdn.microsoft.com/ParExtSamples">code.msdn.microsoft.com/ParExtSamples</a>
доступен для загрузки код, содержащий примеры нестандартных планировщиков задач
(см. ссылку на Parallel Extensions Extras).</p>

</div>

<div style='mso-element:footnote' id=ftn37>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn37' href="#_ftnref37"
name="_ftn37" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[37]</span></span><![endif]></span></span></a>
По умолчанию предшественник и продолжение могут выполняться в разных потоках.
Чтобы они выполнялись в одном потоке, передайте методу <span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>ContinueWith()</span></span> дополнительный
аргумент со значением <span class=af2><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:
minor-bidi'>TaskContinuationOptions</span></span><span class=af3><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi'>.ExecuteSynchronously</span></span>.</p>

</div>

<div style='mso-element:footnote' id=ftn38>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn38' href="#_ftnref38"
name="_ftn38" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]><span class=MsoFootnoteReference><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-bidi-theme-font:
minor-bidi;mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:AR-SA'>[38]</span></span><![endif]></span></span></a>
Подход, описанный в данном параграфе, является старой моделью организации
параллельных вычислений. Вместо работы с асинхронными методами следует
применять выполнение асинхронных операций при помощи задач.</p>

</div>

</div>

</body>

</html>
