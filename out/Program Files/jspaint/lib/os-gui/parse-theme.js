function parseINIString(t){var e={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},o={},r=t.split(/[\r\n]+/),n=null;return r.forEach((function(t){if(!e.comment.test(t))if(e.param.test(t)){var r=t.match(e.param);n?o[n][r[1]]=r[2]:o[r[1]]=r[2]}else if(e.section.test(t)){r=t.match(e.section);o[r[1]]={},n=r[1]}else 0==t.length&&n&&(n=null)})),o}function renderThemeGraphics(t){var e=e=>t.getPropertyValue?t.getPropertyValue(e):t[e],o=document.createElement("canvas");o.width=o.height=2;var r=o.getContext("2d");r.fillStyle=e("--ButtonFace"),r.fillRect(0,1,1,1),r.fillRect(1,0,1,1),r.fillStyle=e("--ButtonHilight"),r.fillRect(0,0,1,1),r.fillRect(1,1,1,1);var n=`url("${o.toDataURL()}")`,l=parseInt(e("--scrollbar-size"));isFinite(l)||(l=13);var i=l-4,a=Math.floor(.3*l);l<16&&l>13&&(a-=1);var h=2*a-1,s=document.createElement("canvas"),d=s.getContext("2d");s.width=h,s.height=a,d.fillStyle="white";for(let t=0;t<a;t+=1)for(let e=t;e<h-t;e+=1)d.fillRect(e,t,1,1);o.width=4*i,o.height=i;let c=0;for(let t=0;t<2;t+=1)for(let e=0;e<2;e+=1)r.save(),r.translate(c*i,0),r.translate(i/2,i/2),t&&r.rotate(-Math.PI/2),e&&r.scale(1,-1),r.translate(-i/2,-i/2),r.drawImage(s,~~(i/2-h/2),~~(i/2-a/2)),r.restore(),c+=1;r.save(),r.globalCompositeOperation="source-in",r.fillStyle=e("--ButtonText"),r.fillRect(0,0,o.width,o.height);var u=`url("${o.toDataURL()}")`;r.fillStyle=e("--GrayText"),r.fillRect(0,0,o.width,o.height);var f=`url("${o.toDataURL()}")`;r.fillStyle=e("--ButtonHilight"),r.fillRect(0,0,o.width,o.height);var v=`url("${o.toDataURL()}")`;function p(t,e){var o=32*(t=t),r=`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="256px" height="256px" viewBox="0 0 256 256">\n\t\t\t${e.replace(/(d|x|y|width|height|stroke-width)="[^"]*"/g,(t=>t.replace(/\d+/g,(t=>32*t))))}\n\t\t</svg>`;return`url("${`data:image/svg+xml,${encodeURIComponent(r)}`}") ${o} / ${t}px`}r.restore();var g=p(2,`\n\t\t<path d="M0 0h8v8h-8v-8z" fill="${e("--ButtonDkShadow")}"/>\n\t\t<path d="M1 1h6v6h-6v-6z" fill="${e("--ButtonShadow")}"/>\n\t\t<path d="M2 2h4v4h-4v-4z" fill="${e("--ButtonFace")}"/>\n\t`),m=p(2,`\n\t\t<path d="M0 0h8v8h-8v-8z" fill="${e("--ButtonDkShadow")}"/>\n\t\t<path d="M1 1h6v6h-6v-6z" fill="${e("--ButtonShadow")}"/>\n\t\t<path d="M2 2h4v4h-4v-4z" fill="${e("--ButtonFace")}"/>\n\t\t<rect x="0" y="0" width="8" height="8" stroke-width="2" stroke="${e("--WindowFrame")}" fill="none"/>\n\t`);return{"--checker":n,"--button-active-border-image":g,"--button-normal-border-image":p(2,`\n\t\t<path d="M0 0h7v1h-6v6h-1v-7z" fill="${e("--ButtonHilight")}"/>\n\t\t<path d="M7 0h1v8h-8v-1h7v-7z" fill="${e("--ButtonDkShadow")}"/>\n\t\t<path d="M1 1h5v1h-4v4h-1v-5z" fill="${e("--ButtonLight")}"/>\n\t\t<path d="M6 1h1v6h-6v-1h5v-5z" fill="${e("--ButtonShadow")}"/>\n\t\t<path d="M2 2h4v4h-4v-4z" fill="${e("--ButtonFace")}"/>\n\t`),"--inset-deep-border-image":p(2,`\n\t\t<path d="M0 0h7v1h-6v6h-1v-7z" fill="${e("--ButtonDkShadow")}"/>\n\t\t<path d="M7 0h1v8h-8v-1h7v-7z" fill="${e("--ButtonHilight")}"/>\n\t\t<path d="M1 1h5v1h-4v4h-1v-5z" fill="${e("--ButtonShadow")}"/>\n\t\t<path d="M6 1h1v6h-6v-1h5v-5z" fill="${e("--ButtonLight")}"/>\n\t\t<path d="M2 2h4v4h-4v-4z" fill="${e("--ButtonFace")}"/>\n\t`),"--button-default-border-image":p(3,`\n\t\t<path d="M0 0h8v8h-8v-8z" fill="${e("--ButtonDkShadow")}"/>\n\t\t<path d="M1 1h5v1h-4v4h-1v-5z" fill="${e("--ButtonHilight")}"/>\n\t\t<path d="M2 2h3v1h-2v2h-1v-3z" fill="${e("--ButtonLight")}"/>\n\t\t<path d="M5 2h1v4h-4v-1h3v-3z" fill="${e("--ButtonShadow")}"/>\n\t\t<path d="M3 3h2v2h-2v-2z" fill="${e("--ButtonFace")}"/>\n\t\t<rect x="0" y="0" width="8" height="8" stroke-width="2" stroke="${e("--WindowFrame")}" fill="none"/>\n\t`),"--button-default-active-border-image":m,"--scrollbar-arrows-ButtonText":u,"--scrollbar-arrows-GrayText":f,"--scrollbar-arrows-ButtonHilight":v,"--scrollbar-size":`${l}px`,"--scrollbar-button-inner-size":`${i}px`}}function getThemeCSSProperties(t){const e=["--checker","--button-active-border-image","--button-normal-border-image","--inset-deep-border-image","--button-default-border-image","--button-default-active-border-image","--scrollbar-arrows-ButtonText","--scrollbar-arrows-GrayText","--scrollbar-arrows-ButtonHilight","--scrollbar-size","--scrollbar-button-inner-size","--ActiveBorder","--ActiveTitle","--AppWorkspace","--Background","--ButtonAlternateFace","--ButtonDkShadow","--ButtonFace","--ButtonHilight","--ButtonLight","--ButtonShadow","--ButtonText","--GradientActiveTitle","--GradientInactiveTitle","--GrayText","--Hilight","--HilightText","--HotTrackingColor","--InactiveBorder","--InactiveTitle","--InactiveTitleText","--InfoText","--InfoWindow","--Menu","--MenuText","--Scrollbar","--TitleText","--Window","--WindowFrame","--WindowText"],o=window.getComputedStyle(t),r={};for(const t of e)r[t]=o.getPropertyValue(t);return r}function inheritTheme(t,e){applyCSSProperties(getThemeCSSProperties(e),{element:t,recurseIntoIframes:!0})}function parseThemeFileString(t){var e=parseINIString(t),o=e["Control Panel\\Colors"];if(!o)return alert("Invalid theme file, no [Control Panel\\Colors] section"),void console.log(e);for(var r in o)r.match(/\W/)?delete o[r]:o[r]=`rgb(${o[r].split(" ").join(", ")})`;var n={};for(var r in o)n[`--${r}`]=o[r];return n=Object.assign(renderThemeGraphics(n),n)}function applyCSSProperties(t,e={}){let o,r;"tagName"in e?(console.warn("deprecated: use options argument to applyCSSProperties, e.g. applyCSSProperties(cssProperties, { element: document.documentElement, recurseIntoIframes: true })"),o=e,r=!1):({element:o=document.documentElement,recurseIntoIframes:r=!1}=e);var n;for(var l in t)o.style.setProperty(l,(n=l,t.getPropertyValue?t.getPropertyValue(n):t[n]));if(r)for(var i=o.querySelectorAll("iframe"),a=0;a<i.length;a++)try{applyCSSProperties(t,{element:i[a].contentDocument.documentElement,recurseIntoIframes:!0})}catch(t){}}function makeThemeCSSFile(t){var e="\n/* This is a generated file. */\n:root {\n";for(var o in t)e+=`\t${o}: ${t[o]};\n`;return e+="}\n"}function makeBlackToInsetFilter(){if(document.getElementById("os-gui-black-to-inset-filter"))return;$('\n\t\t<svg style="position: absolute; pointer-events: none; bottom: 100%;">\n\t\t\t<defs>\n\t\t\t\t<filter id="os-gui-black-to-inset-filter" x="0" y="0" width="1px" height="1px">\n\t\t\t\t\t<feColorMatrix\n\t\t\t\t\t\tin="SourceGraphic"\n\t\t\t\t\t\ttype="matrix"\n\t\t\t\t\t\tvalues="\n\t\t\t\t\t\t\t1 0 0 0 0\n\t\t\t\t\t\t\t0 1 0 0 0\n\t\t\t\t\t\t\t0 0 1 0 0\n\t\t\t\t\t\t\t-1000 -1000 -1000 1 0\n\t\t\t\t\t\t"\n\t\t\t\t\t\tresult="black-parts-isolated"\n\t\t\t\t\t/>\n\t\t\t\t\t<feFlood result="shadow-color" flood-color="var(--ButtonShadow)"/>\n\t\t\t\t\t<feFlood result="hilight-color" flood-color="var(--ButtonHilight)"/>\n\t\t\t\t\t<feOffset in="black-parts-isolated" dx="1" dy="1" result="offset"/>\n\t\t\t\t\t<feComposite in="hilight-color" in2="offset" operator="in" result="hilight-colored-offset"/>\n\t\t\t\t\t<feComposite in="shadow-color" in2="black-parts-isolated" operator="in" result="shadow-colored"/>\n\t\t\t\t\t<feMerge>\n\t\t\t\t\t\t<feMergeNode in="hilight-colored-offset"/>\n\t\t\t\t\t\t<feMergeNode in="shadow-colored"/>\n\t\t\t\t\t</feMerge>\n\t\t\t\t</filter>\n\t\t\t</defs>\n\t\t</svg>\n\t').appendTo("body")}