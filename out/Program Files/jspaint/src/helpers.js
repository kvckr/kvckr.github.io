(e=>{const t=- - - - - - - -Math.PI+Math.PI-0,n=5===(new Date).getMonth(),o=$(window);function a(e){return document.createElement(e)}function i(e,t=5e4){const n={},o=[],a=(...a)=>{if(a.some((e=>e instanceof CanvasPattern)))return e.apply(null,a);const i=JSON.stringify(a);if(n[i])return n[i];{const r=e.apply(null,a);if(n[i]=r,o.push(i),o.length>t){const e=o.shift();delete n[e]}return r}};return a.clear_memo_cache=()=>{for(const e of o)delete n[e];o.length=0},a}const r=i((e=>{const t=c(1,1);t.ctx.fillStyle=e,t.ctx.fillRect(0,0,1,1);const n=t.ctx.getImageData(0,0,1,1);return Array.from(n.data)}));function c(e,t){const n=e,o=a("canvas"),i=o.getContext("2d");return o.ctx=i,i.disable_image_smoothing=()=>{i.imageSmoothingEnabled=!1,!1!==i.imageSmoothingEnabled&&(i.mozImageSmoothingEnabled=!1,i.webkitImageSmoothingEnabled=!1,i.msImageSmoothingEnabled=!1)},i.enable_image_smoothing=()=>{i.imageSmoothingEnabled=!0,!0!==i.imageSmoothingEnabled&&(i.mozImageSmoothingEnabled=!0,i.webkitImageSmoothingEnabled=!0,i.msImageSmoothingEnabled=!0)},i.copy=e=>{o.width=e.naturalWidth||e.width,o.height=e.naturalHeight||e.height,i.disable_image_smoothing(),e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0)},e&&t?(o.width=e,o.height=t,i.disable_image_smoothing()):n&&i.copy(n),o}function l(e){const t=new Image;return t.src=`help/${e}`,t}function m(e){return l(e.help_icon)}function g(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>{t(o)},o.onerror=()=>{n(new Error(`failed to load image from ${e}`))},o.src=e}))}e.TAU=t,e.is_pride_month=n,e.$G=o,e.E=a,e.make_css_cursor=function(e,t,n){return`url(images/cursors/${e}.png) ${t.join(" ")}, ${n}`},e.make_canvas=c,e.get_help_folder_icon=l,e.get_icon_for_tool=m,e.get_icon_for_tools=function(e){if(1===e.length)return m(e[0]);const t=c(16,16);return Promise.all(e.map((e=>g(`help/${e.help_icon}`)))).then((e=>{e.forEach(((n,o)=>{const a=t.width/e.length,i=o*a,r=t.height;t.ctx.drawImage(n,i,0,a,r,i,0,a,r)}))})),t},e.load_image_simple=g,e.rgb_to_hsl=function(e,t,n){e/=255,t/=255,n/=255;var o,a,i=Math.max(e,t,n),r=Math.min(e,t,n),c=(i+r)/2;if(i==r)o=a=0;else{var l=i-r;switch(a=c>.5?l/(2-i-r):l/(i+r),i){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return[o,a,c]},e.image_data_match=function(e,t,n){const o=e.data,a=t.data;if(o.length!==a.length)return!1;for(let e=o.length,t=0;t<e;t++)if(o[t]!==a[t]&&Math.abs(o[t]-a[t])>n)return!1;return!0},e.get_rgba_from_color=r,e.memoize_synchronous_function=i,e.debounce=function(e,t,n){let o;const a=function(){const a=this,i=arguments,r=n&&!o;clearTimeout(o),o=setTimeout((()=>{o=null,n||e.apply(a,i)}),t),r&&e.apply(a,i)};return a.cancel=()=>{clearTimeout(o)},a}})(window);