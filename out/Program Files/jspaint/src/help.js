(e=>{let t;var o=0;$(window).on("pointerdown",(function(e){$("body").addClass("dragging")})),$(window).on("pointerup dragend blur",(function(e){"blur"===e.type&&document.activeElement.tagName.match(/iframe/i)||($("body").removeClass("dragging"),$("iframe").css("pointer-events",""))})),e.show_help=function(){t?t.focus():(t=function(e){const t=$Window({title:e.title||"Help Topics",icons:{16:"images/chm-16x16.png"},resizable:!0});t.addClass("help-window");let n=!0,s=0,i=0;const a=$(E("div")).addClass("main"),l=$(E("div")).addClass("toolbar"),r=(e,o,n,s)=>{const i=$("<button class='lightweight'>").append($("<span>").text(e)).appendTo(l).on("click",(()=>{n()}));$("<div class='icon'/>").appendTo(i).css({backgroundPosition:55*-o+"px 0px"});const a=()=>{i[0].disabled=s&&!s()};return a(),t.on("click","*",a),t.on("update-buttons",a),i},c=()=>f.outerWidth()+parseFloat(getComputedStyle(f[0]).getPropertyValue("margin-left"))+parseFloat(getComputedStyle(f[0]).getPropertyValue("margin-right"))+w.outerWidth(),d=r("Hide",0,(()=>{const e=c();f.hide(),w.hide(),d.hide(),p.show(),t.width(t.width()-e),t.css("left",t.offset().left+e),t.bringTitleBarInBounds()})),p=r("Show",5,(()=>{f.show(),w.show(),p.hide(),d.show();const e=c();t.css("max-width","unset"),t.width(t.width()+e),t.css("left",t.offset().left-e),t.offset().left<0&&(t.width(t.width()+t.offset().left),t.css("left",0)),t.css("max-width","")})).hide();r("Back",1,(()=>{u[0].contentWindow.history.back(),n=!0,s-=1,i+=1}),(()=>s>0)),r("Forward",2,(()=>{u[0].contentWindow.history.forward(),n=!0,i-=1,s+=1}),(()=>i>0)),r("Options",3,(()=>{}),(()=>!1)),r("Web Help",4,(()=>{h.src="help/online_support.htm"}));const u=function(e){var t=$("<iframe allowfullscreen sandbox='allow-same-origin allow-scripts allow-forms allow-pointer-lock allow-modals allow-popups allow-downloads'>"),n=t[0],s=!1;t.focus_contents=function(){n.contentWindow&&(n.contentDocument.hasFocus()||(s=!0,n.contentWindow.focus(),setTimeout((function(){n.contentWindow.focus(),s=!1}))))};var i=function(){if(!s)try{if(n.contentWindow&&n.contentWindow.jQuery&&n.contentWindow.jQuery("body").trigger("pointerup"),n.contentWindow){const e=new n.contentWindow.MouseEvent("mouseup",{button:0});n.contentWindow.dispatchEvent(e);const t=new n.contentWindow.MouseEvent("mouseup",{button:2});n.contentWindow.dispatchEvent(t)}}catch(e){console.log("Failed to access iframe to delegate pointerup; got",e)}};$G.on("mouseup blur",i),t.destroy=()=>{$G.off("mouseup blur",i)},$("body").addClass("loading-program"),o+=1,t.on("load",(function(){--o<=0&&$("body").removeClass("loading-program");try{if(window.themeCSSProperties&&applyTheme(themeCSSProperties,n.contentDocument.documentElement),n.contentDocument.querySelector("#error #livewebInfo.available")){var e=document.createElement("div");e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.background="#c0c0c0",e.style.color="#000",e.style.padding="50px",n.contentDocument.body.appendChild(e),e.innerHTML='<a target="_blank">Save this url in the Wayback Machine</a>',e.querySelector("a").href="https://web.archive.org/save/https://98.js.org/"+n.src.replace(/.*https:\/\/98.js.org\/?/,""),e.querySelector("a").style.color="blue"}var s=$(n.contentWindow);s.on("pointerdown click",(function(e){n.$window&&n.$window.focus(),$(".menu-button").trigger("release"),$(".menu-popup").hide()})),s.on("pointerdown",(function(e){t.css("pointer-events","all"),$("body").addClass("dragging")})),s.on("pointerup",(function(e){$("body").removeClass("dragging"),t.css("pointer-events","")})),n.contentWindow.close=function(){n.$window&&n.$window.close()}}catch(e){console.log("Failed to reach into iframe; got",e)}})),e.src&&t.attr({src:e.src});return t.css({minWidth:0,minHeight:0,flex:1,border:0}),t}({src:"help/default.html"}).addClass("inset-deep"),h=u[0];h.$window=t;const w=$(E("div")).addClass("resizer"),f=$(E("ul")).addClass("contents inset-deep");u.on("load",(()=>{n||(s+=1,i=0),n=!1,t.triggerHandler("update-buttons")})),a.append(f,w,u),t.$content.append(l,a),t.css({width:800,height:600}),u.attr({name:"help-frame"}),u.css({backgroundColor:"white",border:"",margin:"1px"}),f.css({margin:"1px"}),t.center(),a.css({position:"relative"});const m=4;w.css({cursor:"ew-resize",width:m,boxSizing:"border-box",background:"var(--ButtonFace)",borderLeft:"1px solid var(--ButtonShadow)",boxShadow:"inset 1px 0 0 var(--ButtonHilight)",top:0,bottom:0,zIndex:1}),w.on("pointerdown",(e=>{let o,n;const s=e=>Math.min(t.width()-100,Math.max(20,e.clientX-t.$content.offset().left));$G.on("pointermove",o=e=>{w.css({position:"absolute",left:s(e)}),f.css({marginRight:m})}),$G.on("pointerup",n=e=>{$G.off("pointermove",o),$G.off("pointerup",n),w.css({position:"",left:""}),f.css({flexBasis:s(e)-m,marginRight:""})})}));const g=e=>{const t={};for(const o of e.children("param").get())t[o.name]=o.value;return t};let b;const v=e=>{const t=$(E("div")).addClass("item").text(e.trim());return t.on("mousedown",(()=>{f.find(".item").removeClass("selected"),t.addClass("selected")})),t.on("click",(()=>{const e=t.parent();e.is(".folder")&&(b&&b.not(e).removeClass("expanded"),e.toggleClass("expanded"),b=e)})),t},y=$(E("li")).addClass("page");function C(t,o){const n=g($(t).children("object"));if($(t).find("li").length>0){const e=$(E("li")).addClass("folder");e.append(v(n.Name)),f.append(e);const o=$(E("ul"));e.append(o),$(t).children("ul").children().get().forEach((e=>{C(e,o)}))}else{const t=$(E("li")).addClass("page");t.append(v(n.Name).on("click",(()=>{u.attr({src:`${e.root}/${n.Local}`})}))),o?o.append(t):f.append(t)}}y.append(v("Welcome to Help").on("click",(()=>{u.attr({src:"help/default.html"})}))),f.append(y),fetch(e.contentsFile).then((t=>{t.text().then((e=>{$($.parseHTML(e)).filter("ul").children().get().forEach((e=>{C(e,null)}))}),(t=>{show_error_message(`${localize("Failed to launch help.")} Failed to read ${e.contentsFile}.`,t)}))}),(()=>{"file:"===location.protocol?showMessageBox({messageHTML:'\n\t\t\t\t\t<p>Help is not available when running from the <code>file:</code> protocol.</p>\n\t\t\t\t\t<p>To use this feature, <a href="https://attacomsian.com/blog/local-web-server">start a web server</a>.</p>\n\t\t\t\t',iconID:"error"}):show_error_message(`${localize("Failed to launch help.")} ${localize("Access to %1 was denied.",e.contentsFile)}`)}));var x={};return x.$help_window=t,x}({title:localize("Paint Help"),root:"help",contentsFile:"help/mspaint.hhc"}).$help_window,t.on("close",(()=>{t=null})))}})(window);