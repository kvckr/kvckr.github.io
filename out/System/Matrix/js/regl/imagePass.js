import{loadImage,loadText,makePassFBO,makePass}from"./utils.js";const defaultBGURL="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Flammarion_Colored.jpg/917px-Flammarion_Colored.jpg";export default({regl:a,config:e},o)=>{const r=makePassFBO(a,e.useHalfFloat),l="bgURL"in e?e.bgURL:defaultBGURL,m=e.bloomStrength,s=loadImage(a,l),t=loadText("shaders/glsl/imagePass.frag.glsl"),g=a({frag:a.prop("frag"),uniforms:{bloomStrength:m,backgroundTex:s.texture,tex:o.primary,bloomTex:o.bloom},framebuffer:r});return makePass({primary:r},Promise.all([s.loaded,t.loaded]),((a,e)=>r.resize(a,e)),(()=>g({frag:t.text()})))};